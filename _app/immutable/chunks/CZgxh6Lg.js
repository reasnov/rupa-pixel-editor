class u{static async fixDuration(t,s){const r=await t.arrayBuffer(),n=new DataView(r),e=this.findTag(n,[24,83,128,103]);if(e===-1)return t;const a=this.findTag(n,[21,73,169,102],e);if(a===-1)return t;const i=this.findTag(n,[68,137],a);if(i!==-1){const f=i+3;return n.setFloat64(f,s,!1),new Blob([r],{type:t.type})}else return t}static findTag(t,s,r=0){const n=t.byteLength-s.length;for(let e=r;e<n;e++){let a=!0;for(let i=0;i<s.length;i++)if(t.getUint8(e+i)!==s[i]){a=!1;break}if(a)return e}return-1}static async injectMetadata(t,s){const r=await t.arrayBuffer(),n=new Uint8Array(r),e=this.findTag(new DataView(r),[21,73,169,102]),a=this.findTag(new DataView(r),[31,67,182,117]);if(e===-1||a===-1)return t;const i=new Uint8Array([68,137,136]),f=new Uint8Array(8);new DataView(f.buffer).setFloat64(0,s,!1);const o=[n.slice(0,a),i,f,n.slice(a)];return new Blob(o,{type:t.type})}}export{u as EbmlLogic};
