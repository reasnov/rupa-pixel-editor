const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/Cs19ozkJ.js","../chunks/6DFUXpfJ.js","../chunks/BuzRps0s.js"])))=>i.map(i=>d[i]);
import{a as p,f as L,c as me,t as ce,d as nt}from"../chunks/B-fI4MTy.js";import{i as Ce}from"../chunks/CEhgvV-T.js";import{o as _t}from"../chunks/vzTqXLZe.js";import{O as At,V as $a,aV as Ra,U as Oa,A as Ma,W as Da,aW as za,a5 as Fa,n as Ut,aX as Na,aY as Ba,aZ as Ga,a_ as Ua,q as ua,a$ as It,aw as pa,b as $t,b0 as Ha,b1 as Va,b2 as Ya,b3 as Ka,b4 as Qa,b5 as qa,H as Pt,aJ as Wa,o as Xa,b6 as Za,y as U,g as a,a9 as Ja,aK as ve,p as ae,k as i,m as r,s as o,t as I,j as re,a0 as B,i as se,a as Ue,ao as xe,aI as fa,b7 as at,F as ht,b8 as ea,x as yt,b9 as er}from"../chunks/6DFUXpfJ.js";import{B as tr,_ as ar,i as M}from"../chunks/BuzRps0s.js";import{t as rr,e as s,k as Ge,p as ft,c as ta,d as Wt,f as rt,g as Q,S as xa,h as ga,_ as A,C as dt,a as _e,s as ue,i as ke,b as je,m as et,j as ir,G as Nt}from"../chunks/Cs19ozkJ.js";import{a as sr,s as E,d as Ae,e as $e}from"../chunks/awKeKM-o.js";import{p as ie,b as gt}from"../chunks/DmS3xNon.js";const or=Symbol("NaN");function nr(u,e,t){At&&$a();var n=new tr(u),l=!Ra();Oa(()=>{var d=e();d!==d&&(d=or),l&&d!==null&&typeof d=="object"&&(d={}),n.ensure(d,t)})}const lr=()=>performance.now(),pt={tick:u=>requestAnimationFrame(u),now:()=>lr(),tasks:new Set};function ma(){const u=pt.now();pt.tasks.forEach(e=>{e.c(u)||(pt.tasks.delete(e),e.f())}),pt.tasks.size!==0&&pt.tick(ma)}function cr(u){let e;return pt.tasks.size===0&&pt.tick(ma),{promise:new Promise(t=>{pt.tasks.add(e={c:u,f:t})}),abort(){pt.tasks.delete(e)}}}function Bt(u,e){pa(()=>{u.dispatchEvent(new CustomEvent(e))})}function dr(u){if(u==="float")return"cssFloat";if(u==="offset")return"cssOffset";if(u.startsWith("--"))return u;const e=u.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function sa(u){const e={},t=u.split(";");for(const n of t){const[l,d]=n.split(":");if(!l||d===void 0)break;const v=dr(l.trim());e[v]=d.trim()}return e}const vr=u=>u;function pe(u,e,t,n){var l=(u&Ba)!==0,d=(u&Ga)!==0,v=l&&d,c=(u&Na)!==0,f=v?"both":l?"in":"out",x,_=e.inert,h=e.style.overflow,g,w;function y(){return pa(()=>x??=t()(e,n?.()??{},{direction:f}))}var m={is_global:c,in(){if(e.inert=_,!l){w?.abort(),w?.reset?.();return}d||g?.abort(),g=aa(e,y(),w,1,()=>{Bt(e,"introend"),g?.abort(),g=x=void 0,e.style.overflow=h})},out(C){if(!d){C?.(),x=void 0;return}e.inert=!0,w=aa(e,y(),g,0,()=>{Bt(e,"outroend"),C?.()})},stop:()=>{g?.abort(),w?.abort()}},k=Ma;if((k.nodes.t??=[]).push(m),l&&sr){var b=c;if(!b){for(var S=k.parent;S&&(S.f&Da)!==0;)for(;(S=S.parent)&&(S.f&za)===0;);b=!S||(S.f&Fa)!==0}b&&Ut(()=>{$t(()=>m.in())})}}function aa(u,e,t,n,l){var d=n===1;if(Ua(e)){var v,c=!1;return ua(()=>{if(!c){var k=e({direction:d?"in":"out"});v=aa(u,k,t,n,l)}}),{abort:()=>{c=!0,v?.abort()},deactivate:()=>v.deactivate(),reset:()=>v.reset(),t:()=>v.t()}}if(t?.deactivate(),!e?.duration&&!e?.delay)return Bt(u,d?"introstart":"outrostart"),l(),{abort:It,deactivate:It,reset:It,t:()=>n};const{delay:f=0,css:x,tick:_,easing:h=vr}=e;var g=[];if(d&&t===void 0&&(_&&_(0,1),x)){var w=sa(x(0,1));g.push(w,w)}var y=()=>1-n,m=u.animate(g,{duration:f,fill:"forwards"});return m.onfinish=()=>{m.cancel(),Bt(u,d?"introstart":"outrostart");var k=t?.t()??1-n;t?.abort();var b=n-k,S=e.duration*Math.abs(b),C=[];if(S>0){var P=!1;if(x)for(var T=Math.ceil(S/16.666666666666668),$=0;$<=T;$+=1){var j=k+b*h($/T),R=sa(x(j,1-j));C.push(R),P||=R.overflow==="hidden"}P&&(u.style.overflow="hidden"),y=()=>{var F=m.currentTime;return k+b*h(F/S)},_&&cr(()=>{if(m.playState!=="running")return!1;var F=y();return _(F,1-F),!0})}m=u.animate(C,{duration:S,fill:"forwards"}),m.onfinish=()=>{y=()=>n,_?.(n,1-n),l()}},{abort:()=>{m&&(m.cancel(),m.effect=null,m.onfinish=It)},deactivate:()=>{l=It},reset:()=>{n===0&&_?.(1,0)},t:()=>y()}}function ha(u,e,t){Ut(()=>{var n=$t(()=>e(u,t?.())||{});if(n?.destroy)return()=>n.destroy()})}function ne(u,e,t,n,l,d){var v=u.__className;if(At||v!==t||v===void 0){var c=rr(t,n,d);(!At||c!==u.getAttribute("class"))&&(c==null?u.removeAttribute("class"):e?u.className=c:u.setAttribute("class",c)),u.__className=t}else if(d&&l!==d)for(var f in d){var x=!!d[f];(l==null||x!==!!l[f])&&u.classList.toggle(f,x)}return d}const ur=Symbol("is custom element"),pr=Symbol("is html");function Rt(u){if(At){var e=!1,t=()=>{if(!e){if(e=!0,u.hasAttribute("value")){var n=u.value;D(u,"value",null),u.value=n}if(u.hasAttribute("checked")){var l=u.checked;D(u,"checked",null),u.checked=l}}};u.__on_r=t,ua(t),Va()}}function fr(u,e){var t=_a(u);t.value===(t.value=e??void 0)||u.value===e&&(e!==0||u.nodeName!=="PROGRESS")||(u.value=e??"")}function D(u,e,t,n){var l=_a(u);At&&(l[e]=u.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&u.nodeName==="LINK")||l[e]!==(l[e]=t)&&(e==="loading"&&(u[Ha]=t),t==null?u.removeAttribute(e):typeof t!="string"&&xr(u).includes(e)?u[e]=t:u.setAttribute(e,t))}function _a(u){return u.__attributes??={[ur]:u.nodeName.includes("-"),[pr]:u.namespaceURI===Ya}}var oa=new Map;function xr(u){var e=u.getAttribute("is")||u.nodeName,t=oa.get(e);if(t)return t;oa.set(e,t=[]);for(var n,l=u,d=Element.prototype;d!==l;){n=Qa(l);for(var v in n)n[v].set&&t.push(v);l=Ka(l)}return t}function Ht(u,e,t=e){var n=new WeakSet;qa(u,"input",async l=>{var d=l?u.defaultValue:u.value;if(d=Xt(u)?Zt(d):d,t(d),Pt!==null&&n.add(Pt),await Wa(),d!==(d=e())){var v=u.selectionStart,c=u.selectionEnd,f=u.value.length;if(u.value=d??"",c!==null){var x=u.value.length;v===c&&c===f&&x>f?(u.selectionStart=x,u.selectionEnd=x):(u.selectionStart=v,u.selectionEnd=Math.min(c,x))}}}),(At&&u.defaultValue!==u.value||$t(e)==null&&u.value)&&(t(Xt(u)?Zt(u.value):u.value),Pt!==null&&n.add(Pt)),Xa(()=>{var l=e();if(u===document.activeElement){var d=Za??Pt;if(n.has(d))return}Xt(u)&&l===Zt(u.value)||u.type==="date"&&!l&&!u.value||l!==u.value&&(u.value=l??"")})}function Xt(u){var e=u.type;return e==="number"||e==="range"}function Zt(u){return u===""?null:+u}function wt(u){var e=Ja(0);return function(){return arguments.length===1?(U(e,a(e)+1),arguments[0]):(a(e),u())}}class gr{#e=ve("KEYBOARD");get activeSource(){return a(this.#e)}set activeSource(e){U(this.#e,e,!0)}listeners=[];constructor(){}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}emit(e,t,n){this.activeSource=t;const l={intent:e,source:t,meta:n};this.listeners.forEach(d=>d(l))}mount(e){const t=l=>{if(!s.isAppReady)return;Ge.updatePhysicalState(l,"down");const d=l.target,v=document.activeElement;if((d.tagName==="INPUT"||d.tagName==="TEXTAREA"||d.isContentEditable||d.closest('input, textarea, [contenteditable="true"]')||v?.tagName==="INPUT"||v?.tagName==="TEXTAREA"||v?.isContentEditable)&&l.key!=="Escape")return;const f=Ge.getIntent(l);f&&(l.preventDefault(),this.emit(f,"KEYBOARD"))},n=l=>{Ge.updatePhysicalState(l,"up")};return e.addEventListener("keydown",t),e.addEventListener("keyup",n),()=>{e.removeEventListener("keydown",t),e.removeEventListener("keyup",n)}}bindCanvas(e){const t=d=>{const v=d.pointerType==="pen"?"PEN":d.pointerType==="touch"?"TOUCH":"MOUSE";ft.handleStart(d,e),this.activeSource=v},n=d=>{ft.handleMove(d,e)},l=d=>{ft.handleEnd()};return e.addEventListener("pointerdown",t),window.addEventListener("pointermove",n),window.addEventListener("pointerup",l),()=>{e.removeEventListener("pointerdown",t),window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",l)}}}const Jt=new gr;class mr{isPlaying=!1;nextNoteTime=0;timer=null;get ctx(){return ta.ctx}scale=Wt.ambient.scale;chords=Wt.ambient.chords;currentChordIndex=0;toggle(){this.isPlaying?this.stop():this.start()}start(){this.isPlaying||(this.isPlaying=!0,this.nextNoteTime=this.ctx.currentTime,this.scheduler())}stop(){this.isPlaying=!1,clearTimeout(this.timer)}scheduler(){if(!this.isPlaying||s.studio.isMuted||!s.studio.isAmbientPlaying){this.timer=setTimeout(()=>this.scheduler(),100);return}for(;this.nextNoteTime<this.ctx.currentTime+.1;){this.playGenerativeNote(this.nextNoteTime);const e=.8+Math.random()*1.7;this.nextNoteTime+=e,Math.random()>.85&&(this.currentChordIndex=(this.currentChordIndex+1)%this.chords.length)}this.timer=setTimeout(()=>this.scheduler(),50)}playGenerativeNote(e){const t=this.chords[this.currentChordIndex],l=Math.random()>.3?t[Math.floor(Math.random()*t.length)]:this.scale[Math.floor(Math.random()*this.scale.length)];this.pianoPluck(l,e),this.pianoPluck(l*2,e,.08),Math.random()>.7&&this.pianoPluck(l*.5,e+.05,.1)}pianoPluck(e,t,n=.3){const{startMins:l,fullMins:d}=Wt.ambient.fade,v=s.usageMinutes;let c=0;v>=l&&v<d?c=(v-l)/(d-l):v>=d&&(c=1);const f=n*c*s.bgmVolume;if(f<.001)return;const x=this.ctx.createOscillator(),_=this.ctx.createGain(),h=this.ctx.createBiquadFilter();x.type=Math.random()>.5?"sine":"triangle",x.frequency.setValueAtTime(e,t),h.type="lowpass",h.frequency.setValueAtTime(1200,t),h.frequency.exponentialRampToValueAtTime(400,t+1.5),_.gain.setValueAtTime(0,t),_.gain.linearRampToValueAtTime(f,t+.02),_.gain.exponentialRampToValueAtTime(1e-4,t+2.5),x.connect(h),h.connect(_),_.connect(this.ctx.destination),x.start(t),x.stop(t+2.6)}}const hr=new mr;class _r{#e=ve(!0);get isEnabled(){return a(this.#e)}set isEnabled(e){U(this.#e,e,!0)}#t=ve(!1);get screenShake(){return a(this.#t)}set screenShake(e){U(this.#t,e,!0)}#a=ve(null);get flashColor(){return a(this.#a)}set flashColor(e){U(this.#a,e,!0)}emit(e){this.isEnabled&&(this.playAudio(e),this.triggerVisual(e),typeof navigator.vibrate=="function"&&this.triggerHaptic(e))}playAudio(e){switch(e){case"DRAW":rt.playDraw();break;case"ERASE":rt.playErase();break;case"MOVE":rt.playMove();break;case"STARTUP":rt.playStartup();break;case"READY":rt.playReady();break}}triggerVisual(e){e==="CLEAR_CANVAS"&&(this.screenShake=!0,setTimeout(()=>this.screenShake=!1,200)),e==="READY"&&(this.flashColor="rgba(211, 54, 130, 0.1)",setTimeout(()=>this.flashColor=null,500))}triggerHaptic(e){e==="DRAW"&&navigator.vibrate(5),e==="ERASE"&&navigator.vibrate(10)}}const ge=new _r;class br{backupInterval=null;autoSaveTimer=null;unsubscribeInput=null;mount(){this.backupInterval=setInterval(()=>Q.persistence.backup(),600*1e3),s.studio.mount(),s.canvas.mount();const e=async()=>{s.studio.isAudioReady||(await ta.resume(),hr.start(),s.studio.isAudioReady=!0,window.removeEventListener("pointerdown",e),window.removeEventListener("keydown",e))};window.addEventListener("pointerdown",e,{passive:!0}),window.addEventListener("keydown",e,{passive:!0}),ft.onActivity=()=>{s.cursor.resetInactivityTimer(),this.resetAutoSaveTimer()},ar(()=>import("../chunks/Cs19ozkJ.js").then(n=>n.l),__vite__mapDeps([0,1,2]),import.meta.url).then(async({PersistenceService:n})=>{const l=new n,d=await xa.loadProject("autosave_session");d&&d.length>1e3&&(s.studio.showRecoveryPrompt=!0),l.loadGlobalPalettes()}),this.unsubscribeInput=Jt.subscribe(n=>{this.handleIntent(n.intent)});const t=Jt.mount(window);return()=>{this.unsubscribeInput&&this.unsubscribeInput(),t(),clearInterval(this.backupInterval),this.autoSaveTimer&&clearTimeout(this.autoSaveTimer)}}connectCanvas(e){return Jt.bindCanvas(e)}handleIntent(e){if(ta.resume(),s.cursor.resetInactivityTimer(),this.resetAutoSaveTimer(),Ge.isCtrlActive&&Ge.isAltActive&&["MOVE_UP","MOVE_DOWN","MOVE_LEFT","MOVE_RIGHT"].includes(e)){const t=e==="MOVE_LEFT"?-1:e==="MOVE_RIGHT"?1:0,n=e==="MOVE_UP"?-1:e==="MOVE_DOWN"?1:0;s.studio.underlayOffset.x+=t,s.studio.underlayOffset.y+=n;return}this.handleNavigationIntent(e)||this.handleDrawIntent(e)||this.handleSelectionIntent(e)||this.handleProjectIntent(e)||this.handleViewportIntent(e)||this.handleToolSettingsIntent(e)||this.handleSystemIntent(e)}handleNavigationIntent(e){switch(e){case"MOVE_UP":return this.executeMove(0,-1),!0;case"MOVE_DOWN":return this.executeMove(0,1),!0;case"MOVE_LEFT":return this.executeMove(-1,0),!0;case"MOVE_RIGHT":return this.executeMove(1,0),!0;case"JUMP_HOME":return Q.jumpHome(),!0;case"GOTO":return s.showGoTo=!0,!0;case"RESET_PAN":return s.studio.resetPan(),ge.emit("READY"),!0}return!1}handleDrawIntent(e){switch(e){case"PAINT":return s.selection.isActive?Q.selection.fillSelection():s.studio.activeTool!=="BRUSH"?Q.draw.commitShape():Q.draw.draw(),!0;case"ERASE":return s.selection.isActive?Q.selection.eraseSelection():Q.draw.erase(),!0;case"FLOOD_FILL":return Q.color.floodFill(),!0;case"PICK_COLOR":return Q.color.pickFromCanvas(),!0;case"RECOLOR":return Q.manipulation.recolorAll(),!0}return!1}handleSelectionIntent(e){switch(e){case"BIND_VERTEX":return Q.selection.addVertex(s.cursor.pos.x,s.cursor.pos.y),!0;case"SEAL_BINDING":return s.selection.vertices.length>=3?Q.selection.commitPolygon():s.selection.isActive?Q.selection.commit():s.studio.activeTool!=="BRUSH"?Q.draw.commitShape():Q.draw.draw(),!0;case"COPY":return Q.clipboard.copy(),!0;case"CUT":return Q.clipboard.cut(),!0;case"PASTE":return Q.clipboard.paste(),!0;case"SELECT_ALL":return Q.selection.selectAll(),!0;case"SELECT_SAME":return Q.selection.magicWand(),!0}return!1}handleProjectIntent(e){switch(e){case"UNDO":return s.undo(),!0;case"REDO":return s.redo(),!0;case"SAVE":return s.showPersistenceMenu=!0,!0;case"OPEN":return Q.persistence.load(),!0;case"NEW_ITEM":return s.studio.projectActiveTab==="frames"?Q.project.addFrame():Q.project.addLayer(),!0;case"NEW_LAYER_GROUP":return Q.project.addGroup(),!0;case"DUPLICATE_ITEM":return s.studio.projectActiveTab==="frames"?Q.project.duplicateFrame(s.project.activeFrameIndex):Q.project.duplicateLayer(s.project.activeFrame.activeLayerIndex),!0;case"DELETE_ITEM":return s.studio.projectActiveTab==="frames"?Q.project.removeFrame(s.project.activeFrameIndex):Q.project.removeLayer(s.project.activeFrame.activeLayerIndex),!0;case"TOGGLE_LAYER_LOCK":return Q.project.toggleLock(),!0;case"TOGGLE_LAYER_VISIBILITY":return Q.project.toggleVisibility(),!0;case"MOVE_ITEM_UP":if(s.studio.projectActiveTab==="frames"){const t=s.project.activeFrameIndex;t<s.project.frames.length-1&&Q.project.reorderFrame(t,t+1)}else Q.project.moveLayerUp();return!0;case"MOVE_ITEM_DOWN":if(s.studio.projectActiveTab==="frames"){const t=s.project.activeFrameIndex;t>0&&Q.project.reorderFrame(t,t-1)}else Q.project.moveLayerDown();return!0;case"MOVE_ITEM_TOP":return s.studio.projectActiveTab==="frames"?Q.project.reorderFrame(s.project.activeFrameIndex,s.project.frames.length-1):Q.project.moveLayerToTop(),!0;case"MOVE_ITEM_BOTTOM":return s.studio.projectActiveTab==="frames"?Q.project.reorderFrame(s.project.activeFrameIndex,0):Q.project.moveLayerToBottom(),!0;case"MERGE_LAYERS":return Q.project.mergeLayerDown(),!0;case"MERGE_SELECTED_LAYERS":return Q.project.mergeSelectedLayers(),!0;case"MERGE_FRAMES":return Q.project.mergeFrames(),!0;case"PLAY_PAUSE":return ga.togglePlayback(),!0;case"TOGGLE_GHOST_LAYERS":return s.showGhostLayers=!s.showGhostLayers,!0}return!1}handleViewportIntent(e){switch(e){case"ZOOM_IN":return s.studio.setZoom(.1),!0;case"ZOOM_OUT":return s.studio.setZoom(-.1),!0;case"RESET_ZOOM":return s.studio.resetZoom(),!0;case"RESET_VIEWPORT":return s.studio.resetZoom(),s.studio.resetPan(),ge.emit("READY"),!0;case"FLIP_H":return Q.manipulation.flip("horizontal"),!0;case"FLIP_V":return Q.manipulation.flip("vertical"),!0;case"ROTATE":return Q.manipulation.rotate(),!0;case"TAB_TIMELINE":return s.studio.projectActiveTab="frames",ge.emit("READY"),!0;case"TAB_LAYERS":return s.studio.projectActiveTab="layers",ge.emit("READY"),!0}return!1}handleToolSettingsIntent(e){switch(e){case"BRUSH_SIZE_INC":return s.studio.brushSize=Math.min(100,s.studio.brushSize+1),ge.emit("READY"),!0;case"BRUSH_SIZE_DEC":return s.studio.brushSize=Math.max(1,s.studio.brushSize-1),ge.emit("READY"),!0;case"TOGGLE_PATTERN_BRUSH":if(s.studio.isPatternBrushActive)s.studio.isPatternBrushActive=!1;else if(s.project.clipboard){const t=s.project.clipboard;s.studio.patternBrushData={width:t.width,height:t.height,data:new Uint32Array(t.data)},s.studio.isPatternBrushActive=!0}return ge.emit("READY"),!0;case"TOGGLE_BRUSH_SHAPE":return s.studio.brushShape=s.studio.brushShape==="SQUARE"?"CIRCLE":"SQUARE",ge.emit("READY"),!0;case"TOGGLE_AIRBRUSH":return s.studio.isAirbrushActive=!s.studio.isAirbrushActive,s.studio.show(A(s.studio.isAirbrushActive?"ui:studio.mist_active":"ui:studio.mist_off")),ge.emit("READY"),!0;case"TOGGLE_PIXEL_PERFECT":return s.studio.isPixelPerfect=!s.studio.isPixelPerfect,ge.emit("READY"),!0;case"TOGGLE_DITHER_BLEND":return s.studio.isDitherBlendActive=!s.studio.isDitherBlendActive,s.studio.show(A(s.studio.isDitherBlendActive?"ui:studio.blend_on":"ui:studio.blend_off")),ge.emit("READY"),!0;case"TOGGLE_SHADE_LIGHTEN":case"SHADE_LIGHTEN":return s.studio.isShadingLighten=!s.studio.isShadingLighten,s.studio.isShadingLighten&&(s.studio.isShadingDarken=!1,s.studio.isShadingDither=!1),s.studio.show(A(s.studio.isShadingLighten?"ui:studio.light_roast_active":"ui:studio.light_roast_off")),ge.emit("READY"),!0;case"TOGGLE_SHADE_DARKEN":case"SHADE_DARKEN":return s.studio.isShadingDarken=!s.studio.isShadingDarken,s.studio.isShadingDarken&&(s.studio.isShadingLighten=!1,s.studio.isShadingDither=!1),s.studio.show(A(s.studio.isShadingDarken?"ui:studio.dark_roast_active":"ui:studio.dark_roast_off")),ge.emit("READY"),!0;case"TOGGLE_SHADE_DITHER":case"SHADE_DITHER":return s.studio.isShadingDither=!s.studio.isShadingDither,s.studio.isShadingDither&&(s.studio.isShadingLighten=!1,s.studio.isShadingDarken=!1),s.studio.show(A(s.studio.isShadingDither?"ui:studio.texture_active":"ui:studio.texture_off")),ge.emit("READY"),!0;case"TOGGLE_COLOR_LOCK":if(s.studio.isColorLocked)s.studio.isColorLocked=!1,s.studio.colorLockSource=null;else{s.studio.isColorLocked=!0;const t=s.canvas.getColor(s.cursor.pos.x,s.cursor.pos.y);s.studio.colorLockSource=dt.uint32ToHex(t)}return ge.emit("READY"),!0;case"POLY_SIDES_INC":return s.studio.polygonSides=Math.min(12,s.studio.polygonSides+1),s.studio.show(A("ui:studio.facets",{replace:{count:s.studio.polygonSides}})),ge.emit("READY"),!0;case"POLY_SIDES_DEC":return s.studio.polygonSides=Math.max(3,s.studio.polygonSides-1),s.studio.show(A("ui:studio.facets",{replace:{count:s.studio.polygonSides}})),ge.emit("READY"),!0;case"POLY_INDENT_INC":return s.studio.polygonIndentation=Math.min(100,s.studio.polygonIndentation+10),s.studio.show(A("ui:studio.steeping",{replace:{count:s.studio.polygonIndentation}})),ge.emit("READY"),!0;case"POLY_INDENT_DEC":return s.studio.polygonIndentation=Math.max(0,s.studio.polygonIndentation-10),s.studio.show(A("ui:studio.steeping",{replace:{count:s.studio.polygonIndentation}})),ge.emit("READY"),!0}return!1}handleSystemIntent(e){switch(e){case"OPEN_MENU":return s.showCommandPalette=!s.showCommandPalette,!0;case"OPEN_SETTINGS":return s.showCanvasSettings=!s.showCanvasSettings,!0;case"OPEN_PALETTE":return s.showColorPicker=!s.showColorPicker,!0;case"OPEN_AUDIO":return s.showAudioSettings=!s.showAudioSettings,!0;case"OPEN_EXPORT":return s.showExportMenu=!0,!0;case"OPEN_HELP":return s.showShortcuts=!0,!0;case"OPEN_MANUAL":return s.showManual=!0,!0;case"ESCAPE":return s.handleEscape(),!0;case"CLEAR_CANVAS":return Q.manipulation.clearAll(),!0;case"TOGGLE_MUTE":return s.studio.toggleMute(),!0;case"TOGGLE_MINIMAP":return s.studio.showMinimap=!s.studio.showMinimap,ge.emit("READY"),!0;case"TOGGLE_HAND_TOOL":return s.studio.isHandToolActive=!s.studio.isHandToolActive,ge.emit("READY"),!0;case"CYCLE_SYMMETRY":const t=["OFF","HORIZONTAL","VERTICAL","QUADRANT"],n=t.indexOf(s.studio.symmetryMode);return s.studio.symmetryMode=t[(n+1)%t.length],ge.emit("READY"),!0;case"TOGGLE_TILING":return s.studio.isTilingEnabled=!s.studio.isTilingEnabled,ge.emit("READY"),!0;case"TOGGLE_ALPHA_LOCK":return s.studio.isAlphaLocked=!s.studio.isAlphaLocked,ge.emit("READY"),!0;case"TOGGLE_UNDERLAY":return s.studio.isUnderlayVisible=!s.studio.isUnderlayVisible,ge.emit("READY"),!0;case"OPEN_UNDERLAY_MENU":return s.studio.showUnderlayMenu=!s.studio.showUnderlayMenu,ge.emit("READY"),!0;case"TOOL_RECTANGLE":return s.studio.activeTool="RECTANGLE",s.studio.shapeAnchor={...s.cursor.pos},ge.emit("READY"),!0;case"TOOL_ELLIPSE":return s.studio.activeTool="ELLIPSE",s.studio.shapeAnchor={...s.cursor.pos},ge.emit("READY"),!0;case"TOOL_POLYGON":return s.studio.activeTool="POLYGON",s.studio.shapeAnchor={...s.cursor.pos},ge.emit("READY"),!0;case"TOOL_RECT_SELECT":return s.studio.activeTool="RECT_SELECT",ge.emit("READY"),!0;case"TOOL_LASSO_SELECT":return s.studio.activeTool="LASSO_SELECT",ge.emit("READY"),!0;case"TOOL_POLY_SELECT":return s.studio.activeTool="POLY_SELECT",ge.emit("READY"),!0;case"TOOL_BRUSH":return s.studio.activeTool="BRUSH",ge.emit("READY"),!0;case"TOOL_ERASER":return s.studio.activeTool="ERASER",ge.emit("READY"),!0;case"TOOL_TRANSFORM":return s.selection.isActive&&(s.studio.isTransforming=!s.studio.isTransforming,ge.emit("READY")),!0}if(e.startsWith("SET_SIDES_")){const t=parseInt(e.split("_")[2]);return s.studio.polygonSides=t,s.studio.show(A("ui:studio.facets",{replace:{count:t}})),ge.emit("READY"),!0}if(e.startsWith("SELECT_COLOR_")){const t=parseInt(e.split("_")[2]);return Q.color.select(t===0?9:t-1),!0}return!1}executeMove(e,t){if(s.studio.isTransforming&&s.selection.isActive){Q.selection.nudge(e,t);return}const n=Ge.isCtrlActive&&Ge.isShiftActive,l=Ge.isCtrlActive&&!Ge.isShiftActive,d=Ge.isShiftActive&&!Ge.isCtrlActive;d&&!s.selection.start&&(s.studio.activeTool="RECT_SELECT",Q.selection.begin(s.cursor.pos.x,s.cursor.pos.y)),Q.movement.move(e,t)&&(d?Q.selection.update(s.cursor.pos.x,s.cursor.pos.y):n?Q.draw.erase():l&&Q.draw.draw())}resetAutoSaveTimer(){this.autoSaveTimer&&clearTimeout(this.autoSaveTimer),this.autoSaveTimer=setTimeout(()=>{Q.persistence.autoSaveSession()},1e4)}}const Ze=new br;var Ar=L('<div class="pixel-steam"></div>'),yr=L('<div class="h-3 w-px bg-text-main/20" aria-hidden="true"></div>'),wr=L('<div><div class="absolute -top-4 left-1/2 -translate-x-1/2"></div> <h1> </h1> <!> <p> </p></div>');function ba(u,e){ae(e,!0);let t=ie(e,"size",3,"md");const n={sm:{h1:"text-2xl",p:"text-[9px]",gap:"gap-3"},md:{h1:"text-4xl",p:"text-[11px]",gap:"gap-2"},lg:{h1:"text-7xl",p:"text-[14px]",gap:"gap-4"}};let l=B(()=>n[t()]),d=B(()=>t()==="sm"?"flex-row items-center":"flex-col items-center");var v=wr(),c=i(v);_e(c,20,()=>Array.from({length:3}),ke,(y,m,k)=>{var b=Ar();ue(b,`
					animation: steam-drift ${2+k}s infinite ease-out; 
					animation-delay: ${k*.8}s;
					left: ${k*10-10}px;
				`),p(y,b)}),r(c);var f=o(c,2),x=i(f,!0);r(f);var _=o(f,2);{var h=y=>{var m=yr();p(y,m)};M(_,y=>{t()==="sm"&&y(h)})}var g=o(_,2),w=i(g,!0);r(g),r(v),I((y,m)=>{ne(v,1,`relative flex ${a(d)??""} ${a(l).gap??""} justify-center text-center select-none`),ne(f,1,`font-tiny5 leading-none text-text-main ${a(l).h1??""} tracking-tighter`),E(x,y),ne(g,1,`font-serif font-bold tracking-[0.4em] text-text-main/40 uppercase ${a(l).p??""}`),E(w,m)},[()=>A("common:app.name"),()=>A("common:app.tagline")]),p(u,v),re()}var kr=L("<button><!> <!></button>");function fe(u,e){ae(e,!0);let t=ie(e,"variant",3,"secondary"),n=ie(e,"size",3,"md"),l=ie(e,"isActive",3,!1),d=ie(e,"disabled",3,!1),v=ie(e,"type",3,"button"),c=ie(e,"class",3,"");const f={primary:"editor-primary-btn",secondary:"editor-secondary-btn",tool:"editor-tool-btn",ghost:"bg-transparent border-none shadow-none hover:bg-black/5 active:bg-black/10",danger:"bg-ui-danger text-white border-2 border-ui-structural shadow-[4px_4px_0px_var(--color-ui-structural)] hover:brightness-110 active:shadow-none active:translate-x-0.5 active:translate-y-0.5"},x={sm:"px-2 py-1 text-[10px]",md:"px-4 py-2 text-xs",lg:"px-6 py-3 text-sm"};var _=kr();_.__click=function(...m){e.onclick?.apply(this,m)};var h=i(_);{var g=m=>{var k=me(),b=se(k);je(b,()=>e.icon),p(m,k)};M(h,m=>{e.icon&&m(g)})}var w=o(h,2);{var y=m=>{var k=me(),b=se(k);je(b,()=>e.children),p(m,k)};M(w,m=>{e.children&&m(y)})}r(_),I((m,k)=>{D(_,"type",v()),_.disabled=d(),D(_,"aria-label",m),D(_,"title",k),ne(_,1,`
        relative flex cursor-pointer flex-nowrap items-center justify-center gap-2
        whitespace-nowrap select-none focus:ring-2 focus:ring-ui-accent
        focus:ring-offset-2 focus:outline-none disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50
        ${f[t()]??""}
        ${(t()!=="ghost"&&x[n()])??""}
        ${l()?"is-active tool-button":""}
        ${c()??""}
    `)},[()=>A(e.ariaLabel),()=>A(e.ariaLabel)]),p(u,_),re()}Ae(["click"]);var tt=wt(()=>s),Er=L('<span aria-hidden="true">üìñ</span> <span class="hidden xl:inline"> </span>',1),Lr=L('<span aria-hidden="true">üì¶</span> <span class="hidden xl:inline"> </span>',1),Sr=L('<span aria-hidden="true">üçÉ</span> <span class="hidden xl:inline"> </span>',1),Cr=L('<span aria-hidden="true"> </span> <span class="hidden xl:inline"> </span>',1),Tr=L('<span aria-hidden="true">üìú</span> <span class="hidden xl:inline"> </span>',1),Ir=L('<span aria-hidden="true">‚å®Ô∏è</span> <span class="hidden xl:inline"> </span>',1),Pr=L('<nav class="flex items-center gap-2" aria-label="Editor Tools"><div class="flex gap-1.5" role="group"><!> <!></div> <div class="mx-2 h-4 w-px bg-text-main/10" aria-hidden="true"></div> <div class="flex gap-1.5" role="group"><!> <!></div> <div class="mx-2 h-4 w-px bg-text-main/10" aria-hidden="true"></div> <div class="flex gap-1.5" role="group"><!> <!></div></nav>');function jr(u,e){ae(e,!1),Ce();var t=Pr(),n=i(t),l=i(n);fe(l,{variant:"tool",onclick:()=>tt(tt().showCommandPalette=!0),ariaLabel:"workspace:hud.menu.catalog_title",children:(g,w)=>{var y=Er(),m=o(se(y),2),k=i(m,!0);r(m),I(b=>E(k,b),[()=>A("workspace:hud.menu.catalog_title")]),p(g,y)},$$slots:{default:!0}});var d=o(l,2);fe(d,{variant:"tool",onclick:()=>tt(tt().showExportMenu=!0),ariaLabel:"export:title",children:(g,w)=>{var y=Lr(),m=o(se(y),2),k=i(m,!0);r(m),I(b=>E(k,b),[()=>A("export:title")]),p(g,y)},$$slots:{default:!0}}),r(n);var v=o(n,4),c=i(v);fe(c,{variant:"tool",onclick:()=>tt().clearCanvas(),ariaLabel:"workspace:hud.actions.clear_canvas",children:(g,w)=>{var y=Sr(),m=o(se(y),2),k=i(m,!0);r(m),I(b=>E(k,b),[()=>A("workspace:hud.actions.clear_canvas")]),p(g,y)},$$slots:{default:!0}});var f=o(c,2);fe(f,{variant:"tool",onclick:()=>tt(tt().showAudioSettings=!0),ariaLabel:"workspace:hud.audio.title",children:(g,w)=>{var y=Cr(),m=se(y),k=i(m,!0);r(m);var b=o(m,2),S=i(b,!0);r(b),I(C=>{E(k,tt().isMuted?"üîá":"üîä"),E(S,C)},[()=>A("workspace:hud.audio.title")]),p(g,y)},$$slots:{default:!0}}),r(v);var x=o(v,4),_=i(x);fe(_,{variant:"tool",onclick:()=>tt(tt().showManual=!0),ariaLabel:"manual:title",children:(g,w)=>{var y=Tr(),m=o(se(y),2),k=i(m,!0);r(m),I(b=>E(k,b),[()=>A("manual:title")]),p(g,y)},$$slots:{default:!0}});var h=o(_,2);fe(h,{variant:"tool",onclick:()=>tt(tt().showShortcuts=!0),ariaLabel:"shortcuts:title",children:(g,w)=>{var y=Ir(),m=o(se(y),2),k=i(m,!0);r(m),I(b=>E(k,b),[()=>A("shortcuts:title")]),p(g,y)},$$slots:{default:!0}}),r(x),r(t),p(u,t),re()}var $r=L('<div class="relative flex h-full w-full items-center justify-center overflow-hidden"><span>‚òÄÔ∏è</span> <span>üåô</span></div>');function Rr(u,e){ae(e,!1);const t=s.studio;function n(){rt.playCeramicSlide(),t.toggleTheme()}Ce(),fe(u,{variant:"ghost",size:"sm",onclick:n,ariaLabel:"ui:labels.switch_theme",class:"relative h-8 w-8 !p-0",children:(l,d)=>{var v=$r(),c=i(v),f=o(c,2);r(v),I(()=>{ne(c,1,`text-lg transition-transform duration-500 ${t.theme==="light"?"translate-y-0":"translate-y-10"}`),ne(f,1,`absolute text-lg transition-transform duration-500 ${t.theme==="dark"?"translate-y-0":"-translate-y-10"}`)}),p(l,v)},$$slots:{default:!0}}),re()}var Or=L('<header class="hud-panel flex h-14 w-full items-center justify-between px-8 py-2 select-none svelte-dk19pb"><div class="flex items-center gap-12"><!> <div class="h-6 w-px bg-text-main/10" aria-hidden="true"></div> <!></div> <div class="flex items-center gap-6"><!> <!></div></header>');function Mr(u){var e=Or(),t=i(e),n=i(t);ba(n,{size:"sm"});var l=o(n,4);jr(l,{}),r(t);var d=o(t,2),v=i(d);Rr(v,{}),o(v,2),r(d),r(e),p(u,e)}const Dr=u=>u;function ra(u){const e=u-1;return e*e*e+1}function na(u){const e=typeof u=="string"&&u.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[u,"px"]}function he(u,{delay:e=0,duration:t=400,easing:n=Dr}={}){const l=+getComputedStyle(u).opacity;return{delay:e,duration:t,easing:n,css:d=>`opacity: ${d*l}`}}function Vt(u,{delay:e=0,duration:t=400,easing:n=ra,x:l=0,y:d=0,opacity:v=0}={}){const c=getComputedStyle(u),f=+c.opacity,x=c.transform==="none"?"":c.transform,_=f*(1-v),[h,g]=na(l),[w,y]=na(d);return{delay:e,duration:t,easing:n,css:(m,k)=>`
			transform: ${x} translate(${(1-m)*h}${g}, ${(1-m)*w}${y});
			opacity: ${f-_*k}`}}function Aa(u,{delay:e=0,duration:t=400,easing:n=ra,axis:l="y"}={}){const d=getComputedStyle(u),v=+d.opacity,c=l==="y"?"height":"width",f=parseFloat(d[c]),x=l==="y"?["top","bottom"]:["left","right"],_=x.map(b=>`${b[0].toUpperCase()}${b.slice(1)}`),h=parseFloat(d[`padding${_[0]}`]),g=parseFloat(d[`padding${_[1]}`]),w=parseFloat(d[`margin${_[0]}`]),y=parseFloat(d[`margin${_[1]}`]),m=parseFloat(d[`border${_[0]}Width`]),k=parseFloat(d[`border${_[1]}Width`]);return{delay:e,duration:t,easing:n,css:b=>`overflow: hidden;opacity: ${Math.min(b*20,1)*v};${c}: ${b*f}px;padding-${x[0]}: ${b*h}px;padding-${x[1]}: ${b*g}px;margin-${x[0]}: ${b*w}px;margin-${x[1]}: ${b*y}px;border-${x[0]}-width: ${b*m}px;border-${x[1]}-width: ${b*k}px;min-${c}: 0`}}function kt(u,{delay:e=0,duration:t=400,easing:n=ra,start:l=0,opacity:d=0}={}){const v=getComputedStyle(u),c=+v.opacity,f=v.transform==="none"?"":v.transform,x=1-l,_=c*(1-d);return{delay:e,duration:t,easing:n,css:(h,g)=>`
			transform: ${f} scale(${1-x*g});
			opacity: ${c-_*g}
		`}}var zr=L('<div class="flex items-center justify-between px-1"><label class="text-[10px] font-bold tracking-widest text-text-main/70 uppercase"> </label> <span class="font-mono text-[10px] text-text-main/90"> </span></div>'),Fr=L(`<div><!> <div class="relative flex h-8 w-full items-center"><div class="absolute h-1.5 w-full overflow-hidden rounded-full border border-ui-structural bg-grid-border"><div class="h-full border-r border-ui-structural bg-ui-accent"></div></div> <input type="range" class="
                absolute inset-0 h-full w-full cursor-pointer opacity-0
                disabled:cursor-not-allowed
            "/> <div class="
                pointer-events-none absolute flex h-4 w-4 items-center justify-center
                rounded-sm border-2 border-ui-structural
                bg-canvas-bg shadow-[2px_2px_0px_var(--color-ui-structural)]
            "><div class="h-1.5 w-1.5 rounded-full bg-ui-structural opacity-20"></div></div></div></div>`);function ot(u,e){ae(e,!0);let t=ie(e,"value",15),n=ie(e,"min",3,0),l=ie(e,"max",3,100),d=ie(e,"step",3,1),v=ie(e,"disabled",3,!1),c=ie(e,"class",3,"");const f=`slider-${Math.random().toString(36).slice(2,9)}`;let x=B(()=>(t()-n())/(l()-n())*100);function _(P){const T=P.target,$=Number(T.value);t($),e.oninput&&e.oninput($)}function h(P){const T=P.target,$=Number(T.value);e.onchange&&e.onchange($)}var g=Fr(),w=i(g);{var y=P=>{var T=zr(),$=i(T),j=i($,!0);r($);var R=o($,2),F=i(R,!0);r(R),r(T),I(ee=>{D($,"for",f),E(j,ee),E(F,t())},[()=>A(e.label)]),p(P,T)};M(w,P=>{e.label&&P(y)})}var m=o(w,2),k=i(m),b=i(k);r(k);var S=o(k,2);Rt(S),S.__input=_,S.__change=h;var C=o(S,2);r(m),r(g),I(P=>{ne(g,1,`flex w-full flex-col gap-1.5 ${c()??""}`),ue(b,`width: ${a(x)??""}%`),D(S,"id",f),D(S,"min",n()),D(S,"max",l()),D(S,"step",d()),S.disabled=v(),D(S,"aria-label",P),D(S,"aria-valuemin",n()),D(S,"aria-valuemax",l()),D(S,"aria-valuenow",t()),ue(C,`left: calc(${a(x)??""}% - 8px)`)},[()=>A(e.ariaLabel)]),Ht(S,t),p(u,g),re()}Ae(["input","change"]);var Nr=L('<span class="text-xs font-bold tracking-widest text-text-main/90 uppercase"> </span>'),Br=L('<div><button type="button" role="switch"><div></div></button> <!></div>');function Yt(u,e){ae(e,!0);let t=ie(e,"checked",15),n=ie(e,"disabled",3,!1),l=ie(e,"class",3,"");function d(){n()||(t(!t()),e.onchange&&e.onchange(t()))}var v=Br(),c=i(v);c.__click=d;var f=i(c);r(c);var x=o(c,2);{var _=h=>{var g=Nr(),w=i(g,!0);r(g),I(y=>E(w,y),[()=>A(e.label)]),p(h,g)};M(x,h=>{e.label&&h(_)})}r(v),I((h,g)=>{ne(v,1,`flex items-center gap-3 ${l()??""}`),D(c,"aria-checked",t()),D(c,"aria-label",h),D(c,"title",g),c.disabled=n(),ne(c,1,`
            relative flex h-6 w-10 cursor-pointer items-center rounded-full border-2
            border-ui-structural bg-grid-border transition-all select-none
            disabled:cursor-not-allowed disabled:opacity-50
            ${t()?"bg-ui-accent":""}
        `),ne(f,1,`
                absolute left-1 h-4 w-4 rounded-full border border-ui-structural
                bg-canvas-bg shadow-[1px_1px_0px_var(--color-ui-structural)] transition-transform duration-100
                ease-in-out
                ${t()?"translate-x-4":""}
            `)},[()=>A(e.ariaLabel),()=>A(e.ariaLabel)]),p(u,v),re()}Ae(["click"]);var Gr=L('<div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <div class="flex items-center justify-between"><div class="flex flex-col"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/40 uppercase"> </span> <span class="font-serif text-[8px] text-text-main/30 italic"> </span></div> <!></div> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <!> <!>',1),Ur=L('<div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <div class="flex flex-col gap-1 rounded-lg bg-ui-accent/5 p-2 ring-1 ring-ui-accent/10"><span class="font-serif text-[10px] font-bold tracking-widest text-ui-accent uppercase"> </span> <span class="font-serif text-[8px] leading-tight text-ui-accent/60 italic"> </span></div>',1),Hr=L('<div class="mr-2 mb-2 flex flex-col gap-4 rounded-xl border border-text-main/5 bg-white/40 p-4 pt-2 shadow-sm backdrop-blur-sm"><!> <!> <!></div>');function la(u,e){ae(e,!0);let t=ie(e,"target",7),n=B(()=>"isLinked"in t()),l=B(()=>"duration"in t());var d=Hr(),v=i(d);ot(v,{label:"workspace:project_panel.opacity",min:0,max:1,step:.01,ariaLabel:"workspace:project_panel.opacity",get value(){return t().opacity},set value(h){t().opacity=h}});var c=o(v,2);{var f=h=>{var g=Gr(),w=o(se(g),2),y=i(w),m=i(y),k=i(m,!0);r(m);var b=o(m,2),S=i(b,!0);r(b),r(y);var C=o(y,2);Yt(C,{ariaLabel:"workspace:hud.sync_label",get checked(){return t().isLinked},set checked($){t().isLinked=$}}),r(w);var P=o(w,4);ot(P,{label:"export:wiggle_modifier",min:0,max:5,step:.5,ariaLabel:"export:wiggle_modifier",get value(){return t().wiggleAmount},set value($){t().wiggleAmount=$}});var T=o(P,2);ot(T,{label:"export:sway_modifier",min:0,max:20,step:1,ariaLabel:"export:sway_modifier",get value(){return t().swayAmount},set value($){t().swayAmount=$}}),I(($,j)=>{E(k,$),E(S,j)},[()=>A("workspace:hud.sync_label"),()=>A("workspace:hud.sync_desc")]),p(h,g)};M(c,h=>{a(n)&&h(f)})}var x=o(c,2);{var _=h=>{var g=Ur(),w=o(se(g),2),y=i(w),m=i(y,!0);r(y);var k=o(y,2),b=i(k,!0);r(k),r(w),I((S,C)=>{E(m,S),E(b,C)},[()=>A("workspace:hud.master_pace_label"),()=>A("workspace:hud.master_pace_desc")]),p(h,g)};M(x,h=>{a(l)&&h(_)})}r(d),pe(3,d,()=>he,()=>({duration:100})),p(u,d),re()}var Vr=L("<div></div>"),Yr=L('<button type="button" role="tab"><!> <!></button>'),Kr=L('<div role="tablist"></div>');function ya(u,e){ae(e,!0);let t=ie(e,"tabs",19,()=>[]),n=ie(e,"activeTab",15),l=ie(e,"class",3,""),d=ie(e,"variant",3,"horizontal");function v(f){f.disabled||(n(f.id),e.onchange&&e.onchange(f.id))}var c=Kr();_e(c,21,t,ke,(f,x)=>{var _=Yr();_.__click=()=>v(a(x));var h=i(_);{var g=k=>{var b=me(),S=se(b);je(S,()=>a(x).icon),p(k,b)};M(h,k=>{a(x).icon&&k(g)})}var w=o(h),y=o(w);{var m=k=>{var b=Vr();I(()=>ne(b,1,`
                        absolute bg-ui-accent
                        ${d()==="horizontal"?"bottom-0 left-0 h-1 w-full":"top-0 right-0 h-full w-1"}
                    `)),p(k,b)};M(y,k=>{n()===a(x).id&&k(m)})}r(_),I(k=>{D(_,"aria-selected",n()===a(x).id),D(_,"aria-disabled",a(x).disabled),_.disabled=a(x).disabled,ne(_,1,`
                relative flex flex-1 items-center justify-center gap-3 px-6 py-3
                text-[10px] font-bold tracking-widest uppercase transition-all
                				${n()===a(x).id?"border-ui-structural bg-canvas-bg text-text-main":a(x).disabled?"text-text-main/20":"text-text-main/40 hover:bg-text-main/5 hover:text-text-main/70"}                ${d()==="horizontal"?"-mb-0.5 border-x-2 border-t-2 first:border-l-0 last:border-r-0":"-mr-0.5 border-y-2 border-l-2 first:border-t-0 last:border-b-0"}
				${a(x).disabled?"cursor-not-allowed opacity-30 grayscale":""}
            `),E(w,` ${k??""} `)},[()=>A(a(x).label)]),p(f,_)}),r(c),I(f=>{D(c,"aria-label",f),ne(c,1,`
    flex ${d()==="horizontal"?"flex-row border-b-2":"flex-col border-r-2"}
    w-full border-ui-structural bg-sidebar-bg/10 ${l()??""}
`)},[()=>A(e.ariaLabel)]),p(u,c),re()}Ae(["click"]);var Qr=L('<input type="text" class="w-full bg-ui-accent/5 font-serif text-sm font-medium text-ui-accent ring-1 ring-ui-accent/30 outline-none"/>'),qr=L('<button class="shrink-0 text-[10px] opacity-0 transition-opacity group-hover:opacity-40 hover:text-ui-accent">üóëÔ∏è</button>'),Wr=L('<div role="button" tabindex="0" draggable="true"><div class="flex min-w-0 flex-1 items-center gap-2 overflow-hidden"><span class="w-4 shrink-0 text-center font-mono text-[9px] font-bold opacity-20" aria-hidden="true"> </span> <button> </button> <button><!></button></div> <div class="flex shrink-0 items-center gap-1.5 pl-2"><button class="shrink-0 text-[10px] opacity-0 transition-opacity group-hover:opacity-40 hover:text-ui-accent"> </button> <button class="shrink-0 text-[10px] opacity-0 transition-opacity group-hover:opacity-40 hover:text-ui-accent">üìã</button> <!></div></div>');function Xr(u,e){ae(e,!0);let t=ie(e,"tempName",15);function n(P){P.focus(),P.select()}var l=Wr();l.__click=P=>P.stopPropagation(),l.__keydown=P=>{(P.key==="Enter"||P.key===" ")&&e.onSelect(e.index,P)},l.__contextmenu=function(...P){e.oncontextmenu?.apply(this,P)};var d=i(l),v=i(d),c=i(v,!0);r(v);var f=o(v,2);f.__click=P=>{P.stopPropagation(),Q.project.toggleFrameVisibility(e.index)};var x=i(f,!0);r(f);var _=o(f,2);_.__click=P=>e.onSelect(e.index,P),_.__dblclick=()=>e.onStartRename(e.index,e.frame.name);var h=i(_);{var g=P=>{var T=Qr();Rt(T),T.__keydown=$=>{$.stopPropagation(),$.key==="Enter"&&e.onCommitRename(),$.key==="Escape"&&e.onCancelRename()},Ut(()=>Ht(T,t)),ha(T,$=>n?.($)),$e("blur",T,function(...$){e.onCommitRename?.apply(this,$)}),p(P,T)},w=P=>{var T=ce();I(()=>E(T,e.frame.name)),p(P,T)};M(h,P=>{e.isEditing?P(g):P(w,!1)})}r(_),r(d);var y=o(d,2),m=i(y);m.__click=P=>e.onToggleProperties(e.index,P);var k=i(m,!0);r(m);var b=o(m,2);b.__click=P=>{P.stopPropagation(),Q.project.duplicateFrame(e.index)};var S=o(b,2);{var C=P=>{var T=qr();T.__click=$=>{$.stopPropagation(),Q.project.removeFrame(e.index)},I($=>D(T,"title",$),[()=>A("workspace:hud.actions.delete")]),p(P,T)};M(S,P=>{s.project.frames.length>1&&P(C)})}r(y),r(l),I((P,T,$)=>{ne(l,1,`group flex cursor-grab items-center justify-between rounded px-2 transition-all ${e.isSelected?"bg-ui-accent/10 text-ui-accent ring-1 ring-ui-accent/20":"hover:bg-text-main/5"} ${e.isActive?"bg-ui-accent/5 font-bold":""} ${e.isDropTarget?"shadow-[0_-2px_0_var(--color-ui-accent)]":""} ${e.isDragged?"opacity-40":""}`),D(l,"aria-current",e.isActive?"true":void 0),E(c,e.index+1),ne(f,1,`shrink-0 text-xs transition-opacity ${e.frame.isVisible?"opacity-100":"opacity-20"}`),D(f,"title",P),E(x,e.frame.isVisible?"üëÅÔ∏è":"üï∂Ô∏è"),ne(_,1,`min-w-0 flex-1 truncate py-2 text-left font-serif text-sm font-medium text-text-main ${e.frame.isVisible?"":"opacity-40"}`),D(m,"title",T),E(k,e.activePropertiesType==="frame"&&e.activePropertiesIndex===e.index?"üîº":"‚öôÔ∏è"),D(b,"title",$)},[()=>e.frame.isVisible?A("workspace:hud.project_panel.active"):A("workspace:hud.project_panel.visibility"),()=>A("workspace:hud.project_panel.properties"),()=>A("workspace:hud.actions.duplicate")]),$e("dragstart",l,()=>e.onDragStart(e.index)),$e("dragover",l,P=>e.onDragOver(P,e.index)),$e("drop",l,P=>e.onDrop(P,e.index)),$e("dragend",l,function(...P){e.onDragEnd?.apply(this,P)}),p(u,l),re()}Ae(["click","keydown","contextmenu","dblclick"]);var Zr=L('<button class="w-4 shrink-0 text-center text-[10px] opacity-40 hover:opacity-100"> </button>'),Jr=L('<div class="w-4 shrink-0"></div>'),ei=L('<input type="text" class="w-full bg-ui-accent/5 font-serif text-sm font-medium text-ui-accent ring-1 ring-ui-accent/30 outline-none"/>'),ti=L('<div role="button" tabindex="0" draggable="true"><div class="flex min-w-0 flex-1 items-center gap-2 overflow-hidden"><!> <button> </button> <button><!></button></div> <div class="flex shrink-0 items-center gap-1.5 pl-2"><button class="shrink-0 text-[10px] opacity-0 transition-opacity group-hover:opacity-40 hover:text-ui-accent"> </button> <button> </button> <button class="shrink-0 text-[10px] opacity-0 transition-opacity group-hover:opacity-40 hover:text-ui-accent">üóëÔ∏è</button></div></div>');function ai(u,e){ae(e,!0);let t=ie(e,"layer",7),n=ie(e,"tempName",15),l=B(()=>t().parentId!==null);function d(j){j.focus(),j.select()}var v=ti();v.__click=j=>j.stopPropagation(),v.__keydown=j=>{(j.key==="Enter"||j.key===" ")&&e.onSelect(e.index,j)},v.__contextmenu=function(...j){e.oncontextmenu?.apply(this,j)};var c=i(v),f=i(c);{var x=j=>{var R=Zr();R.__click=ee=>{ee.stopPropagation(),t().isCollapsed=!t().isCollapsed};var F=i(R,!0);r(R),I(()=>E(F,t().isCollapsed?"‚ñ∂":"‚ñº")),p(j,R)},_=j=>{var R=Jr();p(j,R)};M(f,j=>{t().type==="FOLDER"?j(x):j(_,!1)})}var h=o(f,2);h.__click=j=>{j.stopPropagation(),Q.project.toggleVisibility(e.index)};var g=i(h,!0);r(h);var w=o(h,2);w.__click=j=>e.onSelect(e.index,j),w.__dblclick=()=>e.onStartRename(e.index,t().name);var y=i(w);{var m=j=>{var R=ei();Rt(R),R.__keydown=F=>{F.stopPropagation(),F.key==="Enter"&&e.onCommitRename(),F.key==="Escape"&&e.onCancelRename()},Ut(()=>Ht(R,n)),ha(R,F=>d?.(F)),$e("blur",R,function(...F){e.onCommitRename?.apply(this,F)}),p(j,R)},k=j=>{var R=ce();I(()=>E(R,t().name)),p(j,R)};M(y,j=>{e.isEditing?j(m):j(k,!1)})}r(w),r(c);var b=o(c,2),S=i(b);S.__click=j=>e.onToggleProperties(e.index,j);var C=i(S,!0);r(S);var P=o(S,2);P.__click=j=>{j.stopPropagation(),Q.project.toggleLock(e.index)};var T=i(P,!0);r(P);var $=o(P,2);$.__click=j=>{j.stopPropagation(),Q.project.removeLayer(e.index)},r(b),r(v),I((j,R,F,ee)=>{ne(v,1,`group flex cursor-grab items-center justify-between rounded px-2 transition-all ${e.isSelected?"bg-ui-accent/10 text-ui-accent ring-1 ring-ui-accent/20":"hover:bg-text-main/5"} ${e.isActive?"bg-ui-accent/5 font-bold":""} ${e.isDropTarget?"shadow-[0_-2px_0_var(--color-ui-accent)]":""} ${e.isDragged?"opacity-40":""}`),ue(v,a(l)?"margin-left: 12px;":""),D(v,"aria-current",e.isActive?"true":void 0),ne(h,1,`shrink-0 text-xs transition-opacity ${t().isVisible?"opacity-100":"opacity-20"}`),D(h,"title",j),E(g,t().isVisible?t().type==="FOLDER"?"üìÇ":"üëÅÔ∏è":t().type==="FOLDER"?"üìÅ":"üï∂Ô∏è"),ne(w,1,`min-w-0 flex-1 truncate py-2 text-left font-serif text-sm font-medium text-text-main ${t().isVisible?"":"opacity-40"}`),D(S,"title",R),E(C,e.activePropertiesType==="layer"&&e.activePropertiesIndex===e.index?"üîº":"‚öôÔ∏è"),ne(P,1,`shrink-0 text-[10px] transition-opacity ${t().isLocked?"opacity-100":"opacity-20"}`),D(P,"title",F),E(T,t().isLocked?"üîí":"üîì"),D($,"title",ee)},[()=>A("workspace:hud.project_panel.visibility"),()=>A("workspace:hud.project_panel.properties"),()=>A("workspace:hud.project_panel.lock"),()=>A("workspace:hud.actions.delete")]),$e("dragstart",v,()=>e.onDragStart(e.index)),$e("dragover",v,j=>e.onDragOver(j,e.index)),$e("drop",v,j=>e.onDrop(j,e.index)),$e("dragend",v,function(...j){e.onDragEnd?.apply(this,j)}),p(u,v),re()}Ae(["click","keydown","contextmenu","dblclick"]);var ri=L("<!> <!>",1),ii=L('<div class="flex flex-col gap-1" role="list"></div>'),si=L("<!> <!>",1),oi=L('<div class="flex flex-col gap-1" role="list"></div>'),ni=L('<span aria-hidden="true">Ôºã</span> ',1),li=L('<span aria-hidden="true">üìÅ</span> ',1),ci=L('<div class="flex h-full w-full flex-col overflow-hidden bg-transparent" role="region" aria-label="Project Explorer"><!> <div class="custom-scrollbar flex-1 overflow-y-auto p-2" role="presentation"><!></div> <div class="flex items-center justify-between border-t border-text-main/5 bg-text-main/5 px-4 py-2"><div class="flex items-center gap-3"><!> <!></div> <span class="font-mono text-[8px] font-bold text-text-main/20 uppercase"> </span></div></div>');function di(u,e){ae(e,!0);let t=ve(null),n=ve(null),l=ve(null),d=ve(""),v=ve(null),c=ve(null);function f(z,X,O){O.stopPropagation(),rt.playPaperFlip(),a(v)===z&&a(c)===X?(U(v,null),U(c,null)):(U(v,z,!0),U(c,X,!0))}function x(z,X){U(l,z,!0),U(d,X,!0)}function _(){a(l)!==null&&(s.studio.projectActiveTab==="layers"?s.project.activeFrame.layers[a(l)].name=a(d):s.project.frames[a(l)].name=a(d),U(l,null))}function h(z){U(t,z,!0)}function g(z,X){z.preventDefault(),U(n,X,!0)}function w(z,X){z.preventDefault(),a(t)!==null&&(s.studio.projectActiveTab==="layers"?Q.project.reorderLayer(a(t),X):Q.project.reorderFrame(a(t),X)),U(t,null),U(n,null)}function y(){U(t,null),U(n,null)}function m(){const z=s.project;z.selectedFrameIndices=new Set([z.activeFrameIndex]);const X=z.activeFrame;X.selectedLayerIndices=new Set([X.activeLayerIndex])}function k(z,X){const O=s.project;if(X.ctrlKey||X.metaKey)O.selectedFrameIndices.has(z)&&O.selectedFrameIndices.size>1?O.selectedFrameIndices.delete(z):O.selectedFrameIndices.add(z);else if(X.shiftKey){const J=Math.min(O.activeFrameIndex,z),V=Math.max(O.activeFrameIndex,z),te=new Set;for(let q=J;q<=V;q++)te.add(q);O.selectedFrameIndices=te}else O.selectedFrameIndices=new Set([z]);O.activeFrameIndex=z}function b(z,X){const O=s.project.activeFrame;if(X.ctrlKey||X.metaKey)O.selectedLayerIndices.has(z)&&O.selectedLayerIndices.size>1?O.selectedLayerIndices.delete(z):O.selectedLayerIndices.add(z);else if(X.shiftKey){const J=Math.min(O.activeLayerIndex,z),V=Math.max(O.activeLayerIndex,z),te=new Set;for(let q=J;q<=V;q++)te.add(q);O.selectedLayerIndices=te}else O.selectedLayerIndices=new Set([z]);O.activeLayerIndex=z}function S(z,X){z.preventDefault();const O=s.project;O.selectedFrameIndices.has(X)||(O.selectedFrameIndices=new Set([X]),O.activeFrameIndex=X);const J=O.selectedFrameIndices.size>1;s.studio.contextMenu={x:z.clientX,y:z.clientY,items:[{label:J?A("workspace:hud.context_menu.duplicate_frames",{replace:{count:O.selectedFrameIndices.size}}):A("workspace:hud.actions.duplicate"),icon:"üìã",action:()=>{Q.project.duplicateFrame(X)}},...J?[{label:A("actions:merge_frames"),icon:"üçµ",action:()=>Q.project.mergeFrames()}]:[],{label:A("workspace:hud.context_menu.add_flavor_tag"),icon:"üè∑Ô∏è",action:()=>{const V=prompt("Tag Name:","New Sequence");if(V){const te=Array.from(O.selectedFrameIndices).sort((q,le)=>q-le);Q.project.addTag(V,te[0],te[te.length-1])}}},{label:J?A("workspace:hud.context_menu.delete_frames",{replace:{count:O.selectedFrameIndices.size}}):A("actions:delete_frame"),icon:"üóëÔ∏è",danger:!0,disabled:O.frames.length<=O.selectedFrameIndices.size,action:()=>{Array.from(O.selectedFrameIndices).sort((te,q)=>te-q).reverse().forEach(te=>Q.project.removeFrame(te)),O.selectedFrameIndices=new Set([O.activeFrameIndex])}}]}}function C(z,X){const O=s.project.activeFrame;z.preventDefault(),O.selectedLayerIndices.has(X)||(O.selectedLayerIndices=new Set([X]),O.activeLayerIndex=X);const J=O.selectedLayerIndices.size>1,V=O.layers[X];s.studio.contextMenu={x:z.clientX,y:z.clientY,items:[{label:J?A("workspace:hud.context_menu.group_selected"):A("workspace:hud.context_menu.group"),icon:"üìÅ",action:()=>{const te=Q.project.addGroup();J?Array.from(O.selectedLayerIndices).forEach(le=>{const Le=O.layers[le];Le!==te&&(Le.parentId=te.id)}):V.parentId=te.id}},{label:J?A("workspace:hud.context_menu.duplicate_layers",{replace:{count:O.selectedLayerIndices.size}}):A("workspace:hud.actions.duplicate"),icon:"üìã",disabled:J,action:()=>Q.project.duplicateLayer(X)},{label:J?A("actions:merge_selected_layers"):A("actions:merge_layers"),icon:"üé®",disabled:!J&&X===0,action:()=>{J?Q.project.mergeSelectedLayers():Q.project.mergeLayerDown()}},{label:J?A("workspace:hud.context_menu.show_infusion"):V.isVisible?A("workspace:hud.context_menu.hide_infusion"):A("workspace:hud.context_menu.show_infusion"),icon:V.isVisible?"üï∂Ô∏è":"üëÅÔ∏è",action:()=>{const te=Array.from(O.selectedLayerIndices),q=!V.isVisible;te.forEach(le=>O.layers[le].isVisible=q),s.canvas.incrementVersion()}},{label:J?A("workspace:hud.context_menu.lock_infusion"):V.isLocked?A("workspace:hud.context_menu.unlock_infusion"):A("workspace:hud.context_menu.lock_infusion"),icon:V.isLocked?"üîì":"üîí",action:()=>{Array.from(O.selectedLayerIndices).forEach(q=>Q.project.toggleLock(q))}},{label:A("actions:delete_layer"),icon:"üóëÔ∏è",danger:!0,disabled:O.layers.length<=O.selectedLayerIndices.size,action:()=>{Array.from(O.selectedLayerIndices).sort((q,le)=>le-q).forEach(q=>Q.project.removeLayer(q)),O.selectedLayerIndices=new Set([O.activeLayerIndex])}}]}}const P=[{id:"frames",label:"workspace:hud.project_panel.frames"},{id:"layers",label:"workspace:hud.project_panel.layers"}];var T=ci(),$=i(T);ya($,{get tabs(){return P},ariaLabel:"ui:labels.project_tabs",onchange:()=>{rt.playPaperFlip()},get activeTab(){return s.studio.projectActiveTab},set activeTab(z){s.studio.projectActiveTab=z}});var j=o($,2);j.__click=m,j.__keydown=z=>{z.key==="Escape"&&m()};var R=i(j);{var F=z=>{var X=ii();_e(X,21,()=>s.project.frames,ke,(O,J,V)=>{var te=ri(),q=se(te);{let Ee=B(()=>s.project.selectedFrameIndices.has(V)),W=B(()=>V===s.project.activeFrameIndex),be=B(()=>a(l)===V),Re=B(()=>a(n)===V&&a(t)!==V),Oe=B(()=>a(t)===V);Xr(q,{get frame(){return a(J)},index:V,get isSelected(){return a(Ee)},get isActive(){return a(W)},get isEditing(){return a(be)},get isDropTarget(){return a(Re)},get isDragged(){return a(Oe)},get activePropertiesType(){return a(v)},get activePropertiesIndex(){return a(c)},onSelect:k,onToggleProperties:(Te,Qe)=>f("frame",Te,Qe),onStartRename:x,onCommitRename:_,onCancelRename:()=>U(l,null),onDragStart:h,onDragOver:g,onDrop:w,onDragEnd:y,oncontextmenu:Te=>S(Te,V),get tempName(){return a(d)},set tempName(Te){U(d,Te,!0)}})}var le=o(q,2);{var Le=Ee=>{la(Ee,{get target(){return a(J)}})};M(le,Ee=>{a(v)==="frame"&&a(c)===V&&Ee(Le)})}p(O,te)}),r(X),pe(3,X,()=>he,()=>({duration:150})),p(z,X)},ee=z=>{var X=oi();_e(X,21,()=>s.project.activeFrame.layers,ke,(O,J,V)=>{const te=B(()=>a(J).parentId?s.project.activeFrame.layers.find(Ee=>Ee.id===a(J).parentId):null);var q=me(),le=se(q);{var Le=Ee=>{var W=si(),be=se(W);{let Te=B(()=>s.project.activeFrame.selectedLayerIndices.has(V)),Qe=B(()=>V===s.project.activeFrame.activeLayerIndex),He=B(()=>a(l)===V),Ve=B(()=>a(n)===V&&a(t)!==V),it=B(()=>a(t)===V);ai(be,{get layer(){return a(J)},index:V,get isSelected(){return a(Te)},get isActive(){return a(Qe)},get isEditing(){return a(He)},get isDropTarget(){return a(Ve)},get isDragged(){return a(it)},get activePropertiesType(){return a(v)},get activePropertiesIndex(){return a(c)},onSelect:b,onToggleProperties:(qe,vt)=>f("layer",qe,vt),onStartRename:x,onCommitRename:_,onCancelRename:()=>U(l,null),onDragStart:h,onDragOver:g,onDrop:w,onDragEnd:y,oncontextmenu:qe=>C(qe,V),get tempName(){return a(d)},set tempName(qe){U(d,qe,!0)}})}var Re=o(be,2);{var Oe=Te=>{la(Te,{get target(){return a(J)}})};M(Re,Te=>{a(v)==="layer"&&a(c)===V&&Te(Oe)})}p(Ee,W)};M(le,Ee=>{(!a(te)||!a(te).isCollapsed)&&Ee(Le)})}p(O,q)}),r(X),pe(3,X,()=>he,()=>({duration:150})),p(z,X)};M(R,z=>{s.studio.projectActiveTab==="frames"?z(F):z(ee,!1)})}r(j);var Z=o(j,2),N=i(Z),Y=i(N);{let z=B(()=>s.studio.projectActiveTab==="frames"?"actions:new_frame":"actions:new_layer");fe(Y,{variant:"ghost",size:"sm",onclick:()=>{s.studio.projectActiveTab==="frames"?Q.project.addFrame():Q.project.addLayer()},get ariaLabel(){return a(z)},class:"!p-0 text-[9px] font-bold tracking-[0.1em] text-text-main/40 uppercase hover:text-text-main/80",children:(X,O)=>{var J=ni(),V=o(se(J));I(te=>E(V,` ${te??""}`),[()=>s.studio.projectActiveTab==="frames"?A("actions:new_frame"):A("actions:new_layer")]),p(X,J)},$$slots:{default:!0}})}var H=o(Y,2);{var K=z=>{fe(z,{variant:"ghost",size:"sm",onclick:()=>Q.project.addGroup(),ariaLabel:"actions:new_layer_group",class:"!p-0 text-[9px] font-bold tracking-[0.1em] text-text-main/40 uppercase hover:text-text-main/80",children:(X,O)=>{var J=li(),V=o(se(J));I(te=>E(V,` ${te??""}`),[()=>A("actions:new_layer_group")]),p(X,J)},$$slots:{default:!0}})};M(H,z=>{s.studio.projectActiveTab==="layers"&&z(K)})}r(N);var oe=o(N,2),G=i(oe,!0);r(oe),r(Z),r(T),I(()=>E(G,s.studio.projectActiveTab==="frames"?s.project.frames.length:s.project.activeFrame.layers.length)),p(u,T),re()}Ae(["click","keydown"]);var vi=L('<div class="minimap-container border-b border-text-main/10 bg-text-main/5 p-3 transition-all duration-300 svelte-1kivg02"><div class="relative flex items-center justify-center overflow-hidden rounded border border-text-main/5 bg-sidebar-bg/20 p-2 shadow-inner"><canvas class="h-auto w-full max-w-[180px] shadow-sm" style="image-rendering: pixelated;"></canvas> <div class="pointer-events-none absolute inset-0 ring-1 ring-ui-accent ring-inset" style="opacity: 0.4;"></div></div></div>');function ui(u,e){ae(e,!0);let t=ve(null);Ue(()=>{s.canvas.version;const v=a(t)?.getContext("2d");if(!v||!a(t))return;const{width:c,height:f}=s.canvas,x=s.canvas.compositePixels,_=v.createImageData(c,f);new Uint32Array(_.data.buffer).set(x),v.putImageData(_,0,0)});var n=vi(),l=i(n),d=i(l);gt(d,v=>U(t,v),()=>a(t)),xe(2),r(l),r(n),I(()=>{D(d,"width",s.canvas.width),D(d,"height",s.canvas.height)}),p(u,n),re()}var pi=L('<span class="text-sm"> </span>'),fi=L('<div class="absolute top-0 -right-12 z-50 flex flex-col items-center gap-1 rounded-md bg-canvas-bg p-1 shadow-md ring-1 ring-text-main/10"><button class="flex h-4 w-4 items-center justify-center text-[10px] hover:text-ui-accent">+</button> <span class="font-tiny5 text-[8px] text-ui-accent"> </span> <button class="flex h-4 w-4 items-center justify-center text-[10px] hover:text-ui-accent">-</button> <div class="my-1 h-px w-2 bg-text-main/10"></div> <div class="flex flex-col items-center gap-0.5"><button class="text-[8px] hover:text-ui-accent">‚ñ¥</button> <span class="text-[7px] font-bold text-ui-accent/60"> </span> <button class="text-[8px] hover:text-ui-accent">‚ñæ</button></div></div>'),xi=L('<div class="relative"><!> <!></div>'),gi=L('<div class="flex flex-col gap-1.5"></div>'),mi=L('<span class="text-sm"> </span>'),hi=L('<span class="text-sm"> </span>'),_i=L('<div class="absolute -top-1 -right-1 text-[8px]">üîí</div>'),bi=L('<span class="text-[10px]"> </span> <!>',1),Ai=L('<div class="flex flex-col gap-1.5"></div> <div class="h-px w-4 bg-text-main/10"></div> <div class="flex flex-col gap-1.5"></div> <div class="h-px w-4 bg-text-main/10"></div> <div class="flex flex-col gap-1.5"></div>',1),yi=L('<div class="toolbar custom-scrollbar flex h-full flex-col items-center gap-4 overflow-y-auto py-4 svelte-g5agka"><!></div>');function wa(u,e){ae(e,!0);const t=s.studio;let n=ie(e,"side",3,"left");function l(w){rt.playCeramicSlide(),Ze.handleIntent(w)}const d=[{id:"BRUSH",icon:"üñåÔ∏è",intent:"TOOL_BRUSH",label:"tool_brush"},{id:"ERASER",icon:"üßπ",intent:"TOOL_ERASER",label:"tool_eraser"},{id:"RECT_SELECT",icon:"‚ú®",intent:"TOOL_RECT_SELECT",label:"tool_rect_select"},{id:"LASSO_SELECT",icon:"‚û∞",intent:"TOOL_LASSO_SELECT",label:"tool_lasso_select"},{id:"POLY_SELECT",icon:"üìê",intent:"TOOL_POLY_SELECT",label:"tool_poly_select"},{id:"RECTANGLE",icon:"üì¶",intent:"TOOL_RECTANGLE",label:"tool_rectangle"},{id:"ELLIPSE",icon:"‚≠ï",intent:"TOOL_ELLIPSE",label:"tool_ellipse"},{id:"POLYGON",icon:"‚≠ê",intent:"TOOL_POLYGON",label:"tool_polygon"},{id:"HAND",icon:"ü§ö",intent:"TOGGLE_HAND_TOOL",label:"toggle_hand_tool"}],v=[{id:"lighten",icon:"‚òÄÔ∏è",intent:"SHADE_LIGHTEN",active:()=>t.isShadingLighten,label:"shade_lighten"},{id:"darken",icon:"üåô",intent:"SHADE_DARKEN",active:()=>t.isShadingDarken,label:"shade_darken"},{id:"dither",icon:"üèÅ",intent:"SHADE_DITHER",active:()=>t.isShadingDither,label:"shade_dither"}],c=[{id:"symmetry",icon:"ü™û",intent:"CYCLE_SYMMETRY",active:()=>t.symmetryMode!=="OFF",label:"cycle_symmetry"},{id:"tiling",icon:"‚àû",intent:"TOGGLE_TILING",active:()=>t.isTilingEnabled,label:"toggle_tiling"},{id:"perfect",icon:"‚ú®",intent:"TOGGLE_PIXEL_PERFECT",active:()=>t.isPixelPerfect,label:"toggle_pixel_perfect"},{id:"stencil",icon:"üé®",intent:"TOGGLE_PATTERN_BRUSH",active:()=>t.isPatternBrushActive,label:"toggle_pattern_brush",disabled:()=>!s.project.clipboard}],f=[{id:"alpha",icon:"A",intent:"TOGGLE_ALPHA_LOCK",active:()=>t.isAlphaLocked,label:"toggle_alpha_lock"},{id:"color",icon:"C",intent:"TOGGLE_COLOR_LOCK",active:()=>t.isColorLocked,label:"toggle_color_lock"}];var x=yi(),_=i(x);{var h=w=>{var y=gi();_e(y,21,()=>d,ke,(m,k)=>{var b=xi(),S=i(b);{let T=B(()=>t.activeTool===a(k).id),$=B(()=>`actions:${a(k).label}`);fe(S,{variant:"tool",get isActive(){return a(T)},get ariaLabel(){return a($)},onclick:()=>l(a(k).intent),class:"h-8 w-8 !p-0",children:(j,R)=>{var F=pi(),ee=i(F,!0);r(F),I(()=>E(ee,a(k).icon)),p(j,F)},$$slots:{default:!0}})}var C=o(S,2);{var P=T=>{var $=fi(),j=i($);j.__click=()=>Ze.handleIntent("POLY_SIDES_INC");var R=o(j,2),F=i(R,!0);r(R);var ee=o(R,2);ee.__click=()=>Ze.handleIntent("POLY_SIDES_DEC");var Z=o(ee,4),N=i(Z);N.__click=()=>Ze.handleIntent("POLY_INDENT_INC");var Y=o(N,2),H=i(Y);r(Y);var K=o(Y,2);K.__click=()=>Ze.handleIntent("POLY_INDENT_DEC"),r(Z),r($),I(()=>{E(F,t.polygonSides),E(H,`${t.polygonIndentation??""}%`)}),pe(3,$,()=>he),p(T,$)};M(C,T=>{a(k).id==="POLYGON"&&t.activeTool==="POLYGON"&&T(P)})}r(b),p(m,b)}),r(y),p(w,y)},g=w=>{var y=Ai(),m=se(y);_e(m,21,()=>v,ke,(S,C)=>{{let P=B(()=>a(C).active()),T=B(()=>`actions:${a(C).label}`);fe(S,{variant:"tool",get isActive(){return a(P)},get ariaLabel(){return a(T)},onclick:()=>Ze.handleIntent(a(C).intent),class:"h-8 w-8 !p-0",children:($,j)=>{var R=mi(),F=i(R,!0);r(R),I(()=>E(F,a(C).icon)),p($,R)},$$slots:{default:!0}})}}),r(m);var k=o(m,4);_e(k,21,()=>c,ke,(S,C)=>{{let P=B(()=>a(C).active()),T=B(()=>a(C).disabled?.()),$=B(()=>`actions:${a(C).label}`);fe(S,{variant:"tool",get isActive(){return a(P)},get disabled(){return a(T)},get ariaLabel(){return a($)},onclick:()=>!a(C).disabled?.()&&Ze.handleIntent(a(C).intent),class:"h-8 w-8 !p-0",children:(j,R)=>{var F=hi(),ee=i(F,!0);r(F),I(()=>E(ee,a(C).icon)),p(j,F)},$$slots:{default:!0}})}}),r(k);var b=o(k,4);_e(b,21,()=>f,ke,(S,C)=>{{let P=B(()=>a(C).active()),T=B(()=>`actions:${a(C).label}`);fe(S,{variant:"tool",get isActive(){return a(P)},get ariaLabel(){return a(T)},onclick:()=>Ze.handleIntent(a(C).intent),class:"h-8 w-8 !p-0 font-bold",children:($,j)=>{var R=bi(),F=se(R),ee=i(F,!0);r(F);var Z=o(F,2);{var N=Y=>{var H=_i();pe(3,H,()=>kt),p(Y,H)};M(Z,Y=>{a(C).active()&&Y(N)})}I(()=>E(ee,a(C).icon)),p($,R)},$$slots:{default:!0}})}}),r(b),p(w,y)};M(_,w=>{n()==="left"?w(h):w(g,!1)})}r(x),p(u,x),re()}Ae(["click"]);var wi=L('<label class="px-1 text-[10px] font-bold tracking-widest text-text-main/70 uppercase"> </label>'),ki=L(`<div><!> <input class="
            rounded-sm border-2 border-ui-structural bg-canvas-bg px-2 py-1
            text-[10px] text-text-main placeholder-text-main/30
            shadow-[2px_2px_0px_var(--color-ui-structural)]
            transition-all focus:ring-2 focus:ring-ui-accent focus:ring-offset-1
            focus:outline-none disabled:cursor-not-allowed disabled:opacity-50
        "/></div>`);function Be(u,e){ae(e,!0);let t=ie(e,"value",15),n=ie(e,"placeholder",3,""),l=ie(e,"type",3,"text"),d=ie(e,"disabled",3,!1),v=ie(e,"readonly",3,!1),c=ie(e,"class",3,"");var f=ki(),x=i(f);{var _=g=>{var w=wi(),y=i(w,!0);r(w),I(m=>{D(w,"for",e.id||e.label),E(y,m)},[()=>A(e.label)]),p(g,w)};M(x,g=>{e.label&&g(_)})}var h=o(x,2);Rt(h),h.__change=function(...g){e.onchange?.apply(this,g)},h.__input=function(...g){e.oninput?.apply(this,g)},h.__keydown=function(...g){e.onkeydown?.apply(this,g)},r(f),I((g,w)=>{ne(f,1,`flex flex-col gap-1.5 ${c()??""}`),D(h,"id",e.id),D(h,"type",l()),h.disabled=d(),h.readOnly=v(),D(h,"min",e.min),D(h,"max",e.max),D(h,"step",e.step),D(h,"placeholder",g),D(h,"aria-label",w)},[()=>A(n()),()=>A(e.ariaLabel)]),$e("blur",h,function(...g){e.onblur?.apply(this,g)}),Ht(h,t),p(u,f),re()}Ae(["change","input","keydown"]);var mt=wt(()=>s),Ei=L('<!> <div class="flex items-center gap-3 border-b border-text-main/10 bg-text-main/5 px-4 py-3" role="group" aria-label="Canvas Zoom"><span class="font-serif text-[8px] font-bold text-text-main/40 uppercase"> </span> <div class="flex flex-1 items-center gap-2"><!> <!></div></div>',1),Li=L('<aside class="side-panel-left flex h-full w-full bg-canvas-bg/50"><div class="flex flex-1 flex-col overflow-hidden"><!> <div class="custom-scrollbar flex-1 overflow-y-auto border-r border-text-main/5"><!></div></div> <div class="flex h-full flex-col bg-ui-structural/[0.05] px-2 shadow-sm"><!></div></aside>');function Si(u,e){ae(e,!1),Ce();var t=Li(),n=i(t),l=i(n);{var d=_=>{var h=Ei(),g=se(h);ui(g,{});var w=o(g,2),y=i(w),m=i(y,!0);r(y);var k=o(y,2),b=i(k);ot(b,{min:.1,max:10,step:.1,ariaLabel:"workspace:stats.zoom_level",class:"flex-1",get value(){return mt().studio.zoomLevel},set value(C){mt(mt().studio.zoomLevel=C)},$$legacy:!0});var S=o(b,2);Be(S,{type:"number",min:.1,max:10,step:.1,ariaLabel:"workspace:stats.zoom_level",class:"!h-6 w-12 !border-none !bg-transparent !p-0 !text-center !text-[10px] !shadow-none",get value(){return mt().studio.zoomLevel},set value(C){mt(mt().studio.zoomLevel=C)},$$legacy:!0}),r(k),r(w),I(C=>E(m,C),[()=>A("workspace:stats.zoom_label")]),p(_,h)};M(l,_=>{mt().studio.showMinimap&&_(d)})}var v=o(l,2),c=i(v);di(c,{}),r(v),r(n);var f=o(n,2),x=i(f);wa(x,{side:"left"}),r(f),r(t),p(u,t),re()}var Ci=L('<button class="group editor-checker-small relative h-5 w-5 shrink-0 rounded border border-text-main/10 shadow-sm transition-all hover:scale-110 active:scale-95"><div class="absolute inset-0 flex items-center justify-center opacity-0 transition-opacity group-hover:opacity-100"><span class="text-[8px]">üìç</span></div></button>'),Ti=L('<div class="flex h-5 w-5 items-center justify-center rounded border border-dashed border-text-main/10"><span class="text-[8px] opacity-20">üé®</span></div>'),Ii=L('<div class="custom-scrollbar flex max-h-[120px] flex-row flex-wrap gap-1.5 overflow-y-auto px-1"></div>');function Pi(u,e){ae(e,!0);var t=Ii();_e(t,20,()=>e.colors,n=>n,(n,l)=>{var d=Ci();d.__click=()=>Q.color.setColor(l),I(()=>{ue(d,`background-color: ${l??""};`),D(d,"title",l)}),pe(3,d,()=>Aa,()=>({duration:200})),p(n,d)},n=>{var l=Ti();p(n,l)}),r(t),p(u,t),re()}Ae(["click"]);var ji=L('<div class="editor-panel flex w-full flex-col gap-4 border-none bg-canvas-bg p-3 shadow-sm"><div class="flex flex-col items-center gap-2 py-2"><span class="font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </span> <div class="editor-checker-small h-10 w-10 rounded border border-text-main/10 shadow-inner transition-colors"></div> <div class="flex items-center gap-2"><span class="font-mono text-[9px] font-bold tracking-tight text-text-main/40 uppercase"> </span> <button class="flex h-4 w-4 items-center justify-center rounded bg-ui-accent/10 text-[8px] text-ui-accent transition-all hover:bg-ui-accent hover:text-canvas-bg">Ôºã</button></div></div> <div class="h-px w-full bg-text-main/5"></div> <div class="flex flex-col gap-2"><span class="text-center font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </span> <!></div></div>');function $i(u,e){ae(e,!1),Ce();var t=ji(),n=i(t),l=i(n),d=i(l,!0);r(l);var v=o(l,2),c=o(v,2),f=i(c),x=i(f,!0);r(f);var _=o(f,2);_.__click=()=>s.paletteState.addSwatch(s.paletteState.activeColor),r(c),r(n);var h=o(n,4),g=i(h),w=i(g,!0);r(g);var y=o(g,2);Pi(y,{get colors(){return s.usedColors}}),r(h),r(t),I((m,k,b)=>{E(d,m),ue(v,`background-color: ${s.paletteState.activeColor??""};`),E(x,s.paletteState.activeColor),D(_,"title",k),E(w,b)},[()=>A("workspace:hud.active_color"),()=>A("workspace:hud.actions.add_color"),()=>A("workspace:hud.recent_colors")]),p(u,t),re()}Ae(["click"]);var Ri=L('<div class="editor-panel w-full border-none bg-sidebar-bg/50 p-3 shadow-sm" role="status"><div class="flex flex-col gap-3"><div class="flex flex-col"><span class="font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </span> <span class="font-mono text-[11px] font-bold text-text-main tabular-nums"> </span></div> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <div class="flex flex-col"><span class="font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </span> <span class="font-mono text-[11px] font-bold text-text-main tabular-nums"> </span></div></div></div>');function Oi(u,e){ae(e,!1),Ce();var t=Ri(),n=i(t),l=i(n),d=i(l),v=i(d,!0);r(d);var c=o(d,2),f=i(c);r(c),r(l);var x=o(l,4),_=i(x),h=i(_,!0);r(_);var g=o(_,2),w=i(g);r(g),r(x),r(n),r(t),I((y,m)=>{E(v,y),E(f,`${s.displayCoords.x??""}, ${s.displayCoords.y??""}`),E(h,m),E(w,`${s.canvas.width??""}√ó${s.canvas.height??""}`)},[()=>A("workspace:stats.cursor_focus"),()=>A("workspace:stats.canvas_size")]),p(u,t),re()}var st=wt(()=>s),Mi=L('<button role="radio"></button>'),Di=L('<div class="editor-panel flex w-full flex-col gap-3 border-none bg-sidebar-bg/30 p-3 shadow-sm" role="region" aria-label="Natural Pigments"><span class="text-center font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </span> <div class="grid grid-cols-4 gap-2" role="radiogroup"><!> <button class="flex h-8 w-8 items-center justify-center rounded border border-dashed border-text-main/20 bg-text-main/5 transition-all hover:scale-110 hover:border-ui-accent/40 hover:bg-ui-highlight/20"><span class="text-xs opacity-40" aria-hidden="true">üè∫</span></button> <button class="flex h-8 w-8 items-center justify-center rounded border border-dashed border-text-main/20 bg-text-main/5 transition-all hover:scale-110 hover:border-ui-accent/40 hover:bg-ui-highlight/20"><span class="text-xs opacity-40" aria-hidden="true">üé®</span></button></div></div>');function zi(u,e){ae(e,!1),Ce();var t=Di(),n=i(t),l=i(n,!0);r(n);var d=o(n,2),v=i(d);_e(v,1,()=>st().palette,ke,(x,_,h)=>{var g=Mi();g.__click=()=>Ze.handleIntent(`SELECT_COLOR_${(h+1)%10}`),g.__contextmenu=w=>{w.preventDefault(),st(st().studio.contextMenu={x:w.clientX,y:w.clientY,items:[{label:A("workspace:hud.context_menu.delete_color"),icon:"üóëÔ∏è",danger:!0,disabled:st().palette.length<=1,action:()=>st().paletteState.removeSwatch(h)}]})},I((w,y)=>{ne(g,1,`editor-checker-small h-8 w-8 rounded transition-all ${st().activeColor===a(_)?"is-active-pigment z-10 scale-110 border-2 border-ui-accent shadow-md":"border border-text-main/5 opacity-80 hover:scale-105 hover:opacity-100"}`),ue(g,`background-color: ${a(_)??""};`),D(g,"aria-label",w),D(g,"title",y),D(g,"aria-checked",st().activeColor===a(_))},[()=>A(`actions:select_color_${(h+1)%10}`),()=>A(`actions:select_color_${(h+1)%10}`)+` (${(h+1)%10})`]),p(x,g)});var c=o(v,2);c.__click=()=>st(st().showColorPicker=!0);var f=o(c,2);f.__click=()=>st(st().studio.showPaletteLibrary=!0),r(d),r(t),I((x,_,h,g,w)=>{E(l,x),D(c,"title",_),D(c,"aria-label",h),D(f,"title",g),D(f,"aria-label",w)},[()=>A("shortcuts:groups.colors"),()=>A("tools:color_picker.title"),()=>A("tools:color_picker.title"),()=>A("tools:palette_library.title"),()=>A("tools:palette_library.title")]),p(u,t),re()}Ae(["click","contextmenu"]);var Fi=L('<span class="text-[10px]">‚ñ†</span>'),Ni=L('<span class="text-[10px]">‚óè</span>'),Bi=L('<div class="flex flex-col gap-2"><div class="flex items-center justify-between"><span class="font-serif text-[10px] font-bold text-text-main/40 uppercase"> </span> <div class="flex items-center gap-1"><!> <span class="font-tiny5 text-[8px] text-text-main/30"> </span></div></div> <!></div>'),Gi=L('<div class="editor-panel flex w-full flex-col gap-4 border-none bg-canvas-bg p-3 shadow-sm"><div class="flex items-center justify-between"><span class="font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </span> <div class="flex items-center gap-1.5"><!> <!></div></div> <div class="flex flex-col gap-2"><div class="flex items-center justify-between"><span class="font-serif text-[10px] font-bold text-text-main/40 uppercase"> </span> <div class="flex items-center gap-1"><!> <span class="font-tiny5 text-[8px] text-text-main/30"> </span></div></div> <!></div> <div class="h-px w-full bg-text-main/5"></div> <div class="flex items-center justify-between"><div class="flex flex-col"><span class="font-serif text-[10px] font-bold text-text-main/40 uppercase"> </span> <span class="font-serif text-[8px] text-text-main/30 italic"> </span></div> <!></div> <!></div>');function Ui(u,e){ae(e,!1);const t=fa(s.studio);Ce();var n=Gi(),l=i(n),d=i(l),v=i(d,!0);r(d);var c=o(d,2),f=i(c);{let N=ht(()=>a(t).brushShape==="SQUARE");fe(f,{variant:"tool",get isActive(){return a(N)},onclick:()=>Ze.handleIntent("TOGGLE_BRUSH_SHAPE"),ariaLabel:"tools:brush_settings.shape_square",class:"h-6 w-6 !p-0",children:(Y,H)=>{var K=Fi();p(Y,K)},$$slots:{default:!0}})}var x=o(f,2);{let N=ht(()=>a(t).brushShape==="CIRCLE");fe(x,{variant:"tool",get isActive(){return a(N)},onclick:()=>Ze.handleIntent("TOGGLE_BRUSH_SHAPE"),ariaLabel:"tools:brush_settings.shape_circle",class:"h-6 w-6 !p-0",children:(Y,H)=>{var K=Ni();p(Y,K)},$$slots:{default:!0}})}r(c),r(l);var _=o(l,2),h=i(_),g=i(h),w=i(g,!0);r(g);var y=o(g,2),m=i(y);Be(m,{type:"number",ariaLabel:"tools:brush_settings.size_label",class:"w-12",get value(){return a(t).brushSize},set value(N){at(t,a(t).brushSize=N)},$$legacy:!0});var k=o(m,2),b=i(k,!0);r(k),r(y),r(h);var S=o(h,2);ot(S,{min:1,max:100,ariaLabel:"tools:brush_settings.size_label",get value(){return a(t).brushSize},set value(N){at(t,a(t).brushSize=N)},$$legacy:!0}),r(_);var C=o(_,4),P=i(C),T=i(P),$=i(T,!0);r(T);var j=o(T,2),R=i(j,!0);r(j),r(P);var F=o(P,2);Yt(F,{ariaLabel:"tools:brush_settings.dither_label",get checked(){return a(t).isDitherBlendActive},set checked(N){at(t,a(t).isDitherBlendActive=N)},$$legacy:!0}),r(C);var ee=o(C,2);{var Z=N=>{var Y=Bi(),H=i(Y),K=i(H),oe=i(K,!0);r(K);var G=o(K,2),z=i(G);Be(z,{type:"number",ariaLabel:"tools:brush_settings.hardness_label",class:"w-12",get value(){return a(t).brushHardness},set value(V){at(t,a(t).brushHardness=V)},$$legacy:!0});var X=o(z,2),O=i(X,!0);r(X),r(G),r(H);var J=o(H,2);ot(J,{min:0,max:100,ariaLabel:"tools:brush_settings.hardness_label",get value(){return a(t).brushHardness},set value(V){at(t,a(t).brushHardness=V)},$$legacy:!0}),r(Y),I((V,te)=>{E(oe,V),E(O,te)},[()=>A("tools:brush_settings.hardness_label"),()=>A("ui:units.percentage")]),pe(3,Y,()=>he,()=>({duration:150})),p(N,Y)};M(ee,N=>{a(t).isDitherBlendActive&&N(Z)})}r(n),I((N,Y,H,K,oe)=>{E(v,N),E(w,Y),E(b,H),E($,K),E(R,oe)},[()=>A("tools:brush_settings.title"),()=>A("tools:brush_settings.size_label"),()=>A("ui:units.pixels"),()=>A("tools:brush_settings.dither_label"),()=>A("tools:brush_settings.dither_desc")]),p(u,n),re()}var Hi=L('<aside class="side-panel-right flex h-full w-full bg-canvas-bg/50"><div class="bg-hud-shadow/[0.02] flex h-full flex-col border-r border-text-main/5 px-2"><!></div> <div class="custom-scrollbar flex flex-1 flex-col gap-4 overflow-y-auto p-3"><div class="flex flex-col gap-3"><!> <!> <!></div> <div class="flex-1"></div> <!></div></aside>');function Vi(u){var e=Hi(),t=i(e),n=i(t);wa(n,{side:"right"}),r(t);var l=o(t,2),d=i(l),v=i(d);Ui(v,{});var c=o(v,2);$i(c,{});var f=o(c,2);zi(f,{}),r(d);var x=o(d,4);Oi(x,{}),r(l),r(e),p(u,e)}var Yi=L('<span class="text-xs" aria-hidden="true"> </span>'),Ki=L('<span class="ml-1 border-l border-text-main/20 pl-2 font-mono text-[9px] tracking-tighter not-italic"> </span>'),Qi=L("<div><!> <span> </span> <!></div>"),qi=L('<div class="text-[8px] font-bold tracking-[0.2em] text-text-main/20 uppercase"> </div>'),Wi=L('<div class="flex items-center gap-4 transition-opacity duration-1000" role="status" aria-live="polite"><div class="flex w-[180px] items-center"><!></div> <!></div>');function Xi(u,e){ae(e,!1),Ce();var t=Wi(),n=i(t),l=i(n);nr(l,()=>et.current.type,c=>{var f=Qi(),x=i(f);{var _=m=>{var k=Yi(),b=i(k,!0);r(k),I(()=>E(b,et.current.icon)),p(m,k)};M(x,m=>{et.current.icon&&m(_)})}var h=o(x,2),g=i(h,!0);r(h);var w=o(h,2);{var y=m=>{var k=Ki(),b=i(k);r(k),I(()=>E(b,`v${s.version??""}`)),p(m,k)};M(w,m=>{et.current.type==="READY"&&m(y)})}r(f),I(()=>{ne(f,1,`status-tag flex items-center gap-2 ${et.current.isPulse?"animate-pulse":""}`),ue(f,`
					border-color: color-mix(in srgb, ${et.current.color??""} 20%, transparent);
					background-color: color-mix(in srgb, ${et.current.color??""} 10%, transparent);
					color: ${et.current.color??""};
				`),ne(h,1,ir(et.current.type==="READY"?"font-serif italic opacity-60":"font-bold")),E(g,et.current.label)}),p(c,f)}),r(n);var d=o(n,2);{var v=c=>{const f=ht(()=>s.project.lastSaved.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}));var x=qi(),_=i(x,!0);r(x),I((h,g)=>{D(x,"aria-label",h),E(_,g)},[()=>A("workspace:project.saved",{replace:{time:a(f)}}),()=>A("workspace:project.saved",{replace:{time:a(f)}})]),p(c,x)};M(d,c=>{s.project.lastSaved&&c(v)})}r(t),p(u,t),re()}var Zi=L("<span><!></span>");function ze(u,e){let t=ie(e,"variant",3,"secondary"),n=ie(e,"size",3,"md"),l=ie(e,"class",3,"");const d={primary:"bg-ui-accent text-white border border-ui-structural shadow-[2px_2px_0px_var(--color-ui-structural)]",secondary:"bg-canvas-bg text-text-main border border-ui-structural shadow-[2px_2px_0px_var(--color-ui-structural)]",accent:"bg-ui-highlight text-text-main border border-ui-structural shadow-[2px_2px_0px_var(--color-ui-structural)]",danger:"bg-ui-danger text-white border border-ui-structural shadow-[2px_2px_0px_var(--color-ui-structural)]",ghost:"bg-transparent text-text-main border border-ui-structural"},v={sm:"px-1.5 py-0.5 text-[8px] tracking-widest",md:"px-2 py-0.5 text-[10px] tracking-wider",lg:"px-3 py-1 text-[12px] tracking-normal"};var c=Zi(),f=i(c);{var x=_=>{var h=me(),g=se(h);je(g,()=>e.children),p(_,h)};M(f,_=>{e.children&&_(x)})}r(c),I(()=>ne(c,1,`
        inline-flex flex-nowrap items-center justify-center rounded-sm font-bold
        whitespace-nowrap uppercase select-none
        ${d[t()]??""}
        ${v[n()]??""}
        ${l()??""}
    `)),p(u,c)}var Ji=L('<span class="font-mono text-[9px] text-text-main/40 italic"> </span>'),es=L('<div class="flex items-center gap-2"><span class="font-serif text-[8px] font-black tracking-widest text-text-main/50 uppercase italic"> </span> <div class="flex min-w-[80px] gap-1.5"><!></div></div>');function ts(u,e){ae(e,!1),Ce();var t=es(),n=i(t),l=i(n);r(n);var d=o(n,2),v=i(d);{var c=x=>{var _=me(),h=se(_);_e(h,1,()=>Ge.activeKeys,ke,(g,w)=>{ze(g,{variant:"secondary",size:"sm",children:(y,m)=>{xe();var k=ce();I(()=>E(k,a(w)===" "?"Space":a(w))),p(y,k)},$$slots:{default:!0}})}),p(x,_)},f=x=>{var _=Ji(),h=i(_,!0);r(_),I(g=>E(h,g),[()=>A("timeline:waiting")]),p(x,_)};M(v,x=>{Ge.activeKeys.length>0?x(c):x(f,!1)})}r(d),r(t),I(x=>E(l,`${x??""}:`),[()=>A("timeline:rhythm")]),p(u,t),re()}var as=L('<div class="flex items-center gap-2"><span class="font-serif text-[8px] font-black tracking-widest text-text-main/50 uppercase italic"> </span> <!></div>');function rs(u,e){ae(e,!1),Ce();var t=as(),n=i(t),l=i(n);r(n);var d=o(n,2);ze(d,{variant:"primary",size:"sm",children:(v,c)=>{xe();var f=ce();I(()=>E(f,et.current.label)),p(v,f)},$$slots:{default:!0}}),r(t),I(v=>E(l,`${v??""}:`),[()=>A("timeline:mode")]),p(u,t),re()}var is=L('<div role="tooltip"> <div></div></div>'),ss=L("<div><!> <!></div>");function Ne(u,e){ae(e,!0);let t=ie(e,"position",3,"top"),n=ie(e,"class",3,""),l=ve(!1);const d={top:"bottom-full left-1/2 -translate-x-1/2 mb-2",bottom:"top-full left-1/2 -translate-x-1/2 mt-2",left:"right-full top-1/2 -translate-y-1/2 mr-2",right:"left-full top-1/2 -translate-y-1/2 ml-2"},v={top:"top-full left-1/2 -translate-x-1/2 border-t-ui-structural border-x-transparent border-b-transparent",bottom:"bottom-full left-1/2 -translate-x-1/2 border-b-ui-structural border-x-transparent border-t-transparent",left:"left-full top-1/2 -translate-y-1/2 border-l-ui-structural border-y-transparent border-r-transparent",right:"right-full top-1/2 -translate-y-1/2 border-r-ui-structural border-y-transparent border-l-transparent"};var c=ss();c.__focusin=()=>U(l,!0),c.__focusout=()=>U(l,!1);var f=i(c);{var x=g=>{var w=me(),y=se(w);je(y,()=>e.children),p(g,w)};M(f,g=>{e.children&&g(x)})}var _=o(f,2);{var h=g=>{var w=is(),y=i(w),m=o(y);r(w),I(k=>{ne(w,1,`
                pointer-events-none absolute z-[5000] rounded-sm bg-ui-structural
                px-3 py-1.5 text-[10px] font-bold tracking-wider whitespace-nowrap
                text-canvas-bg uppercase shadow-xl
                ${d[t()]??""}
            `),E(y,`${k??""} `),ne(m,1,`absolute border-[6px] ${v[t()]??""}`)},[()=>A(e.text)]),p(g,w)};M(_,g=>{a(l)&&e.text&&g(h)})}r(c),I(()=>ne(c,1,`relative inline-block ${n()??""}`)),$e("mouseenter",c,()=>U(l,!0)),$e("mouseleave",c,()=>U(l,!1)),p(u,c),re()}Ae(["focusin","focusout"]);var os=L('<div class="flex items-center gap-1.5"><span aria-hidden="true">üéê</span> <span class="font-serif text-[8px] font-black tracking-widest text-text-main/50 uppercase italic"><!></span></div>');function ns(u,e){ae(e,!1),Ce(),Ne(u,{text:"timeline:audio_status.title",children:(t,n)=>{var l=os(),d=i(l),v=o(d,2),c=i(v);{var f=_=>{var h=ce();I(g=>E(h,g),[()=>A("timeline:audio_status.silent")]),p(_,h)},x=_=>{var h=me(),g=se(h);{var w=m=>{var k=ce();I(b=>E(k,b),[()=>A("timeline:audio_status.brewing")]),p(m,k)},y=m=>{var k=ce();I(b=>E(k,b),[()=>A("timeline:audio_status.resonant")]),p(m,k)};M(g,m=>{s.usageMinutes<60?m(w):m(y,!1)},!0)}p(_,h)};M(c,_=>{s.usageMinutes<30?_(f):_(x,!1)})}r(v),r(l),I(()=>ne(d,1,`text-[9px] ${s.usageMinutes>=30?"animate-pulse":"opacity-40 grayscale"}`)),p(t,l)},$$slots:{default:!0}}),re()}var ls=L('<div class="flex items-center gap-1.5"><span class="text-[9px] opacity-40" aria-hidden="true">‚è≥</span> <span class="font-mono text-[9px] font-bold text-text-main/80 tabular-nums"> </span></div>');function cs(u,e){ae(e,!1),Ce();var t=ls(),n=o(i(t),2),l=i(n,!0);r(n),r(t),I(d=>{D(t,"title",d),E(l,s.studio.sessionTimeLabel)},[()=>A("timeline:duration")]),p(u,t),re()}var bt=wt(()=>s),ds=L('<span aria-hidden="true">üåÄ</span> <span class="text-[8px]"> </span>',1),vs=L('<div class="flex items-center gap-3"><div class="flex items-center gap-1.5"><span class="text-[9px] opacity-40" aria-hidden="true">‚ú®</span> <span class="font-serif text-[8px] font-black tracking-widest text-text-main/60 uppercase italic"> </span></div> <!></div>');function us(u,e){ae(e,!1),Ce();var t=vs(),n=i(t),l=o(i(n),2),d=i(l,!0);r(l),r(n);var v=o(n,2);{var c=f=>{fe(f,{variant:"primary",size:"sm",onclick:()=>bt(bt().studio.showPourBasin=!0),ariaLabel:"export:propagation.title",class:"!px-2 !py-0.5",children:(x,_)=>{var h=ds(),g=o(se(h),2),w=i(g,!0);r(g),I(y=>E(w,y),[()=>A("export:propagation.title")]),p(x,h)},$$slots:{default:!0}})};M(v,f=>{bt().selection.isActive&&bt().project.frames.length>1&&f(c)})}r(t),I(f=>E(d,f),[()=>A(bt().selection.maskCount>1?"timeline:pixel_count_plural":"timeline:pixel_count",{replace:{count:bt().selection.maskCount}})]),p(u,t),re()}var ps=L('<div class="flex items-center gap-1.5"><span class="text-[10px]" aria-hidden="true">üì¶</span> <!></div> <div class="h-3 w-px bg-text-main/20" aria-hidden="true"></div>',1),fs=L('<div class="flex items-center gap-3 text-text-main/40" role="status"><!> <div class="flex gap-3 font-mono text-[9px] font-bold tracking-tight text-text-main/60 uppercase"><span> </span> <span> </span> <span> </span></div> <div class="h-3 w-px bg-text-main/20" aria-hidden="true"></div> <!></div>');function xs(u,e){ae(e,!1),Ce();var t=fs(),n=i(t);{var l=w=>{var y=ps(),m=se(y),k=o(i(m),2);ze(k,{variant:"primary",size:"sm",class:"!bg-ui-accent/10 !text-ui-accent/80",children:(b,S)=>{xe();var C=ce();I(P=>E(C,P),[()=>A("workspace:project.saved",{replace:{time:s.project.lastSaved.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}})]),p(b,C)},$$slots:{default:!0}}),r(m),xe(2),pe(3,m,()=>he),p(w,y)};M(n,w=>{s.project.lastSaved&&w(l)})}var d=o(n,2),v=i(d),c=i(v);r(v);var f=o(v,2),x=i(f);r(f);var _=o(f,2),h=i(_);r(_),r(d);var g=o(d,4);ze(g,{variant:"secondary",size:"sm",children:(w,y)=>{xe();var m=ce();I(k=>E(m,k),[()=>A("workspace:stats.technical_details")]),p(w,m)},$$slots:{default:!0}}),r(t),I((w,y,m,k)=>{E(c,`${w??""}: ${s.cursor.pos.x??""},${s.cursor.pos.y??""}`),E(x,`${y??""}: ${s.canvas.width??""}x${s.canvas.height??""}`),E(h,`${m??""}: ${k??""}%`)},[()=>A("workspace:stats.pos_label"),()=>A("workspace:stats.size_label"),()=>A("workspace:stats.zoom_label"),()=>Math.round(s.studio.zoomLevel*100)]),p(u,t),re()}var gs=L('<div class="flex items-center gap-1"><span class="text-[8px] uppercase opacity-40"> </span> <span class="font-bold text-ui-accent"> </span> <span class="opacity-40"> </span></div>'),ms=L(" <!>",1),hs=L("<div><!></div>"),_s=L("<span>üîíA</span>"),bs=L("<span>üîíC</span>"),As=L('<div class="flex items-center gap-1 text-ui-accent"><!> <!></div>'),ys=L("<div><!></div>"),ws=L("<div><!></div>"),ks=L("<div><!></div>"),Es=L('<div class="animate-pulse"><!></div>'),Ls=L("<div><!></div>"),Ss=L("<div><!></div>"),Cs=L("<div><!></div>"),Ts=L("<div><!></div>"),Is=L("<div><!></div>"),Ps=L("<div><!></div>"),js=L("<div><!></div>"),$s=L("<div><!></div>"),Rs=L('<div class="flex items-center gap-3 font-serif text-[10px] tracking-wide text-text-main/60"><!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!></div>');function Os(u,e){ae(e,!1);const t=s.studio;Ce();var n=Rs(),l=i(n);Ne(l,{text:"actions:brush_size_inc",children:(G,z)=>{var X=gs(),O=i(X),J=i(O,!0);r(O);var V=o(O,2),te=i(V);r(V);var q=o(V,2),le=i(q,!0);r(q),r(X),I(Le=>{E(J,Le),E(te,`${t.brushSize??""}px`),E(le,t.brushShape==="SQUARE"?"‚ñ†":"‚óè")},[()=>A("shortcuts:groups.etching")]),p(G,X)},$$slots:{default:!0}});var d=o(l,2);{var v=G=>{Ne(G,{text:"actions:cycle_symmetry",children:(z,X)=>{var O=hs(),J=i(O);ze(J,{variant:"primary",size:"sm",children:(V,te)=>{xe();var q=ms(),le=se(q),Le=o(le);{var Ee=be=>{var Re=ce("‚Äî");p(be,Re)},W=be=>{var Re=me(),Oe=se(Re);{var Te=He=>{var Ve=ce("|");p(He,Ve)},Qe=He=>{var Ve=ce("+");p(He,Ve)};M(Oe,He=>{t.symmetryMode==="VERTICAL"?He(Te):He(Qe,!1)},!0)}p(be,Re)};M(Le,be=>{t.symmetryMode==="HORIZONTAL"?be(Ee):be(W,!1)})}I(be=>E(le,`${be??""}: `),[()=>A("actions:cycle_symmetry")]),p(V,q)},$$slots:{default:!0}}),r(O),pe(3,O,()=>he),p(z,O)},$$slots:{default:!0}})};M(d,G=>{t.symmetryMode!=="OFF"&&G(v)})}var c=o(d,2);{var f=G=>{var z=As(),X=i(z);{var O=te=>{Ne(te,{text:"actions:toggle_alpha_lock",children:(q,le)=>{var Le=_s();p(q,Le)},$$slots:{default:!0}})};M(X,te=>{t.isAlphaLocked&&te(O)})}var J=o(X,2);{var V=te=>{Ne(te,{text:"actions:toggle_color_lock",children:(q,le)=>{var Le=bs();p(q,Le)},$$slots:{default:!0}})};M(J,te=>{t.isColorLocked&&te(V)})}r(z),pe(3,z,()=>he),p(G,z)};M(c,G=>{(t.isAlphaLocked||t.isColorLocked)&&G(f)})}var x=o(c,2);{var _=G=>{Ne(G,{text:"actions:toggle_tiling",children:(z,X)=>{var O=ys(),J=i(O);ze(J,{variant:"primary",size:"sm",children:(V,te)=>{xe();var q=ce("‚àû");p(V,q)},$$slots:{default:!0}}),r(O),pe(3,O,()=>he),p(z,O)},$$slots:{default:!0}})};M(x,G=>{t.isTilingEnabled&&G(_)})}var h=o(x,2);{var g=G=>{Ne(G,{text:"actions:toggle_airbrush",children:(z,X)=>{var O=ws(),J=i(O);ze(J,{variant:"primary",size:"sm",children:(V,te)=>{xe();var q=ce();I(le=>E(q,`‚òÅÔ∏è ${le??""}`),[()=>A("tools:status.mist")]),p(V,q)},$$slots:{default:!0}}),r(O),pe(3,O,()=>he),p(z,O)},$$slots:{default:!0}})};M(h,G=>{t.isAirbrushActive&&G(g)})}var w=o(h,2);{var y=G=>{Ne(G,{text:"actions:toggle_pixel_perfect",children:(z,X)=>{var O=ks(),J=i(O);ze(J,{variant:"accent",size:"sm",children:(V,te)=>{xe();var q=ce();I(le=>E(q,`‚ú® ${le??""}`),[()=>A("tools:status.pure")]),p(V,q)},$$slots:{default:!0}}),r(O),pe(3,O,()=>he),p(z,O)},$$slots:{default:!0}})};M(w,G=>{t.isPixelPerfect&&G(y)})}var m=o(w,2);{var k=G=>{Ne(G,{text:"actions:tool_transform",children:(z,X)=>{var O=Es(),J=i(O);ze(J,{variant:"primary",size:"sm",children:(V,te)=>{xe();var q=ce();I(le=>E(q,`üß∫ ${le??""}`),[()=>A("tools:status.moving")]),p(V,q)},$$slots:{default:!0}}),r(O),pe(3,O,()=>he),p(z,O)},$$slots:{default:!0}})};M(m,G=>{t.isTransforming&&G(k)})}var b=o(m,2);{var S=G=>{Ne(G,{text:"actions:toggle_pattern_brush",children:(z,X)=>{var O=Ls(),J=i(O);ze(J,{variant:"primary",size:"sm",children:(V,te)=>{xe();var q=ce();I(le=>E(q,`üé® ${le??""}`),[()=>A("tools:status.stencil")]),p(V,q)},$$slots:{default:!0}}),r(O),pe(3,O,()=>he),p(z,O)},$$slots:{default:!0}})};M(b,G=>{t.isPatternBrushActive&&G(S)})}var C=o(b,2);{var P=G=>{Ne(G,{text:"actions:toggle_dither_blend",children:(z,X)=>{var O=Ss(),J=i(O);ze(J,{variant:"primary",size:"sm",children:(V,te)=>{xe();var q=ce();I(le=>E(q,`üåø ${le??""} (${t.brushHardness??""}%)`),[()=>A("tools:status.dither")]),p(V,q)},$$slots:{default:!0}}),r(O),pe(3,O,()=>he),p(z,O)},$$slots:{default:!0}})};M(C,G=>{t.isDitherBlendActive&&G(P)})}var T=o(C,2);{var $=G=>{Ne(G,{text:"actions:tool_rectangle",children:(z,X)=>{var O=Cs(),J=i(O);ze(J,{variant:"primary",size:"sm",children:(V,te)=>{xe();var q=ce();I(le=>E(q,`üì¶ ${le??""}`),[()=>A("tools:status.box")]),p(V,q)},$$slots:{default:!0}}),r(O),pe(3,O,()=>he),p(z,O)},$$slots:{default:!0}})};M(T,G=>{t.activeTool==="RECTANGLE"&&G($)})}var j=o(T,2);{var R=G=>{Ne(G,{text:"actions:tool_ellipse",children:(z,X)=>{var O=Ts(),J=i(O);ze(J,{variant:"primary",size:"sm",children:(V,te)=>{xe();var q=ce();I(le=>E(q,`‚≠ï ${le??""}`),[()=>A("tools:status.round")]),p(V,q)},$$slots:{default:!0}}),r(O),pe(3,O,()=>he),p(z,O)},$$slots:{default:!0}})};M(j,G=>{t.activeTool==="ELLIPSE"&&G(R)})}var F=o(j,2);{var ee=G=>{Ne(G,{text:"actions:tool_polygon",children:(z,X)=>{var O=Is(),J=i(O);ze(J,{variant:"primary",size:"sm",children:(V,te)=>{xe();var q=ce();I(le=>E(q,`‚≠ê ${le??""} (${t.polygonSides??""})`),[()=>A("tools:status.poly")]),p(V,q)},$$slots:{default:!0}}),r(O),pe(3,O,()=>he),p(z,O)},$$slots:{default:!0}})};M(F,G=>{t.activeTool==="POLYGON"&&G(ee)})}var Z=o(F,2);{var N=G=>{Ne(G,{text:"actions:toggle_shade_lighten",children:(z,X)=>{var O=Ps(),J=i(O);ze(J,{variant:"primary",size:"sm",children:(V,te)=>{xe();var q=ce();I(le=>E(q,`‚òÄÔ∏è ${le??""}`),[()=>A("tools:status.light")]),p(V,q)},$$slots:{default:!0}}),r(O),pe(3,O,()=>he),p(z,O)},$$slots:{default:!0}})};M(Z,G=>{t.isShadingLighten&&G(N)})}var Y=o(Z,2);{var H=G=>{Ne(G,{text:"actions:toggle_shade_darken",children:(z,X)=>{var O=js(),J=i(O);ze(J,{variant:"primary",size:"sm",children:(V,te)=>{xe();var q=ce();I(le=>E(q,`üåô ${le??""}`),[()=>A("tools:status.dark")]),p(V,q)},$$slots:{default:!0}}),r(O),pe(3,O,()=>he),p(z,O)},$$slots:{default:!0}})};M(Y,G=>{t.isShadingDarken&&G(H)})}var K=o(Y,2);{var oe=G=>{Ne(G,{text:"actions:toggle_shade_dither",children:(z,X)=>{var O=$s(),J=i(O);ze(J,{variant:"primary",size:"sm",children:(V,te)=>{xe();var q=ce();I(le=>E(q,`üèÅ ${le??""}`),[()=>A("tools:status.dither")]),p(V,q)},$$slots:{default:!0}}),r(O),pe(3,O,()=>he),p(z,O)},$$slots:{default:!0}})};M(K,G=>{t.isShadingDither&&G(oe)})}r(n),p(u,n),re()}var Ms=L('<div class="flex flex-1 items-center justify-between px-3 opacity-80 transition-opacity hover:opacity-100"><div class="flex items-center gap-4"><!> <div class="h-3 w-px bg-text-main/20"></div> <!> <div class="h-3 w-px bg-text-main/20"></div> <div class="flex items-center gap-3"><!> <div class="h-3 w-px bg-text-main/20"></div> <!> <!> <div class="h-3 w-px bg-text-main/20"></div> <!></div></div> <!></div>');function Ds(u){var e=Ms(),t=i(e),n=i(t);ts(n,{});var l=o(n,4);rs(l,{});var d=o(l,4),v=i(d);Os(v,{});var c=o(v,4);cs(c,{});var f=o(c,2);ns(f,{});var x=o(f,4);us(x,{}),r(d),r(t);var _=o(t,2);xs(_,{}),r(e),p(u,e)}var Je=wt(()=>s),zs=L('<span class="text-xs" aria-hidden="true"> </span> <span class="font-tiny5 tracking-widest uppercase"> </span>',1),Fs=L('<span class="text-xs" aria-hidden="true">üëª</span>'),Ns=L('<div class="flex min-w-0 items-center gap-4 border-r border-text-main/5 pr-4" role="toolbar" aria-label="Timeline Controls"><!> <div class="flex items-center gap-2 rounded-lg bg-text-main/5 px-2 py-1 ring-1 ring-text-main/10"><span class="font-serif text-[8px] font-bold text-text-main/40 uppercase"> </span> <!> <span class="font-tiny5 text-[8px] text-text-main/30"> </span></div> <!> <div class="flex items-center gap-3 border-l border-text-main/10 pl-4"><span class="font-serif text-[8px] font-bold text-text-main/40 uppercase"> </span> <!></div></div>');function Bs(u,e){ae(e,!1),Ce();var t=Ns(),n=i(t);{let m=ht(()=>Je().project.isPlaying?"primary":"secondary");fe(n,{get variant(){return a(m)},onclick:()=>ga.togglePlayback(),ariaLabel:"actions:play_pause",class:"!px-4 !py-1.5 text-xs",children:(k,b)=>{var S=zs(),C=se(S),P=i(C,!0);r(C);var T=o(C,2),$=i(T,!0);r(T),I(j=>{E(P,Je().project.isPlaying?"‚èπ":"‚ñ∂"),E($,j)},[()=>Je().project.isPlaying?A("ui:labels.off"):A("ui:labels.on")]),p(k,S)},$$slots:{default:!0}})}var l=o(n,2),d=i(l),v=i(d,!0);r(d);var c=o(d,2);Be(c,{type:"number",min:1,max:60,ariaLabel:"workspace:settings.fps_label",class:"!h-6 w-12 !border-none !bg-transparent !p-0 !text-center !text-[10px] !shadow-none",get value(){return Je().project.fps},set value(m){Je(Je().project.fps=m)},$$legacy:!0});var f=o(c,2),x=i(f,!0);r(f),r(l);var _=o(l,2);fe(_,{variant:"tool",get isActive(){return Je().studio.showGhostLayers},onclick:()=>Je(Je().studio.showGhostLayers=!Je().studio.showGhostLayers),ariaLabel:"actions:toggle_ghost_layers",class:"!h-8 !px-3",children:(m,k)=>{var b=Fs();p(m,b)},$$slots:{default:!0}});var h=o(_,2),g=i(h),w=i(g,!0);r(g);var y=o(g,2);ot(y,{min:.5,max:4,step:.1,ariaLabel:"ui:labels.timeline_zoom",class:"w-64",get value(){return Je().studio.timelineZoom},set value(m){Je(Je().studio.timelineZoom=m)},$$legacy:!0}),r(h),r(t),I((m,k,b)=>{E(v,m),E(x,k),E(w,b)},[()=>A("workspace:settings.fps_label"),()=>A("ui:units.fps"),()=>A("ui:labels.timeline_zoom")]),p(u,t),re()}var Gs=L('<div class="group absolute top-0 flex h-4 items-center justify-center rounded-t border-x border-t border-text-main/10 px-2 transition-all hover:h-5"><span class="truncate font-serif text-[8px] font-black text-text-main/60 uppercase"> </span> <button class="ml-1 hidden h-3 w-3 items-center justify-center rounded-full bg-text-main/10 text-[6px] group-hover:flex hover:bg-ui-accent hover:text-white">‚úï</button></div>');function Us(u,e){ae(e,!0);const t=32;let n=B(()=>e.tag.from*t),l=B(()=>(e.tag.to-e.tag.from+1)*t);function d(){Q.project.removeTag(e.tag.id)}var v=Gs(),c=i(v),f=i(c,!0);r(c);var x=o(c,2);x.__click=d,r(v),I(()=>{ue(v,`left: ${a(n)??""}px; width: ${a(l)??""}px; background-color: ${e.tag.color??""}44; border-top-color: ${e.tag.color??""};`),D(v,"title",e.tag.name),E(f,e.tag.name)}),p(u,v),re()}Ae(["click"]);var Hs=L("<span> </span>"),Vs=L('<span class="mt-0.5 font-mono text-[7px] leading-none font-bold text-text-main/20"> </span>'),Ys=L("<div><div></div> <!></div>"),Ks=L('<div class="flex h-6 shrink-0 border-b border-text-main/5 bg-canvas-bg/95"><div class="z-40 flex w-32 shrink-0 items-center border-r border-text-main/10 bg-canvas-bg px-2 font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </div> <div class="relative flex-1 overflow-hidden" role="presentation"><div class="absolute inset-0 flex items-center"></div></div></div>');function Qs(u,e){ae(e,!0);var t=Ks(),n=i(t),l=i(n,!0);r(n);var d=o(n,2);d.__click=function(...c){e.onScrub?.apply(this,c)};var v=i(d);_e(v,21,()=>e.rulerMarks,ke,(c,f)=>{var x=Ys(),_=i(x),h=o(_,2);{var g=y=>{var m=Hs(),k=i(m,!0);r(m),I(()=>{ne(m,1,`font-mono text-[7px] font-black ${a(f).isMajor&&!a(f).isFuture?"text-ui-accent":"text-text-main/40"} mt-0.5 leading-none`),E(k,a(f).label)}),p(y,m)},w=y=>{var m=me(),k=se(m);{var b=S=>{var C=Vs(),P=i(C,!0);r(C),I(()=>E(P,a(f).index+1)),p(S,C)};M(k,S=>{a(f).index%5===0&&S(b)},!0)}p(y,m)};M(h,y=>{a(f).label?y(g):y(w,!1)})}r(x),I(()=>{ne(x,1,`absolute flex flex-col items-center transition-opacity duration-300 ${a(f).isFuture?"opacity-20":"opacity-100"}`),ue(x,`left: ${a(f).index*e.currentFrameWidth}px; width: ${e.currentFrameWidth??""}px;`),ne(_,1,`w-px bg-text-main/20 ${a(f).isMajor?"h-2":"h-1"}`)}),p(c,x)}),r(v),r(d),r(t),I(c=>{E(l,c),ue(v,`width: ${e.maxRulerWidth??""}px; min-width: 100%; transform: translateX(-${e.scrollLeft??""}px);`)},[()=>A("workspace:hud.project_panel.layers")]),p(u,t),re()}Ae(["click"]);var qs=L('<button><span class="truncate font-serif text-[9px] font-bold uppercase"> </span></button>'),Ws=L('<div class="sticky left-0 z-30 flex w-32 shrink-0 flex-col border-r border-text-main/10 bg-canvas-bg/95 shadow-sm"></div>');function Xs(u,e){ae(e,!0);var t=Ws();_e(t,21,()=>s.project.activeFrame.layers,ke,(n,l,d)=>{var v=qs();v.__click=()=>e.onSelect(d);var c=i(v),f=i(c,!0);r(c),r(v),I(()=>{ne(v,1,`flex h-6 w-full items-center px-2 text-left transition-colors ${d===e.activeLayerIndex?"bg-ui-accent/5 text-ui-accent":"text-text-main/60 hover:bg-text-main/5"}`),E(f,a(l).name)}),p(n,v)}),r(t),p(u,t),re()}Ae(["click"]);var Zs=L('<div style="width: var(--frame-width);"><div></div></div>');function Js(u,e){ae(e,!0);let t=B(()=>e.layer?.hasContent||!1);var n=Zs();n.__click=function(...d){e.onclick?.apply(this,d)};var l=i(n);r(n),I(()=>{ne(n,1,`flex h-6 items-center justify-center border-r border-text-main/5 transition-colors ${e.isActive?"bg-ui-accent/10":"hover:bg-text-main/5"}`),ne(l,1,`h-2 w-2 rounded-full transition-all ${a(t)?"scale-110 bg-ui-accent shadow-sm":"border border-text-main/20 bg-transparent opacity-30"} ${e.isActive?"ring-4 ring-ui-accent/20":""}`)}),p(u,n),re()}Ae(["click"]);var eo=L('<div class="flex h-6 border-b border-text-main/5"></div>'),to=L('<div class="relative flex flex-1 flex-col"><!> <div class="pointer-events-none absolute top-0 bottom-0 z-20 w-px bg-ui-accent transition-all duration-75 ease-linear"><div class="absolute -top-0.5 -left-1 h-2 w-2 rotate-45 rounded-sm bg-ui-accent shadow-sm"></div></div></div>');function ao(u,e){ae(e,!0);var t=to(),n=i(t);_e(n,17,()=>s.project.activeFrame.layers,ke,(d,v,c)=>{var f=eo();_e(f,21,()=>s.project.frames,ke,(x,_,h)=>{{let g=B(()=>h===s.project.activeFrameIndex&&c===s.project.activeFrame.activeLayerIndex);Js(x,{get layer(){return a(_).layers[c]},frameIndex:h,get isActive(){return a(g)},onclick:()=>e.onSelectCell(h,c)})}}),r(f),p(d,f)});var l=o(n,2);r(t),I(()=>ue(l,`left: ${e.playheadOffset??""}px;`)),p(u,t),re()}var ro=L('<div class="h-4 shrink-0 overflow-hidden bg-text-main/5"><div class="relative h-full"></div></div>'),io=L('<div class="relative flex min-h-0 flex-1 flex-col overflow-hidden rounded border border-text-main/10 bg-sidebar-bg/30 shadow-inner"><!> <!> <div class="custom-scrollbar min-h-0 flex-1 overflow-auto svelte-1duzj14" role="grid" aria-label="The Drop Matrix"><div class="relative flex"><!> <!></div></div></div>');function so(u,e){ae(e,!0);let t=ve(void 0),n=ve(0);const l=32;let d=B(()=>l*s.studio.timelineZoom);function v(T){const $=T.target;U(n,$.scrollLeft,!0)}function c(T,$){s.project.activeFrameIndex=T,s.project.activeFrame.activeLayerIndex=$}let f=B(()=>s.project.activeFrameIndex*a(d)+a(d)/2);Ue(()=>{if(a(t)&&s.project.isPlaying){const T=a(t).clientWidth/2;a(f)>T&&(a(t).scrollLeft=a(f)-T)}});let x=B(()=>s.project.frames.length*a(d)+400),_=B(()=>{const T=[],$=s.project.fps,j=s.studio.timelineZoom,R=s.project.frames.length;let F=1;j>3?F=.1:j>2?F=.2:j>1.2&&(F=.5);const ee=Math.max(1,Math.round($*F)),Z=Math.ceil(a(x)/a(d));for(let N=0;N<Z;N++){const Y=N%ee===0,H=N%$===0,K=N%5===0,oe=N>=R;if(Y){const G=N/$,z=G%1===0?`${G}s`:`${G.toFixed(1)}s`;T.push({index:N,isMajor:H,label:z,isFuture:oe})}else K&&T.push({index:N,isMajor:!1,isFuture:oe})}return T});function h(T){const $=T.currentTarget.getBoundingClientRect(),j=T.clientX-$.left+a(n),R=Math.floor(j/a(d));R>=0&&R<s.project.frames.length&&(s.project.activeFrameIndex=R)}function g(T){if(T.ctrlKey){T.preventDefault();const $=T.deltaY>0?-.1:.1;s.studio.timelineZoom=Math.max(.5,Math.min(4,s.studio.timelineZoom+$))}}var w=io(),y=i(w);{var m=T=>{var $=ro(),j=i($);_e(j,21,()=>s.project.tags,R=>R.id,(R,F)=>{Us(R,{get tag(){return a(F)}})}),r(j),r($),I(()=>ue(j,`width: ${a(x)??""}px; margin-left: 128px; transform: translateX(-${a(n)??""}px);`)),p(T,$)};M(y,T=>{s.project.tags.length>0&&T(m)})}var k=o(y,2);Qs(k,{get rulerMarks(){return a(_)},get maxRulerWidth(){return a(x)},get currentFrameWidth(){return a(d)},get scrollLeft(){return a(n)},onScrub:h});var b=o(k,2),S=i(b),C=i(S);Xs(C,{get activeLayerIndex(){return s.project.activeFrame.activeLayerIndex},onSelect:T=>s.project.activeFrame.activeLayerIndex=T});var P=o(C,2);ao(P,{get playheadOffset(){return a(f)},onSelectCell:c}),r(S),r(b),gt(b,T=>U(t,T),()=>a(t)),r(w),I(()=>ue(S,`width: ${a(x)+128}px; min-height: 100%; --frame-width: ${a(d)??""}px;`)),$e("scroll",b,v),$e("wheel",b,g),p(u,w),re()}var oo=L('<span class="text-[10px] opacity-40"> </span>'),no=L('<span class="text-[10px] opacity-40"> </span>'),lo=L('<div role="region" aria-label="Timeline"><div class="flex items-center justify-between border-b border-text-main/5 pb-1"><div class="flex min-w-0 flex-1 items-center gap-6"><div class="flex shrink-0 items-center gap-2"><span class="text-[10px] opacity-30" aria-hidden="true">üåÄ</span> <span class="font-tiny5 text-[9px] tracking-[0.2em] text-text-main/40 uppercase"> </span></div> <!></div> <div class="flex items-center gap-4"><div class="mr-4 flex flex-col items-end"><span class="font-serif text-[7px] font-black tracking-widest text-text-main/20 uppercase"> </span> <span class="font-mono text-[9px] font-bold text-ui-accent/40"> </span></div> <div class="flex items-center gap-1 border-l border-text-main/10 pl-4"><!> <!></div></div></div> <div><!></div></div>');function co(u,e){ae(e,!0);let t=B(()=>s.studio.isTimelineMinimized?"h-12":s.studio.isTimelineMaximized?"h-[75vh]":"h-40");function n(){s.studio.isTimelineMinimized=!s.studio.isTimelineMinimized,s.studio.isTimelineMinimized&&(s.studio.isTimelineMaximized=!1)}function l(){s.studio.isTimelineMaximized=!s.studio.isTimelineMaximized,s.studio.isTimelineMaximized&&(s.studio.isTimelineMinimized=!1)}var d=lo(),v=i(d),c=i(v),f=i(c),x=o(i(f),2),_=i(x,!0);r(x),r(f);var h=o(f,2);Bs(h,{}),r(c);var g=o(c,2),w=i(g),y=i(w),m=i(y,!0);r(y);var k=o(y,2),b=i(k,!0);r(k),r(w);var S=o(w,2),C=i(S);{let j=B(()=>s.studio.isTimelineMinimized?"ui:labels.confirm":"ui:labels.minimize");fe(C,{variant:"ghost",size:"sm",onclick:n,get ariaLabel(){return a(j)},class:"h-5 w-5 !p-0",children:(R,F)=>{var ee=oo(),Z=i(ee,!0);r(ee),I(()=>E(Z,s.studio.isTimelineMinimized?"üîº":"üîΩ")),p(R,ee)},$$slots:{default:!0}})}var P=o(C,2);{let j=B(()=>s.studio.isTimelineMaximized?"ui:labels.confirm":"ui:labels.maximize");fe(P,{variant:"ghost",size:"sm",onclick:l,get ariaLabel(){return a(j)},class:"h-5 w-5 !p-0",children:(R,F)=>{var ee=no(),Z=i(ee,!0);r(ee),I(()=>E(Z,s.studio.isTimelineMaximized?"üóó":"‚è´")),p(R,ee)},$$slots:{default:!0}})}r(S),r(g),r(v);var T=o(v,2),$=i(T);so($,{}),r(T),r(d),I((j,R,F)=>{ne(d,1,`flex ${a(t)??""} w-full flex-col gap-1 overflow-hidden bg-transparent px-4 py-2 transition-all duration-300 ease-in-out`),E(_,j),E(m,R),E(b,F),ne(T,1,`flex min-h-0 flex-1 flex-col overflow-hidden ${s.studio.isTimelineMinimized?"pointer-events-none opacity-0":"opacity-100"} transition-opacity duration-300`)},[()=>A("timeline:title"),()=>A("timeline:track"),()=>A("timeline:frame_count",{replace:{count:s.project.frames.length}})]),p(u,d),re()}var vo=L('<footer class="hud-panel flex w-full flex-col border-t border-text-main/10 bg-canvas-bg p-1 svelte-4mqt4m"><!> <div class="flex h-7 w-full items-center justify-between px-4"><div class="flex items-center gap-4"><!></div> <!></div></footer>');function uo(u){var e=vo(),t=i(e);co(t,{});var n=o(t,2),l=i(n),d=i(l);Xi(d,{}),r(l);var v=o(l,2);Ds(v),r(n),r(e),p(u,e)}var po=L('<div class="absolute top-0 bottom-0 left-1/2 z-30 w-px -translate-x-1/2 border-l border-dashed border-ui-accent/50 shadow-sm"></div>'),fo=L('<div class="absolute top-1/2 right-0 left-0 z-30 h-px -translate-y-1/2 border-t border-dashed border-ui-accent/50 shadow-sm"></div>'),xo=L('<div class="absolute top-0 bottom-0 w-px -translate-x-1/2 bg-text-main/20"></div>'),go=L('<div class="absolute right-0 left-0 h-px -translate-y-1/2 bg-text-main/20"></div>'),mo=L('<div class="pointer-events-none absolute inset-0 z-20 overflow-hidden"><div class="absolute top-0 bottom-0 left-1/2 w-px -translate-x-1/2 bg-text-main/40"></div> <div class="absolute top-1/2 right-0 left-0 h-px -translate-y-1/2 bg-text-main/40"></div> <!> <!> <!> <!></div>');function ho(u,e){ae(e,!1);const t=s.studio;Ce();var n=mo(),l=o(i(n),4);{var d=_=>{var h=po();pe(3,h,()=>he),p(_,h)};M(l,_=>{(t.symmetryMode==="HORIZONTAL"||t.symmetryMode==="QUADRANT")&&_(d)})}var v=o(l,2);{var c=_=>{var h=fo();pe(3,h,()=>he),p(_,h)};M(v,_=>{(t.symmetryMode==="VERTICAL"||t.symmetryMode==="QUADRANT")&&_(c)})}var f=o(v,2);_e(f,0,()=>[-24,-16,-8,8,16,24],ke,(_,h)=>{const g=ht(()=>Nt.getGuidePosition(h,s.canvas.width));var w=me(),y=se(w);{var m=k=>{var b=xo();I(()=>ue(b,`left: ${a(g)??""}%`)),p(k,b)};M(y,k=>{a(g)>0&&a(g)<100&&k(m)})}p(_,w)});var x=o(f,2);_e(x,0,()=>[-24,-16,-8,8,16,24],ke,(_,h)=>{const g=ht(()=>Nt.getGuidePosition(h,s.canvas.height));var w=me(),y=se(w);{var m=k=>{var b=go();I(()=>ue(b,`top: ${a(g)??""}%`)),p(k,b)};M(y,k=>{a(g)>0&&a(g)<100&&k(m)})}p(_,w)}),r(n),p(u,n),re()}var _o=nt('<line stroke-dasharray="0.2, 0.2" class="marching-ants-svg svelte-jh22g1"></line>'),bo=nt('<line stroke="var(--color-ui-accent)" stroke-width="0.05" stroke-dasharray="0.1, 0.1"></line>'),Ao=nt('<circle r="0.2" fill="var(--color-ui-accent)"></circle><!>',1),yo=nt('<svg class="pointer-events-none absolute inset-0 z-40 h-full w-full overflow-visible" style="grid-column: 1 / -1; grid-row: 1 / -1;" shape-rendering="crispEdges"><defs><pattern id="ants" width="1" height="1" patternUnits="userSpaceOnUse"><line x1="0" y1="0" x2="1" y2="0" stroke="var(--ants-color)" stroke-width="0.1" stroke-dasharray="0.2, 0.2"></line></pattern></defs><!><!></svg><svg class="pointer-events-none absolute inset-0 z-[39] h-full w-full overflow-visible" style="grid-column: 1 / -1; grid-row: 1 / -1;" shape-rendering="crispEdges"><path fill="var(--color-ui-accent)" fill-opacity="0.1"></path></svg>',1);function wo(u,e){ae(e,!0);let t=B(()=>s.selection.getBoundaryEdges(s.canvas.width)),n=B(()=>s.selection.vertices),l=B(()=>et.current.type==="SELECT"),d=B(()=>s.selection.maskCount>5e3?"":s.selection.getPoints(s.canvas.width).map(x=>`M${x.x},${x.y}h1v1h-1z`).join(" "));var v=me(),c=se(v);{var f=x=>{var _=yo(),h=se(_),g=o(i(h));_e(g,17,()=>a(t),ke,(b,S)=>{var C=_o();D(C,"stroke-width",.08),I(()=>{D(C,"x1",a(S).x1),D(C,"y1",a(S).y1),D(C,"x2",a(S).x2),D(C,"y2",a(S).y2),D(C,"stroke",a(l)?"var(--color-ui-accent)":"var(--color-ui-structural)")}),p(b,C)});var w=o(g);{var y=b=>{var S=me(),C=se(S);_e(C,17,()=>a(n),ke,(P,T,$)=>{const j=B(()=>a(n)[$+1]||a(n)[0]);var R=Ao(),F=se(R),ee=o(F);{var Z=N=>{var Y=bo();I(()=>{D(Y,"x1",a(T).x+.5),D(Y,"y1",a(T).y+.5),D(Y,"x2",a(j).x+.5),D(Y,"y2",a(j).y+.5)}),p(N,Y)};M(ee,N=>{a(n).length>1&&$<a(n).length-(a(n).length>=3?0:1)&&N(Z)})}I(()=>{D(F,"cx",a(T).x+.5),D(F,"cy",a(T).y+.5)}),p(P,R)}),p(b,S)};M(w,b=>{a(n).length>0&&b(y)})}r(h);var m=o(h),k=i(m);r(m),I(()=>{D(h,"viewBox",`0 0 ${s.canvas.width??""} ${s.canvas.height??""}`),D(m,"viewBox",`0 0 ${s.canvas.width??""} ${s.canvas.height??""}`),D(k,"d",a(d))}),p(x,_)};M(c,x=>{s.selection.isActive&&x(f)})}p(u,v),re()}var ko=L('<div class="absolute flex items-center justify-center"><span class="font-mono text-[8px] font-bold text-text-main/40"> </span></div>'),Eo=L('<div class="pointer-events-none relative h-full w-full overflow-hidden bg-canvas-bg/80 backdrop-blur-sm" role="presentation"><div><div></div> <div></div> <!> <div class="absolute z-20 bg-ui-accent transition-all duration-75 ease-out"><div class="absolute top-1/2 left-1/2 rounded-sm bg-ui-accent px-1 py-0.5 shadow-sm"><span class="font-mono text-[9px] leading-none font-bold text-white"> </span></div></div></div></div>');function ca(u,e){ae(e,!0);let t=ie(e,"orientation",3,"horizontal"),n=B(()=>s.canvas.width),l=B(()=>s.canvas.height),d=B(()=>t()==="horizontal"?a(n):a(l)),v=B(()=>t()==="horizontal"?s.cursor.pos.x:s.cursor.pos.y),c=B(()=>{const T=s.studio.zoomLevel;return T<=.5?16:T<=1.5?8:T<=4?4:2}),f=B(()=>s.canvas.getFitDimension(t())),x=B(()=>s.studio.zoomLevel),_=B(()=>{const T=[];for(let $=0;$<a(d);$++){const j=Nt.toCartesianLabel($,a(d),t()==="vertical");(j%a(c)===0||$===0||$===a(d)-1)&&T.push({pos:$,label:j})}return T}),h=B(()=>{if(a(x)<=1)return t()==="horizontal"?"translate(-50%, 0)":"translate(0, -50%)";const T=(a(v)+.5)/a(d)*100;return t()==="horizontal"?`translate(-${T}%, 0)`:`translate(0, -${T}%)`});var g=Eo(),w=i(g),y=i(w),m=o(y,2),k=o(m,2);_e(k,17,()=>a(_),T=>T.pos,(T,$)=>{var j=ko(),R=i(j),F=i(R,!0);r(R),r(j),I(()=>{ue(j,`
					${t()==="horizontal"?"left":"top"}: ${a($).pos/a(d)*100}%;
					${t()==="horizontal"?"width":"height"}: ${100/a(d)}%;
					${t()==="horizontal"?"height":"width"}: 100%;
					${t()==="horizontal"?"padding-bottom: 4px;":"padding-right: 4px;"}
				`),ue(R,`transform: ${t()==="vertical"?"rotate(-90deg)":"none"};`),E(F,a($).label)}),p(T,j)});var b=o(k,2),S=i(b),C=i(S),P=i(C,!0);r(C),r(S),r(b),r(w),r(g),I(T=>{ne(w,1,`absolute flex ${t()==="vertical"?"flex-col":""}`),ue(w,`
			left: ${t()==="horizontal"?"50%":"0"};
			top: ${t()==="vertical"?"50%":"0"};
			transform: ${a(h)??""}; 
			${t()==="horizontal"?"width":"height"}: calc(${a(f)??""} * ${a(x)??""});
			${t()==="vertical"?"width":"height"}: 100%;
		`),ne(y,1,`absolute opacity-10 ${t()==="horizontal"?"right-0 bottom-0 left-0 h-1/2":"top-0 right-0 bottom-0 w-1/2"}`),ue(y,`
				background-image: linear-gradient(${t()==="horizontal"?"to right":"to bottom"}, 
					var(--color-text-main) 1px, transparent 1px);
				background-size: ${t()==="horizontal"?`calc(100% / ${a(d)}) 100%`:`100% calc(100% / ${a(d)})`};
			`),ne(m,1,`absolute opacity-20 ${t()==="horizontal"?"right-0 bottom-0 left-0 h-3/4":"top-0 right-0 bottom-0 w-3/4"}`),ue(m,`
				background-image: linear-gradient(${t()==="horizontal"?"to right":"to bottom"}, 
					var(--color-text-main) 1.5px, transparent 1.5px);
				background-size: ${t()==="horizontal"?`calc(100% / ${a(d)} * ${a(c)}) 100%`:`100% calc(100% / ${a(d)} * ${a(c)})`};
			`),ue(b,`
				${t()==="horizontal"?"left":"top"}: ${(a(v)+.5)/a(d)*100}%;
				${t()==="horizontal"?"width: 1px; top: 0; bottom: 0;":"height: 1px; left: 0; right: 0;"}
			`),ue(S,`transform: translate(-50%, -50%) ${t()==="vertical"?"rotate(-90deg)":""};`),E(P,T)},[()=>Nt.toCartesianLabel(a(v),a(d),t()==="vertical")]),p(u,g),re()}var Lo=L('<div class="absolute -top-3 -right-3 flex items-center justify-center rounded-full border-2 border-canvas-bg bg-ui-accent p-1 text-[8px] font-bold text-white shadow-lg ring-1 ring-text-main/10"><!></div>'),So=L('<div class="absolute inset-[-4px] z-0 animate-ping rounded-sm border-2 border-canvas-bg opacity-20"></div> <div class="absolute -top-10 left-1/2 z-[110] flex -translate-x-1/2 flex-col items-center"><div class="relative h-7 w-7 overflow-hidden rounded-xl rounded-br-none border-4 border-canvas-bg bg-canvas-bg shadow-xl ring-1 ring-text-main/10" style="transform: rotate(45deg);"><div class="h-full w-full -rotate-45"></div></div> <div class="-mt-0.5 h-2 w-0.5 rounded-xl bg-canvas-bg opacity-80 shadow-sm"></div></div>',1),Co=L('<div class="cursor-container absolute inset-0 svelte-1j5kr8v"><div class="cursor-bloom transition-transform duration-200 svelte-1j5kr8v"><div class="petal p-top svelte-1j5kr8v"></div> <div class="petal p-bottom svelte-1j5kr8v"></div> <div class="petal p-left svelte-1j5kr8v"></div> <div class="petal p-right svelte-1j5kr8v"></div> <div class="center-dot svelte-1j5kr8v"></div></div> <!> <!></div>');function To(u,e){ae(e,!1);const t=s.studio;Ce();var n=me(),l=se(n);{var d=v=>{var c=Co(),f=i(c),x=o(f,2);{var _=w=>{var y=Lo(),m=i(y);{var k=S=>{var C=ce("üîí");p(S,C)},b=S=>{var C=me(),P=se(C);{var T=j=>{var R=ce("‚òÄÔ∏è");p(j,R)},$=j=>{var R=me(),F=se(R);{var ee=N=>{var Y=ce("üåô");p(N,Y)},Z=N=>{var Y=me(),H=se(Y);{var K=oe=>{var G=ce("üèÅ");p(oe,G)};M(H,oe=>{t.isShadingDither&&oe(K)},!0)}p(N,Y)};M(F,N=>{t.isShadingDarken?N(ee):N(Z,!1)},!0)}p(j,R)};M(P,j=>{t.isShadingLighten?j(T):j($,!1)},!0)}p(S,C)};M(m,S=>{t.isAlphaLocked||t.isColorLocked?S(k):S(b,!1)})}r(y),pe(3,y,()=>kt),p(w,y)};M(x,w=>{(t.isAlphaLocked||t.isColorLocked||t.isShadingLighten||t.isShadingDarken||t.isShadingDither)&&w(_)})}var h=o(x,2);{var g=w=>{var y=So(),m=se(y),k=o(m,2),b=i(k),S=i(b);r(b),xe(2),r(k),I(()=>{ue(m,`background-color: ${s.activeColor??""};`),ue(S,`background-color: ${s.activeColor??""};`)}),pe(3,m,()=>he,()=>({duration:400})),pe(1,k,()=>Vt,()=>({y:-10,duration:400})),pe(2,k,()=>he,()=>({duration:400})),p(w,y)};M(h,w=>{s.isPicking&&w(g)})}r(c),I(()=>ue(f,`transform: scale(${t.brushSize??""})`)),pe(3,c,()=>he,()=>({duration:800})),p(v,c)};M(l,v=>{s.isCursorVisible&&v(d)})}p(u,n),re()}var Io=nt('<rect fill="none" stroke="var(--color-ui-accent)" stroke-width="0.1" stroke-dasharray="0.2, 0.2" class="marching-ants svelte-1msfnni"></rect>'),Po=nt('<ellipse fill="none" stroke="var(--color-ui-accent)" stroke-width="0.1" stroke-dasharray="0.2, 0.2" class="marching-ants svelte-1msfnni"></ellipse>'),jo=nt('<polyline fill="none" stroke="var(--color-ui-accent)" stroke-width="0.1" stroke-dasharray="0.2, 0.2" class="marching-ants svelte-1msfnni"></polyline><line stroke="var(--color-ui-accent)" stroke-width="0.1" stroke-dasharray="0.2, 0.2" class="marching-ants svelte-1msfnni"></line>',1),$o=nt('<svg class="pointer-events-none absolute inset-0 z-40 h-full w-full overflow-visible" preserveAspectRatio="none"><!></svg>');function Ro(u,e){ae(e,!0);var t=me(),n=se(t);{var l=d=>{const v=B(()=>s.studio.shapeAnchor),c=B(()=>s.cursor.pos),f=B(()=>Math.min(a(v).x,a(c).x)),x=B(()=>Math.min(a(v).y,a(c).y)),_=B(()=>Math.max(a(v).x,a(c).x)),h=B(()=>Math.max(a(v).y,a(c).y)),g=B(()=>a(_)-a(f)+1),w=B(()=>a(h)-a(x)+1);var y=$o(),m=i(y);{var k=S=>{var C=Io();I(()=>{D(C,"x",a(f)),D(C,"y",a(x)),D(C,"width",a(g)),D(C,"height",a(w))}),p(S,C)},b=S=>{var C=me(),P=se(C);{var T=j=>{var R=Po();I(()=>{D(R,"cx",a(f)+a(g)/2),D(R,"cy",a(x)+a(w)/2),D(R,"rx",a(g)/2),D(R,"ry",a(w)/2)}),p(j,R)},$=j=>{var R=me(),F=se(R);{var ee=Z=>{const N=B(()=>(a(v).x+a(c).x)/2),Y=B(()=>(a(v).y+a(c).y)/2),H=B(()=>Math.max(Math.abs(a(c).x-a(v).x),Math.abs(a(c).y-a(v).y))/2),K=B(()=>s.studio.polygonSides),oe=B(()=>s.studio.polygonIndentation),G=B(()=>Array.from({length:a(oe)>0?a(K)*2:a(K)}).map((J,V)=>{const te=-Math.PI/2+V*2*Math.PI/(a(oe)>0?a(K)*2:a(K)),q=a(oe)>0?V%2===0?a(H):a(H)*(1-a(oe)/100):a(H);return`${a(N)+.5+Math.cos(te)*q},${a(Y)+.5+Math.sin(te)*q}`}));var z=jo(),X=se(z),O=o(X);I((J,V,te,q,le)=>{D(X,"points",J),D(O,"x1",V),D(O,"y1",te),D(O,"x2",q),D(O,"y2",le)},[()=>a(G).join(" "),()=>a(N)+.5+Math.cos(-Math.PI/2+((a(oe)>0?a(K)*2:a(K))-1)*2*Math.PI/(a(oe)>0?a(K)*2:a(K)))*(a(oe)>0?((a(oe)>0?a(K)*2:a(K))-1)%2===0?a(H):a(H)*(1-a(oe)/100):a(H)),()=>a(Y)+.5+Math.sin(-Math.PI/2+((a(oe)>0?a(K)*2:a(K))-1)*2*Math.PI/(a(oe)>0?a(K)*2:a(K)))*(a(oe)>0?((a(oe)>0?a(K)*2:a(K))-1)%2===0?a(H):a(H)*(1-a(oe)/100):a(H)),()=>a(N)+.5+Math.cos(-Math.PI/2)*a(H),()=>a(Y)+.5+Math.sin(-Math.PI/2)*a(H)]),p(Z,z)};M(F,Z=>{s.studio.activeTool==="POLYGON"&&Z(ee)},!0)}p(j,R)};M(P,j=>{s.studio.activeTool==="ELLIPSE"?j(T):j($,!1)},!0)}p(S,C)};M(m,S=>{s.studio.activeTool==="RECTANGLE"?S(k):S(b,!1)})}r(y),I(()=>D(y,"viewBox",`0 0 ${e.w??""} ${e.h??""}`)),p(d,y)};M(n,d=>{s.studio.activeTool!=="BRUSH"&&s.studio.shapeAnchor&&d(l)})}p(u,t),re()}var Oo=L('<div class="pointer-events-none absolute inset-0 z-[5] overflow-hidden"><img class="absolute origin-top-left"/></div>');function Mo(u,e){ae(e,!1);const t=s.studio;Ce();var n=me(),l=se(n);{var d=v=>{var c=Oo(),f=i(c);r(c),I(x=>{ue(c,`opacity: ${t.underlayOpacity??""}`),D(f,"src",t.underlayImage),D(f,"alt",x),ue(f,`
                transform: translate(${t.underlayOffset.x??""}px, ${t.underlayOffset.y??""}px) scale(${t.underlayScale??""});
                image-rendering: auto;
            `)},[()=>A("workspace:underlay")]),pe(3,c,()=>he),p(v,c)};M(l,v=>{t.underlayImage&&t.isUnderlayVisible&&v(d)})}p(u,n),re()}var Do=L('<canvas class="pointer-events-none absolute inset-0 z-0 h-full w-full"></canvas>');function zo(u,e){ae(e,!0);let t=ie(e,"opacity",3,.2),n=ie(e,"tint",3,null),l=ve(null);Ue(()=>{const v=a(l)?.getContext("2d");if(!(!v||!a(l))){v.imageSmoothingEnabled=!1,v.clearRect(0,0,e.width,e.height);for(let c=0;c<e.pixels.length;c++){const f=e.pixels[c];if(f!==0){const x=n()||dt.uint32ToHex(f);v.fillStyle=x;const _=c%e.width,h=Math.floor(c/e.width);v.fillRect(_,h,1,1)}}}});var d=Do();gt(d,v=>U(l,v),()=>a(l)),I(()=>{D(d,"width",e.width),D(d,"height",e.height),ue(d,`opacity: ${t()??""}; image-rendering: pixelated;`)}),p(u,d),re()}function Fo(u,e){ae(e,!0);let t=B(()=>{if(!s.showGhostLayers)return[];const v=s.project.activeFrameIndex,c=s.project.frames,f=[];for(let x=1;x<=3;x++){const _=v-x;_>=0&&f.push({id:`past-${_}`,pixels:c[_].compositePixels,opacity:.4/x,tint:"#8d99ae"})}for(let x=1;x<=3;x++){const _=v+x;_<c.length&&f.push({id:`future-${_}`,pixels:c[_].compositePixels,opacity:.4/x,tint:"#a3b18a"})}return f});var n=me(),l=se(n);{var d=v=>{var c=me(),f=se(c);_e(f,17,()=>a(t),x=>x.id,(x,_)=>{zo(x,{get pixels(){return a(_).pixels},get width(){return e.w},get height(){return e.h},get opacity(){return a(_).opacity},get tint(){return a(_).tint}})}),p(v,c)};M(l,v=>{s.showGhostLayers&&v(d)})}p(u,n),re()}var No=nt('<polyline fill="none" stroke-linecap="round" stroke-linejoin="round"></polyline>'),Bo=nt('<svg class="pointer-events-none absolute inset-0 z-[20] h-full w-full overflow-visible" preserveAspectRatio="none"><!></svg>');function Go(u,e){ae(e,!0);let t=B(()=>ft.isSnappedState),n=B(()=>s.canvas.strokePoints.map(c=>`${c.x},${c.y}`).join(" "));var l=Bo(),d=i(l);{var v=c=>{var f=No();I(()=>{D(f,"points",a(n)),D(f,"stroke",s.paletteState.activeColor),D(f,"stroke-width",a(t)?"0.08":"0.03"),D(f,"stroke-dasharray",a(t)?"none":"0.1 0.1"),ne(f,0,`${a(t)?"drop-shadow-md":"marching-ants"} transition-all duration-300`,"svelte-zydpx5"),ue(f,`opacity: ${a(t)?"1":"0.4"}`)}),p(c,f)};M(d,c=>{s.canvas.strokePoints.length>1&&c(v)})}r(l),I(()=>D(l,"viewBox",`0 0 ${e.w??""} ${e.h??""}`)),p(u,l),re()}var Uo=L('<div class="pointer-events-none absolute inset-0 z-0 opacity-20 blur-[1px] grayscale"></div>'),Ho=L('<div class="canvas-viewport relative grid h-full w-full grid-cols-[20px_1fr] grid-rows-[20px_1fr] overflow-hidden svelte-5wsvqt"><div class="z-[30] border-r border-b border-text-main/10 bg-canvas-bg/90 backdrop-blur-md" aria-hidden="true"></div> <div class="relative z-[20] border-b border-text-main/10"><!></div> <div class="relative z-[20] border-r border-text-main/10"><!></div> <div class="relative flex flex-1 items-center justify-center overflow-hidden bg-ui-structural/[0.05]"><!> <div class="canvas-container absolute top-1/2 left-1/2 origin-center transition-transform duration-500 ease-[cubic-bezier(0.23,1,0.32,1)] svelte-5wsvqt"><div class="relative h-full w-full shadow-[0_20px_60px_rgba(0,0,0,0.12)] ring-1 ring-text-main/5 outline-none focus:ring-2 focus:ring-ui-accent" role="grid" tabindex="0"><!> <!> <!> <canvas class="pointer-events-none absolute inset-0 h-full w-full" style="image-rendering: pixelated;"></canvas> <!> <div class="pixel-grid-surface pointer-events-none absolute inset-0 z-10 h-full w-full"></div> <div class="pointer-events-none absolute inset-0 z-30 overflow-hidden"><div class="absolute transition-all duration-75 ease-out"><!></div></div> <!> <!></div></div></div></div>');function Vo(u,e){ae(e,!0);let t=ve(null),n=ve(null);Ue(()=>{if(a(t)){const H=Ze.connectCanvas(a(t));return()=>H()}});let l=B(()=>s.canvas.width),d=B(()=>s.canvas.height),v=B(()=>s.studio.isTilingEnabled),c=ve("");function f(H){if(H.ctrlKey){H.preventDefault();const K=H.deltaY>0?-.1:.1;s.studio.setZoom(K)}}Ue(()=>{if(s.canvas.version===-1)return;const K=a(n)?.getContext("2d",{alpha:!0}),oe=s.canvas.compositePixels;if(!K||!a(n))return;K.imageSmoothingEnabled=!1;const G=K.createImageData(a(l),a(d));new Uint32Array(G.data.buffer).set(oe),K.putImageData(G,0,0),a(v)&&U(c,a(n).toDataURL(),!0)});var x=Ho();$e("pointermove",ea,H=>a(t)&&ft.handleMove(H,a(t))),$e("pointerup",ea,()=>ft.handleEnd());var _=o(i(x),2),h=i(_);ca(h,{orientation:"horizontal"}),r(_);var g=o(_,2),w=i(g);ca(w,{orientation:"vertical"}),r(g);var y=o(g,2),m=i(y);{var k=H=>{var K=Uo();I((oe,G)=>ue(K,`
					background-image: url(${a(c)??""});
					background-repeat: repeat;
					background-size: ${oe??""} ${G??""};
					background-position: center;
					transform: ${s.cameraTransform??""};
				`),[()=>s.canvas.getFitDimension("horizontal"),()=>s.canvas.getFitDimension("vertical")]),pe(3,K,()=>he),p(H,K)};M(m,H=>{a(v)&&H(k)})}var b=o(m,2),S=i(b);S.__contextmenu=H=>H.preventDefault(),S.__pointerdown=H=>a(t)&&ft.handleStart(H,a(t));var C=i(S);ho(C,{});var P=o(C,2);Mo(P,{});var T=o(P,2);Fo(T,{get w(){return a(l)},get h(){return a(d)}});var $=o(T,2);gt($,H=>U(n,H),()=>a(n));var j=o($,2);Ro(j,{get w(){return a(l)},get h(){return a(d)}});var R=o(j,2),F=o(R,2),ee=i(F),Z=i(ee);To(Z,{}),r(ee),r(F);var N=o(F,2);Go(N,{get w(){return a(l)},get h(){return a(d)}});var Y=o(N,2);wo(Y,{}),r(S),gt(S,H=>U(t,H),()=>a(t)),r(b),r(y),r(x),I(H=>{ue(b,`
				transform: ${s.cameraTransform??""};
				aspect-ratio: ${a(l)??""} / ${a(d)??""};
				width: ${H??""};
			`),ue(S,`
										background-color: ${s.backgroundColor??""};
										touch-action: none;
										cursor: ${et.current.type==="PAN"?ft.isPointerDownActive?"grabbing":"grab":"crosshair"};
									`),D($,"width",a(l)),D($,"height",a(d)),ue(R,`--grid-cols: ${a(l)??""}; --grid-rows: ${a(d)??""};`),ue(ee,`
							left: ${s.cursor.pos.x/a(l)*100}%; 
							top: ${s.cursor.pos.y/a(d)*100}%; 
							width: ${100/a(l)}%; 
							height: ${100/a(d)}%;
						`)},[()=>s.canvas.getFitDimension("horizontal")]),$e("wheel",x,f),p(u,x),re()}Ae(["contextmenu","pointerdown"]);function Gt(u){return--u*u*u*u*u+1}const Yo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAYAAACAvzbMAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAveSURBVHgB7dzLb5z3dcfh886FHHEoizQpyQpl6+K6jRdB3KIN4nhhKksnRf0f2AYSZ5l2V8GLCAicdNdd0SaLchcU6MJABKMtEIgqml6QLGTErlzUUVibimXZskSJpMjhXMoRsrWi3wEZjcTnAQhv3q8lUdR8yFmcCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAdOFTyQvjf3tT+vqurPYsRs/54u/OUHP/6LYOT81eN/+teDweCZGDH9iPOvLZ89EzxwGsGDavhCMB8jZvsFKhhNv4nHfIyYWlUtBQ+kWgBAgoAAkCIgAKQICAApAgJAioAAkCIgAKQICAApAgJAioAAkCIgAKQ4pjgCvj/3wstR1f6+ZPPM1Mk4OjEbu639hSeKnr/66cdx7mfnizZRVQunP/jxK8E9+97c1xaqqnqpZHPqT56PQ48eLJnEvi/OFT1fb7ei9eThos27//qz+MkPflS06Q/6r7x2+c2F4L7yEwgAKQICQIqAAJAiIACkCAgAKQICQIqAAJAiIACkCAgAKQICQIqAAJDSCHbUman5qfrk5DMlm321sS9ONMZLJrGvXvZ8Vm9to+j5RncQB6fL7i3Va7Wp7w6+Pl+yaXS7S6ev/NNSPAQyXzNT7QPHxsbGSiYx1mxGqf7qZpTqrRZ+zdTq8bmnnyzaxGBw/LtV2ddMb3X1wpkbizeCHSMgO2z4QrD9ST1XsplpPXLnOOIo2rh0tej5ifZ4fPVLzxdtfnX5/168cu2jF0s2/XpteHxxIR4C4+2J4Z+96JjmH5x4Kk7MHY/dtvnLT4qer7XLv7F5/NgT8Xuv/VHR5ic/+NF3Gu9e+k7JpjE5eSpuxGKwY7yFBUCKgACQIiAApAgIACkCAkCKgACQIiAApAgIACkCAkCKgACQIiAApLiF9Vu8PvfCyyXPHxp75FirXnbkbnbskXhY9Dvd6F5fK9q0+rU4/rnjJZNYWV15/vV4IR4G0wdmnj8weaBo097XjlE02OpG79P1ok0Mqqi3V4smR04ej1Lvv/2/L74+eOF4yea1y28uBJ+pCu7q+0e/Pih5fmY7Bs/Ofj64d43pdowfnSna/Ncvfh5Lv16Kh8GJ7Xh+6Qt/HHtVfXoixp6YLtqMPz6z/XUzWbR54/W/icsX3yvanF4+6zXyLryFBUCKgACQIiAApAgIACkCAkCKgACQIiAApAgIACkCAkCKgACQIiAApDimyH3XW9uMzeVrRZtjU4fj0KMHizbv/PKdWLtdeOiv0NT+qfj9Y08Vbdr7JgIeRALCfTcYXvDd/igxe3TmzhHGEsPji7sdkGajGSfmjgXsBd7CAiBFQABIERAAUgQEgBQBASBFQABIERAAUgQEgBQBASBFQABIERAAUtzC2mEbvc1YuvlR0abdbMXBfQeCe7d17VZ0r68WbZ5uHoknZ2aLNq2Th4qebzabAXuFgOyw3qAfa92Nok2zXg/K9G93otT+eiti+FGgXXjxF/YSb2EBkCIgAKQICAApAgJAioAAkCIgAKQICAApAgJAioAAkCIgAKQICAApbmHBXaz94v2i5+vt8WidPBywF/gJBIAUAQEgRUAASBEQAFIEBIAUAQEgRUAASBEQAFIEBIAUAQEgRUAASHELawT0B4NY724UbZpVI5p1f327rd5uFT1fjdWjt1b2d1nVa1FrjQX3btDpRW+17PM86PWDneUVaATc7Kzf+Sgx156JqfpksLtaJw8VPT+Mx8alq0WbxnQ7xo/OBPeu89GNKNXf6AQ7y1tYAKQICAApAgJAioAAkCIgAKQICAApAgJAioAAkCIgAKQICAApAgJAiltYv01VLZQ8vtHfOv5hZ2W+ZNOqNWO6MVEyibXuZpTaPzYR9cr3DCW619eKnu93usHuu/L+cqyu3Cza1Gu1N7b/PZcf0eIzVcGO+sbsl+drUT9XsjkydiCenjgSu+3EI4djolF2XZbdt9ePKdanJ2Lsiemizb+9+S/x3tsXo9Cp08tnF4Md49tRAFIEBIAUAQEgRUAASBEQAFIEBIAUAQEgRUAASBEQAFIEBIAUAQEgxTHFHdbtti40m51XSjar3c35i+sfvlSyeWzsQPEBxqvrK9GsrxZt5tqzwb2rtcaiObu/aDM8wLi5fK1oM7yfVW8/HHfNrnywHO+/8/OizfWPry3EoH++aNTrLwU7SkB22MKNxeG1z4WSzTcPfiVudTaKAjJVGI+hte7GduGKJgJSqKpXd17cSwwv/m5eXSna3IlH2S8zslZXbsV7b/930aa/HY/XLr+5ENxX3sICIEVAAEgREABSBASAFAEBIEVAAEgREABSBASAFAEBIEVAAEgREABS3MIaAfWt/mK30ThVsrmydfPbVzorL5Zsntp3OCbr4yWTWLr5UdHzrUYzHpt4NPaq/sZWbFwq+5xVY41onTxUtBkebRxF12/diAvvvlW02ehsDo8ininZbK2tXwjuOwEZAX974z+Xtv+zVLJ5debZl6Mq+wFya9CLUncOMHLPBr1+9NY2izaN7YA8LJd1t7a24uqnHxdtoqp+dXr57GLwwPEWFgApAgJAioAAkCIgAKQICAApAgJAioAAkCIgAKQICAApAgJAioAAkFIFe8a3Zp87N4iYL9l8derzsdumxtsx156Nh0G9PR6tk4eLNt3ra7G5fK1oM350JhrT7dht//DP/xiFFk8vny06DMqDy08gAKQICAApAgJAioAAkCIgAKQICAApAgJAioAAkCIgAKQICAApAgJASiPYM/qDwVu1quz82fXu+nzJ842qHvvr4yWT4e8r1rsbRZtm1YhmffS+fAe9fvTWyv4s/U436u1WlCr9dW521mNr0ItCiyUPV1V1IdgzHFPkrl6dfW5Q8vx0YyL+cPKJ2G1z7ZmYGp+Mh8HwKOLwOGKJ4fHF4RHGEv9x7WJc27wVJU4vn/UawWfyFhYAKQICQIqAAJAiIACkCAgAKQICQIqAAJAiIACkCAgAKQICQIqAAJDimCJ3VQ1ioeT5zqB7/MPOynzJplVr3rmhVWKtuxml9o9NRL0ave+ZBp1u8V2rT1avx+r6zaJNLao3oqpuBOwQh9LYUd+Y/fJ8LernSjZHxg7E0xNHYredeORwTDTKr96Oogs3LsXy+idR6NTp5bOLATvEW1gApAgIACkCAkCKgACQIiAApAgIACkCAkCKgACQIiAApAgIACkCAkCKY4rsqG63daHZ7LxSslntbs5fXP/wpZLNY2MHig8wXl1fiWZ9tWgz156N3Xb59qdx8davizab/c5CDPrni0a9/lLADhIQdtTCjcXhtdeFks03D34lbnU2igIyVRiPobXuxnbhiia/k4Dc7N6Oi6uXizaDweD8D6/9+0LAfeQtLABSBASAFAEBIEVAAEgREABSBASAFAEBIEVAAEgREABSBASAFAEBIMUtLO67+lZ/sdtonCrZXNm6+e0rnZUXY5f9z8bV2G23e5vn+1GdKdlM9poXAu6zKuAB9OrMswtR1YoOMI6qahALf3ftp0UXjGEUeAsLgBQBASBFQABIERAAUgQEgBQBASBFQABIERAAUgQEgBQBASBFQABIcQuLPeNbs8+dG0TMxy7a/v8v/vCTnxYdhoQHlZ9AAEgREABSBASAFAEBIEVAAEgREABSBASAFAEBIEVAAEgREABSBASAlEbAHtEfDN6qVbt+/u1CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKPq/wHHEEo6B7wOjAAAAABJRU5ErkJggg==";var Ko=L('<div class="fixed inset-0 z-[2000] flex flex-col items-center justify-center bg-canvas-bg" role="dialog" aria-modal="true"><svg class="pointer-events-none absolute inset-0 h-full w-full opacity-[var(--grain-opacity,0.03)]"><filter id="grain"><feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="3" stitchTiles="stitch"></feTurbulence><feColorMatrix type="saturate" values="0"></feColorMatrix></filter><rect width="100%" height="100%" filter="url(#grain)"></rect></svg> <div class="absolute h-[500px] w-[500px] animate-pulse rounded-full bg-ui-structural/5 blur-[120px]" aria-hidden="true"></div> <div class="relative flex flex-col items-center gap-2"><div class="mb-8 flex animate-bounce items-center justify-center"><img class="h-32 w-auto drop-shadow-2xl transition-transform duration-[3s] ease-in-out"/></div> <div><!></div></div> <div class="absolute bottom-24 flex flex-col items-center gap-8"><div class="flex flex-col items-center gap-4"><div class="h-1 w-48 overflow-hidden rounded-full bg-ui-structural/5 ring-1 ring-grid-border/10" role="progressbar" aria-valuemin="0" aria-valuemax="100"><div></div></div> <div class="flex flex-col items-center gap-1 text-center"><span class="h-4 font-serif text-[11px] tracking-wide text-text-main/80 italic"> </span> <span class="font-mono text-[8px] font-bold tracking-[0.3em] text-text-main/40 uppercase"> </span></div></div></div></div>');function Qo(u,e){ae(e,!0);let t=ve(!0),n=ve(0),l=ve(0),d=ve(!1);const v=5;function c(){ge.emit("READY"),U(t,!1),setTimeout(()=>{s.isAppReady=!0,s.showManual=!0},800)}_t(()=>{try{ge.emit("STARTUP")}catch(g){console.warn("Feedback engine failed to start:",g)}const h=setInterval(()=>{if(a(n)<100){const g=Math.random()*15;U(n,Math.min(100,a(n)+g),!0),U(l,Math.min(v-1,Math.floor(a(n)/100*v)),!0)}else clearInterval(h),setTimeout(()=>{U(d,!0),c()},600)},400);return()=>{clearInterval(h)}});var f=me(),x=se(f);{var _=h=>{var g=Ko(),w=o(i(g),4),y=i(w),m=i(y);ue(m,`transform: scale(${1+Math.sin(Date.now()/1500)*.05});`),r(y);var k=o(y,2),b=i(k);ba(b,{size:"lg"}),r(k),r(w);var S=o(w,2),C=i(S),P=i(C),T=i(P);r(P);var $=o(P,2),j=i($),R=i(j,!0);r(j);var F=o(j,2),ee=i(F,!0);r(F),r($),r(C),r(S),r(g),I((Z,N,Y,H)=>{D(g,"aria-busy",!a(d)),D(g,"aria-label",Z),D(m,"src",Yo),D(m,"alt",N),D(P,"aria-valuenow",a(n)),ne(T,1,`h-full bg-text-main/40 transition-all duration-500 ease-out ${a(d)?"bg-ui-accent/60":""}`),ue(T,`width: ${a(n)??""}%`),E(R,Y),E(ee,H)},[()=>A("splash:title"),()=>A("common:app.name"),()=>a(d)?A("splash:welcome"):A(`splash:phases.${a(l)}`),()=>A("splash:version",{replace:{version:s.version}})]),pe(1,y,()=>kt,()=>({duration:1500,start:.9,easing:Gt})),pe(1,k,()=>Vt,()=>({y:15,duration:1e3,delay:400,easing:Gt})),pe(2,g,()=>he,()=>({duration:1e3})),p(h,g)};M(x,h=>{a(t)&&h(_)})}p(u,f),re()}var qo=L('<div class="flex flex-col gap-2"><div class="flex justify-between font-serif text-[10px] font-bold tracking-wider uppercase opacity-40"><div class="flex items-center gap-1.5"><span> </span> <span> </span></div> <span> </span></div> <input type="range"/></div>');function jt(u,e){ae(e,!0);let t=ie(e,"value",15),n=ie(e,"min",3,0),l=ie(e,"step",3,1),d=ie(e,"unit",3,""),v=ie(e,"isHue",3,!1);function c(C){const P=parseFloat(C.target.value);t(P),e.onchange&&e.onchange(P)}var f=qo(),x=i(f),_=i(x),h=i(_),g=i(h,!0);r(h);var w=o(h,2),y=i(w,!0);r(w),r(_);var m=o(_,2),k=i(m);r(m),r(x);var b=o(x,2);Rt(b),b.__input=c;let S;r(f),I(C=>{E(g,e.icon),E(y,e.label),E(k,`${C??""}${d()??""}`),D(b,"min",n()),D(b,"max",e.max),D(b,"step",l()),fr(b,t()),S=ne(b,1,"custom-slider svelte-d8mhf4",null,S,{"hue-slider":v()})},[()=>l()<1?t().toFixed(2):Math.round(t())]),p(u,f),re()}Ae(["input"]);var Wo=L('<span class="mt-1 font-serif text-[9px] font-black tracking-[0.2em] text-text-main/40 uppercase"> </span>'),Xo=nt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="square" class="h-4 w-4 text-text-main/40"><path d="M18 6L6 18M6 6l12 12"></path></svg>'),Zo=L('<div class="flex shrink-0 items-center justify-end gap-3 border-t-2 border-ui-structural bg-grid-border/20 px-6 py-4"><!></div>'),Jo=L('<div class="fixed inset-0 flex items-center justify-center bg-ui-structural/40 p-4 backdrop-blur-[2px] md:p-8"><div role="dialog" aria-modal="true" tabindex="-1"><div class="flex shrink-0 items-center justify-between border-b-2 border-ui-structural bg-sidebar-bg/30 px-6 py-5"><div class="flex flex-col"><h2 class="font-tiny5 text-2xl leading-none tracking-wider text-text-main"> </h2> <!></div> <!></div> <div class="custom-scrollbar flex-1 overflow-y-auto px-6 py-6"><!></div> <!></div></div>');function lt(u,e){ae(e,!0);let t=ie(e,"title",3,""),n=ie(e,"subtitle",3,""),l=ie(e,"isOpen",3,!1),d=ie(e,"width",3,"auto"),v=ie(e,"maxWidth",3,"95vw"),c=ie(e,"zIndex",3,1500),f=ie(e,"class",3,"");Ue(()=>{if(l())return s.pushEscapeAction(e.onClose),()=>s.popEscapeAction(e.onClose)}),_t(()=>{l()&&rt.playCeramicSlide()}),Ue(()=>{l()&&rt.playCeramicSlide()});var x=me(),_=se(x);{var h=g=>{var w=Jo();w.__mousedown=Z=>{Z.stopPropagation(),Z.target===Z.currentTarget&&e.onClose()};var y=i(w);y.__mousedown=Z=>Z.stopPropagation();var m=i(y),k=i(m),b=i(k),S=i(b,!0);r(b);var C=o(b,2);{var P=Z=>{var N=Wo(),Y=i(N,!0);r(N),I(H=>E(Y,H),[()=>n()?A(n()):""]),p(Z,N)};M(C,Z=>{n()&&Z(P)})}r(k);var T=o(k,2);fe(T,{variant:"ghost",size:"sm",get onclick(){return e.onClose},ariaLabel:"ui:labels.close",children:(Z,N)=>{var Y=Xo();p(Z,Y)},$$slots:{default:!0}}),r(m);var $=o(m,2),j=i($);{var R=Z=>{var N=me(),Y=se(N);je(Y,()=>e.children),p(Z,N)};M(j,Z=>{e.children&&Z(R)})}r($);var F=o($,2);{var ee=Z=>{var N=Zo(),Y=i(N);je(Y,()=>e.footer),r(N),p(Z,N)};M(F,Z=>{e.footer&&Z(ee)})}r(y),r(w),I(Z=>{ue(w,`z-index: ${c()??""};`),ne(y,1,`
                flex max-h-[90vh] flex-col overflow-hidden rounded-sm border-2
                border-ui-structural bg-canvas-bg shadow-[8px_8px_0px_var(--color-ui-structural)]
                ${f()??""}
            `),ue(y,`width: ${d()??""}; max-width: ${v()??""};`),E(S,Z)},[()=>t()?A(t()):""]),pe(3,y,()=>kt,()=>({duration:300,easing:Gt,start:.9})),pe(3,w,()=>he,()=>({duration:150})),p(g,w)};M(_,g=>{l()&&g(h)})}p(u,x),re()}Ae(["mousedown"]);var en=L('<span aria-hidden="true">üñåÔ∏è</span>'),tn=L('<div class="flex flex-col gap-8" role="presentation"><div class="flex items-center justify-between px-2"><span class="text-3xl" aria-hidden="true">üè∫</span> <div class="editor-checker-small h-16 w-32 rounded-xl border-4 border-canvas-bg shadow-lg"></div></div> <div class="flex flex-col gap-6"><!> <!> <!> <!> <!></div> <div class="flex flex-col gap-4"><!> <div class="flex gap-3"><!> <!></div></div></div>');function ia(u,e){ae(e,!0);let t=ie(e,"value",15),n=ve(0),l=ve(0),d=ve(0),v=ve(1),c=ve(0),f=ve(yt(t()));Ue(()=>{const g=dt.toHSLA(t());$t(()=>{U(n,g.h,!0),U(l,g.s,!0),U(d,g.l,!0),U(v,g.a,!0),U(c,0),a(f)!==t()&&U(f,t(),!0)})}),Ue(()=>{const g=dt.toHex({h:a(n),s:a(l),l:a(d),a:a(v)});$t(()=>{t(g),U(f,g,!0)})});function x(g){const y=g.target.value.toUpperCase();U(f,y,!0);const m=y.replace("#","");if(m.length===6||m.length===8){const k=dt.toHSLA(y);U(n,k.h,!0),U(l,k.s,!0),U(d,k.l,!0),U(v,k.a,!0),U(c,0)}}function _(g){const w=g-a(c),y=dt.toHex({h:a(n),s:a(l),l:a(d),a:a(v)}),m=dt.applyTemperature(y,w/100),k=dt.toHSLA(m);U(n,k.h,!0),U(l,k.s,!0),U(d,k.l,!0),U(c,g,!0)}Ue(()=>(s.pushEscapeAction(e.onClose),()=>s.popEscapeAction(e.onClose)));function h(g){g.key==="Enter"&&e.onClose()}lt(u,{title:"tools:color_picker.title",subtitle:"tools:color_picker.subtitle",isOpen:!0,get onClose(){return e.onClose},width:"450px",zIndex:2e3,children:(g,w)=>{var y=tn();y.__keydown=h;var m=i(y),k=o(i(m),2);r(m);var b=o(m,2),S=i(b);{let N=B(()=>A("tools:color_picker.label.hue"));jt(S,{get label(){return a(N)},icon:"üåà",max:360,unit:"¬∞",isHue:!0,get value(){return a(n)},set value(Y){U(n,Y,!0)}})}var C=o(S,2);{let N=B(()=>A("tools:color_picker.label.saturation"));jt(C,{get label(){return a(N)},icon:"üíß",max:100,unit:"%",get value(){return a(l)},set value(Y){U(l,Y,!0)}})}var P=o(C,2);{let N=B(()=>A("tools:color_picker.label.lightness"));jt(P,{get label(){return a(N)},icon:"‚òÄÔ∏è",max:100,unit:"%",get value(){return a(d)},set value(Y){U(d,Y,!0)}})}var T=o(P,2);{let N=B(()=>A("tools:color_picker.label.temperature"));jt(T,{get label(){return a(N)},icon:"üå°Ô∏è",get value(){return a(c)},onchange:_,min:-100,max:100,unit:""})}var $=o(T,2);{let N=B(()=>A("tools:color_picker.label.alpha"));jt($,{get label(){return a(N)},icon:"üå¨Ô∏è",min:0,max:1,step:.01,unit:"",get value(){return a(v)},set value(Y){U(v,Y,!0)}})}r(b);var j=o(b,2),R=i(j);Be(R,{label:"tools:color_picker.label.hex",get value(){return a(f)},oninput:x,ariaLabel:"tools:color_picker.label.hex",class:"font-mono text-lg uppercase"});var F=o(R,2),ee=i(F);fe(ee,{variant:"secondary",onclick:()=>{Q.pickColor(),e.onClose()},ariaLabel:"tools:color_picker.button.eye_dropper",class:"!h-14 !w-14 text-xl",children:(N,Y)=>{var H=en();p(N,H)},$$slots:{default:!0}});var Z=o(ee,2);fe(Z,{variant:"primary",class:"flex-1 py-4",get onclick(){return e.onClose},ariaLabel:"ui:labels.confirm",children:(N,Y)=>{xe();var H=ce();I(K=>E(H,K),[()=>A("ui:labels.confirm")]),p(N,H)},$$slots:{default:!0}}),r(F),r(j),r(y),I(N=>{ue(k,`background-color: ${t()??""};`),D(k,"aria-label",N)},[()=>A("ui:accessibility.color_preview")]),p(g,y)},$$slots:{default:!0}}),re()}Ae(["keydown"]);var an=L("<span> </span>"),rn=L('<button><span class="font-serif text-sm font-bold tracking-tight"> </span> <!></button>');function sn(u,e){ae(e,!0);var t=rn();t.__click=()=>{e.action.action(),e.onSelect()};var n=i(t),l=i(n,!0);r(n);var d=o(n,2);{var v=c=>{var f=an(),x=i(f,!0);r(f),I(()=>{ne(f,1,`font-mono text-[10px] font-bold uppercase ${e.isSelected?"text-white/60":"opacity-20"}`),E(x,e.action.shortcut)}),p(c,f)};M(d,c=>{e.action.shortcut&&c(v)})}r(t),I(c=>{ne(t,1,`editor-action-btn flex items-center justify-between rounded-xl px-6 py-4 transition-all ${e.isSelected?"active bg-ui-accent text-canvas-bg shadow-lg":"hover:bg-text-main/5"}`),E(l,c)},[()=>A(e.action.label)]),$e("mouseenter",t,function(...c){e.onSelect?.apply(this,c)}),p(u,t),re()}Ae(["click"]);var on=L('<div class="p-8 text-center font-serif text-sm text-text-main/40 italic"> </div>'),nn=L('<div class="flex flex-col gap-1"></div>'),ln=L('<div class="fixed inset-0 z-[1200] flex items-start justify-center bg-ui-structural/10 pt-[15vh] backdrop-blur-sm" role="presentation"><div class="flex w-[600px] flex-col overflow-hidden rounded-xl border border-text-main/5 bg-canvas-bg/95 shadow-2xl" role="dialog" aria-labelledby="palette-title" aria-modal="true"><div class="relative flex items-center border-b border-text-main/5 bg-canvas-bg/40 p-4"><span class="mr-2 text-2xl opacity-40" aria-hidden="true">üìñ</span> <h2 id="palette-title" class="sr-only"> </h2> <!></div> <div class="custom-scrollbar max-h-[50vh] overflow-y-auto p-4 svelte-k2yexi" role="list"><!></div> <div class="flex items-center justify-between border-t border-text-main/5 bg-text-main/5 px-8 py-4"><span class="font-serif text-[9px] font-bold tracking-[0.2em] text-text-main/30 uppercase"> </span> <span class="font-serif text-[9px] font-bold tracking-[0.2em] text-text-main/30 uppercase"> </span></div></div></div>');function cn(u,e){ae(e,!0);let t=ie(e,"onClose",3,()=>s.showCommandPalette=!1),n=ve(""),l=ve(0);const v=Ge.getActions().map(R=>({...R,id:R.intent.toLowerCase().replace(/_/g,"-"),action:()=>{Ze.handleIntent(R.intent)}}));let c=B(()=>v.filter(R=>R.label.toLowerCase().includes(a(n).toLowerCase())));Ue(()=>{a(n),U(l,0)}),Ue(()=>{a(l),a(c);const R=document.querySelector(".editor-action-btn.active");R&&R.scrollIntoView({block:"nearest"})});function f(R){R.key==="ArrowDown"?(R.preventDefault(),U(l,(a(l)+1)%a(c).length)):R.key==="ArrowUp"?(R.preventDefault(),U(l,(a(l)-1+a(c).length)%a(c).length)):R.key==="Enter"?(R.preventDefault(),a(c)[a(l)]&&(a(c)[a(l)].action(),t()())):R.key==="Escape"&&t()()}_t(()=>document.getElementById("palette-search")?.focus());var x=ln();x.__mousedown=R=>R.target===R.currentTarget&&t()(),x.__keydown=f;var _=i(x),h=i(_),g=o(i(h),2),w=i(g,!0);r(g);var y=o(g,2);Be(y,{id:"palette-search",placeholder:"workspace:hud.menu.catalog_search",ariaLabel:"workspace:hud.menu.catalog_search",class:"flex-1 !border-none !bg-transparent text-xl !shadow-none",get value(){return a(n)},set value(R){U(n,R,!0)}}),r(h);var m=o(h,2),k=i(m);{var b=R=>{var F=on(),ee=i(F,!0);r(F),I(Z=>E(ee,Z),[()=>A("workspace:hud.menu.catalog_no_results",{replace:{query:a(n)}})]),p(R,F)},S=R=>{var F=nn();_e(F,21,()=>a(c),ke,(ee,Z,N)=>{{let Y=B(()=>a(l)===N);sn(ee,{get action(){return a(Z)},get isSelected(){return a(Y)},onSelect:()=>U(l,N,!0)})}}),r(F),p(R,F)};M(k,R=>{a(c).length===0?R(b):R(S,!1)})}r(m);var C=o(m,2),P=i(C),T=i(P,!0);r(P);var $=o(P,2),j=i($,!0);r($),r(C),r(_),r(x),I((R,F,ee)=>{E(w,R),E(T,F),E(j,ee)},[()=>A("workspace:hud.menu.catalog_title"),()=>A("workspace:hud.menu.catalog_footer"),()=>A("workspace:hud.menu.catalog_count",{replace:{count:a(c).length}})]),pe(3,_,()=>kt,()=>({duration:150,start:.98})),p(u,x),re()}Ae(["mousedown","keydown"]);var dn=L('<div class="flex items-center justify-between px-1"><span class="text-[10px] font-bold tracking-widest text-text-main/70 uppercase"> </span> <span class="font-mono text-[10px] text-text-main/90"> </span></div>'),vn=L(`<div><!> <div class="
            h-3 w-full overflow-hidden rounded-sm border-2 border-ui-structural
            bg-grid-border shadow-[2px_2px_0px_var(--color-ui-structural)]
        "><div class="
                h-full border-r-2 border-ui-structural bg-ui-accent
                transition-all duration-300 ease-in-out
            "></div></div></div>`);function un(u,e){let t=ie(e,"value",3,0),n=ie(e,"max",3,100),l=ie(e,"class",3,"");const d=B(()=>Math.min(Math.max(t()/n()*100,0),100));var v=vn(),c=i(v);{var f=h=>{var g=dn(),w=i(g),y=i(w,!0);r(w);var m=o(w,2),k=i(m);r(m),r(g),I(b=>{E(y,e.label),E(k,`${b??""}%`)},[()=>Math.round(a(d))]),p(h,g)};M(c,h=>{e.label&&h(f)})}var x=o(c,2),_=i(x);r(x),r(v),I(()=>{ne(v,1,`flex w-full flex-col gap-1.5 ${l()??""}`),ue(_,`width: ${a(d)??""}%`)}),p(u,v)}var pn=L('<div class="text-2xl"><!></div>'),fn=L('<button type="button" role="radio"><!> <div class="text-center"><h3 class="font-serif text-[10px] font-bold tracking-tight uppercase"> </h3></div></button>');function da(u,e){ae(e,!0);let t=ie(e,"disabled",3,!1),n=ie(e,"class",3,"");var l=fn();l.__click=()=>e.onclick(e.id);var d=i(l);{var v=_=>{var h=pn(),g=i(h);{var w=m=>{var k=ce();I(()=>E(k,e.icon)),p(m,k)},y=m=>{var k=me(),b=se(k);je(b,()=>e.icon),p(m,k)};M(g,m=>{typeof e.icon=="string"?m(w):m(y,!1)})}r(h),p(_,h)};M(d,_=>{e.icon&&_(v)})}var c=o(d,2),f=i(c),x=i(f,!0);r(f),r(c),r(l),I(_=>{D(l,"aria-checked",e.isSelected),l.disabled=t(),ne(l,1,`
        flex flex-col items-center gap-3 rounded-xl border-2 p-4 transition-all
        disabled:cursor-not-allowed disabled:opacity-20
        		${e.isSelected?"border-ui-accent bg-ui-accent/5 text-ui-accent":"border-text-main/5 bg-text-main/[0.05] text-text-main/40 hover:bg-text-main/10 hover:text-text-main/70 hover:opacity-100"}        ${n()??""}
    `),E(x,_)},[()=>A(e.label)]),p(u,l),re()}Ae(["click"]);var xn=L('<div class="flex flex-col items-center gap-3"><div class="editor-checker-small flex items-center justify-center overflow-hidden rounded-xl border-4 border-ui-structural bg-text-main/5 p-2 shadow-inner"><canvas class="rounded-sm shadow-sm"></canvas></div> <div class="flex flex-col items-center gap-1 text-center"><span class="font-tiny5 text-[10px] tracking-widest text-ui-accent uppercase"> </span> <span class="font-mono text-[8px] font-bold tracking-tighter opacity-30"> </span></div></div>');function gn(u,e){ae(e,!0);let t=ve(null);Ue(()=>{if(!a(t))return;const h=a(t).getContext("2d");if(!h)return;const g=s.canvas.width,w=s.canvas.height,y=s.canvas.compositePixels,m=s.studio.includePixelBorders,k=400,b=Math.min(k/g,k/w);a(t).width=g*b,a(t).height=w*b,h.imageSmoothingEnabled=!1,e.bgColor==="transparent"?h.clearRect(0,0,a(t).width,a(t).height):(h.fillStyle=e.bgColor,h.fillRect(0,0,a(t).width,a(t).height)),y.forEach((S,C)=>{if(S===0)return;const P=dt.uint32ToHex(S),T=C%g,$=Math.floor(C/g),j=Math.floor(T*b),R=Math.floor($*b),F=Math.ceil(b),ee=Math.ceil(b);h.fillStyle=P,h.fillRect(j,R,F,ee),m&&(h.strokeStyle="rgba(0, 0, 0, 0.15)",h.lineWidth=1,h.strokeRect(j+.5,R+.5,F-1,ee-1))})});var n=xn(),l=i(n),d=i(l);gt(d,h=>U(t,h),()=>a(t)),r(l);var v=o(l,2),c=i(v),f=i(c,!0);r(c);var x=o(c,2),_=i(x,!0);r(x),r(v),r(n),I((h,g)=>{E(f,h),E(_,g)},[()=>A("export:file_label",{replace:{format:e.format}}),()=>A("export:dimensions_label",{replace:{width:Math.round(s.canvas.width*e.scale),height:Math.round(s.canvas.height*e.scale)}})]),p(u,n),re()}var mn=L('<button role="radio"><span class="font-serif text-[9px] font-bold tracking-tight uppercase"> <!></span></button>'),hn=L('<div class="flex flex-col gap-3"><div role="radiogroup"></div> <div><div class="flex flex-col gap-1"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/60 uppercase"> </span> <span class="font-serif text-[9px] text-text-main/40"> </span></div> <div class="grid grid-cols-2 gap-2" role="radiogroup"></div></div></div>'),_n=L('<div class="rounded-xl border border-ui-accent/20 bg-ui-accent/5 p-4 text-center"><span class="font-serif text-xs font-bold text-ui-accent italic"> </span></div>'),bn=L('<div class="flex flex-col gap-3"><!> <div role="radiogroup"></div> <!></div>'),An=L('<span aria-hidden="true">üé®</span> ',1),yn=L('<span class="animate-spin text-2xl">‚è≥</span> <span> </span>',1),wn=L("<span> </span>"),kn=L('<div class="flex h-[75vh] flex-col items-start gap-12 overflow-hidden lg:flex-row"><div class="custom-scrollbar flex w-full shrink-0 flex-col gap-4 overflow-y-auto lg:h-full lg:w-[420px]"><div class="flex aspect-square w-full items-center justify-center rounded-2xl bg-text-main/5 p-6 ring-1 ring-text-main/5" role="img"><!></div> <div class="hidden flex-1 flex-col justify-end gap-2 lg:flex"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/40 uppercase"> </span> <p class="font-serif text-[9px] leading-relaxed text-text-main/30 italic"> </p></div></div> <div class="custom-scrollbar flex h-full flex-1 flex-col gap-6 overflow-y-auto pr-4"><!> <!> <div><!> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <div class="flex items-center justify-between"><div class="flex flex-col gap-1"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/60 uppercase"> </span> <span class="font-serif text-[9px] text-text-main/40"> </span></div> <!></div> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <div class="flex flex-col gap-4"><div class="flex flex-col gap-1"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/60 uppercase"> </span> <span class="font-serif text-[9px] text-text-main/40"> </span></div> <div class="flex flex-wrap items-center gap-3" role="radiogroup"><button style="background: repeating-conic-gradient(#dad7cd 0% 25%, #fff 0% 50%) 50% / 10px 10px;" role="radio"></button> <button role="radio"></button> <button role="radio"></button> <div class="flex items-center gap-2"><button role="radio"></button></div></div> <!></div></div> <div class="flex flex-col gap-3"><!> <!></div></div></div>'),En=L("<!> <!>",1);function Ln(u,e){ae(e,!0);let t=ie(e,"onClose",3,()=>s.showExportMenu=!1),n=ve("image"),l=ve("png"),d=ve(!1),v=ve(!1),c=ve(!1),f=ve(yt(s.backgroundColor)),x=B(()=>s.project.frames.length>1);function _(P){a(c)||(U(n,P,!0),P==="image"?U(l,"png"):a(x)?U(l,"gif"):(U(n,"image"),U(l,"png")))}function h(){if(a(c)){s.studio.show(A("ui:studio.wait_brewing"));return}t()()}async function g(){if(a(c))return;if((["webm","gif","mp4"].includes(a(l))||a(l)==="svg"&&a(n)==="video")&&!a(x)){s.studio.show(A("export:status.requires_frames"));return}U(c,!0);try{await e.onExport(a(l),s.studio.exportScale,s.studio.exportBgColor)}finally{U(c,!1)}}_t(()=>{s.backgroundColor!=="#fdf6e3"&&(s.studio.exportBgColor=s.backgroundColor,U(f,s.backgroundColor,!0),U(v,!0))}),Ue(()=>{a(v)&&(s.studio.exportBgColor=a(f))});const w=B(()=>[{id:"image",label:"export:tabs.image"},{id:"video",label:"export:tabs.video",disabled:!a(x)}]),y=[{id:"png",label:"export:format.png",icon:"üñºÔ∏è"},{id:"webp",label:"export:format.webp",icon:"üï∏Ô∏è"},{id:"jpg",label:"export:format.jpg",icon:"üì∑"},{id:"svg",label:"export:format.svg_static",icon:"üìê"}],m=[{id:"gif",label:"export:format.gif",icon:"üéÄ"},{id:"webm",label:"export:format.webm",icon:"üé¨"},{id:"mp4",label:"export:format.mp4",icon:"üìΩÔ∏è"},{id:"svg",label:"export:format.svg_kinetic",icon:"üìê"}];var k=En(),b=se(k);{var S=P=>{ia(P,{onClose:()=>U(d,!1),get value(){return a(f)},set value(T){U(f,T,!0)}})};M(b,P=>{a(d)&&P(S)})}var C=o(b,2);lt(C,{title:"export:title",subtitle:"export:subtitle",isOpen:!0,onClose:h,width:"1000px",children:(P,T)=>{var $=kn(),j=i($),R=i(j),F=i(R);gn(F,{get format(){return a(l)},get scale(){return s.studio.exportScale},get bgColor(){return s.studio.exportBgColor}}),r(R);var ee=o(R,2),Z=i(ee),N=i(Z,!0);r(Z);var Y=o(Z,2),H=i(Y);r(Y),r(ee),r(j);var K=o(j,2),oe=i(K);{let ye=B(()=>a(c)?"pointer-events-none opacity-50":"");ya(oe,{get tabs(){return a(w)},ariaLabel:"export:settings_label",onchange:_,get class(){return a(ye)},get activeTab(){return a(n)},set activeTab(Me){U(n,Me,!0)}})}var G=o(oe,2);{var z=ye=>{var Me=hn(),We=i(Me);_e(We,21,()=>y,ke,(Pe,Se)=>{{let Tt=B(()=>a(l)===a(Se).id);da(Pe,{get id(){return a(Se).id},get label(){return a(Se).label},get icon(){return a(Se).icon},get isSelected(){return a(Tt)},onclick:ct=>U(l,ct,!0),get disabled(){return a(c)}})}}),r(We);var Ye=o(We,2),Fe=i(Ye),Xe=i(Fe),Ke=i(Xe,!0);r(Xe);var we=o(Xe,2),De=i(we,!0);r(we),r(Fe);var Ie=o(Fe,2);_e(Ie,20,()=>["ACTIVE","VISIBLE","SELECTED","ALL","SELECTED_LAYERS"],ke,(Pe,Se)=>{const Tt=B(()=>Se==="ACTIVE"?1:Se==="VISIBLE"?s.project.frames.filter(ut=>ut.isVisible).length:Se==="SELECTED"?s.project.selectedFrameIndices.size:Se==="SELECTED_LAYERS"?s.project.activeFrame.selectedLayerIndices.size:s.project.frames.length);var ct=mn();ct.__click=()=>s.studio.exportFrameSelection=Se;var Dt=i(ct),zt=i(Dt),Qt=o(zt);{var qt=ut=>{var Ft=ce();I(()=>E(Ft,`(${a(Tt)??""})`)),p(ut,Ft)};M(Qt,ut=>{Se!=="ACTIVE"&&ut(qt)})}r(Dt),r(ct),I(ut=>{ne(ct,1,`rounded-lg border px-2 py-2 text-center transition-all ${s.studio.exportFrameSelection===Se?"border-ui-accent bg-white text-ui-accent shadow-sm":"border-transparent bg-white/20 text-text-main/50 hover:bg-white/40"}`),D(ct,"aria-checked",s.studio.exportFrameSelection===Se),E(zt,`${ut??""} `)},[()=>A(`export:selection.${Se.toLowerCase()}`)]),p(Pe,ct)}),r(Ie),r(Ye),r(Me),I((Pe,Se)=>{ne(We,1,`grid grid-cols-2 gap-3 ${a(c)?"pointer-events-none opacity-50":""}`),ne(Ye,1,`mt-2 flex flex-col gap-4 rounded-xl border border-text-main/5 bg-text-main/5 p-4 ${a(c)?"pointer-events-none opacity-50":""}`),E(Ke,Pe),E(De,Se)},[()=>A("export:label.selection"),()=>A("export:description.selection")]),pe(3,Me,()=>he,()=>({duration:150})),p(ye,Me)},X=ye=>{var Me=bn(),We=i(Me);{var Ye=Ke=>{var we=_n(),De=i(we),Ie=i(De,!0);r(De),r(we),I(Pe=>E(Ie,Pe),[()=>A("export:status.requires_frames")]),p(Ke,we)};M(We,Ke=>{a(x)||Ke(Ye)})}var Fe=o(We,2);_e(Fe,21,()=>m,ke,(Ke,we)=>{{let De=B(()=>a(l)===a(we).id),Ie=B(()=>!a(x)||a(c));da(Ke,{get id(){return a(we).id},get label(){return a(we).label},get icon(){return a(we).icon},get isSelected(){return a(De)},onclick:Pe=>U(l,Pe,!0),get disabled(){return a(Ie)}})}}),r(Fe);var Xe=o(Fe,2);{let Ke=B(()=>a(c)?"pointer-events-none opacity-50":"");Be(Xe,{label:"export:label.fps",type:"number",min:1,max:60,ariaLabel:"export:label.fps",get class(){return a(Ke)},get value(){return s.project.fps},set value(we){s.project.fps=we}})}r(Me),I(()=>ne(Fe,1,`grid grid-cols-2 gap-3 ${!a(x)||a(c)?"pointer-events-none opacity-40":""}`)),pe(3,Me,()=>he,()=>({duration:150})),p(ye,Me)};M(G,ye=>{a(n)==="image"?ye(z):ye(X,!1)})}var O=o(G,2),J=i(O);Be(J,{label:"export:label.scale",type:"number",min:1,max:100,ariaLabel:"export:label.scale",get value(){return s.studio.exportScale},set value(ye){s.studio.exportScale=ye}});var V=o(J,4),te=i(V),q=i(te),le=i(q,!0);r(q);var Le=o(q,2),Ee=i(Le,!0);r(Le),r(te);var W=o(te,2);Yt(W,{ariaLabel:"export:label.borders",get checked(){return s.studio.includePixelBorders},set checked(ye){s.studio.includePixelBorders=ye}}),r(V);var be=o(V,4),Re=i(be),Oe=i(Re),Te=i(Oe,!0);r(Oe);var Qe=o(Oe,2),He=i(Qe,!0);r(Qe),r(Re);var Ve=o(Re,2),it=i(Ve);it.__click=()=>{s.studio.exportBgColor="transparent",U(v,!1)};var qe=o(it,2);qe.__click=()=>{s.studio.exportBgColor="#fdf6e3",U(v,!1)};var vt=o(qe,2);vt.__click=()=>{s.studio.exportBgColor="#333d29",U(v,!1)};var Et=o(vt,2),xt=i(Et);xt.__click=()=>{U(v,!0),s.studio.exportBgColor=a(f),U(d,!0)},r(Et),r(Ve);var Lt=o(Ve,2);{var Kt=ye=>{fe(ye,{variant:"ghost",size:"sm",onclick:()=>{U(f,s.backgroundColor,!0),s.studio.exportBgColor=a(f)},ariaLabel:"export:background.match_canvas",class:"flex items-center gap-2 !p-0 text-ui-accent opacity-60 hover:opacity-100",children:(Me,We)=>{var Ye=An(),Fe=o(se(Ye));I(Xe=>E(Fe,` ${Xe??""}`),[()=>A("export:background.match_canvas")]),p(Me,Ye)},$$slots:{default:!0}})};M(Lt,ye=>{s.backgroundColor!=="#fdf6e3"&&ye(Kt)})}r(be),r(O);var St=o(O,2),Ot=i(St);{var Mt=ye=>{un(ye,{label:"export:status.progress",get value(){return s.studio.exportProgress},class:"mb-2"})};M(Ot,ye=>{a(c)&&ye(Mt)})}var Ct=o(Ot,2);{let ye=B(()=>a(c)||a(n)==="video"&&!a(x));fe(Ct,{variant:"primary",class:"w-full py-5 text-xl",onclick:g,get disabled(){return a(ye)},ariaLabel:"export:button.submit",children:(Me,We)=>{var Ye=me(),Fe=se(Ye);{var Xe=we=>{var De=yn(),Ie=o(se(De),2),Pe=i(Ie,!0);r(Ie),I(Se=>E(Pe,Se),[()=>A("export:status.brewing")]),p(we,De)},Ke=we=>{var De=wn(),Ie=i(De,!0);r(De),I(Pe=>E(Ie,Pe),[()=>A("export:button.submit")]),p(we,De)};M(Fe,we=>{a(c)?we(Xe):we(Ke,!1)})}p(Me,Ye)},$$slots:{default:!0}})}r(St),r(K),r($),I((ye,Me,We,Ye,Fe,Xe,Ke,we,De,Ie,Pe,Se)=>{D(R,"aria-label",ye),E(N,Me),E(H,`${We??""} & ${Ye??""}`),ne(O,1,`flex flex-col gap-5 rounded-xl border border-text-main/5 bg-text-main/[0.05] p-6 ${a(c)?"pointer-events-none opacity-50":""}`),E(le,Fe),E(Ee,Xe),E(Te,Ke),E(He,we),ne(it,1,`h-10 w-10 rounded-xl border-2 ${s.studio.exportBgColor==="transparent"?"border-ui-accent":"border-text-main/5"}`),D(it,"title",De),D(it,"aria-checked",s.studio.exportBgColor==="transparent"),ne(qe,1,`h-10 w-10 rounded-xl border-2 ${s.studio.exportBgColor==="#fdf6e3"?"border-ui-accent":"border-text-main/5"} bg-[#fdf6e3]`),D(qe,"title",Ie),D(qe,"aria-checked",s.studio.exportBgColor==="#fdf6e3"),ne(vt,1,`h-10 w-10 rounded-xl border-2 ${s.studio.exportBgColor==="#333d29"?"border-ui-accent":"border-text-main/5"} bg-[#333d29]`),D(vt,"title",Pe),D(vt,"aria-checked",s.studio.exportBgColor==="#333d29"),ne(xt,1,`h-10 w-16 rounded-xl border-2 ${a(v)?"border-ui-accent":"border-text-main/5"} editor-checker-small transition-transform hover:scale-105`),ue(xt,`background-color: ${a(f)??""};`),D(xt,"title",Se),D(xt,"aria-checked",a(v))},[()=>A("export:preview_label"),()=>A("export:preview_label"),()=>A("export:description.scale"),()=>A("export:description.background"),()=>A("export:label.borders"),()=>A("export:description.borders"),()=>A("export:label.background"),()=>A("export:description.background"),()=>A("export:background.transparent"),()=>A("export:background.cream"),()=>A("export:background.black"),()=>A("export:background.custom")]),p(P,$)},$$slots:{default:!0}}),p(u,k),re()}Ae(["click"]);var Sn=L('<span class="text-lg opacity-40">‚úï</span>'),Cn=L('<div class="bg-hud-shadow/20 fixed inset-0 z-[1000] backdrop-blur-[1px]"></div> <div role="dialog" aria-modal="true"><div class="flex items-center justify-between border-b border-ui-structural/10 px-6 py-4"><h2 class="font-tiny5 text-xl tracking-wider text-text-main uppercase"> </h2> <!></div> <div class="custom-scrollbar flex-1 overflow-y-auto p-6"><!></div></div>',1);function ka(u,e){ae(e,!0);let t=ie(e,"title",3,""),n=ie(e,"isOpen",3,!1),l=ie(e,"width",3,"320px"),d=ie(e,"class",3,"");Ue(()=>{if(n())return s.pushEscapeAction(e.onClose),()=>s.popEscapeAction(e.onClose)}),Ue(()=>{n()&&rt.playPaperFlip()});var v=me(),c=se(v);{var f=x=>{var _=Cn(),h=se(_);h.__click=function(...P){e.onClose?.apply(this,P)};var g=o(h,2),w=i(g),y=i(w),m=i(y,!0);r(y);var k=o(y,2);fe(k,{variant:"ghost",size:"sm",get onclick(){return e.onClose},ariaLabel:"ui:labels.close",children:(P,T)=>{var $=Sn();p(P,$)},$$slots:{default:!0}}),r(w);var b=o(w,2),S=i(b);{var C=P=>{var T=me(),$=se(T);je($,()=>e.children),p(P,T)};M(S,P=>{e.children&&P(C)})}r(b),r(g),I((P,T)=>{ne(g,1,`
            fixed top-0 right-0 z-[1001] flex
            h-full flex-col border-l-2 border-ui-structural
            bg-canvas-bg shadow-[-8px_0px_0px_rgba(0,0,0,0.05)]
            ${d()??""}
        `),ue(g,`width: ${l()??""};`),D(g,"aria-label",P),E(m,T)},[()=>t()||A("ui:accessibility.drawer"),()=>t()?A(t()):""]),pe(3,h,()=>he,()=>({duration:200})),pe(3,g,()=>Vt,()=>({x:400,duration:400,easing:Gt})),p(x,_)};M(c,x=>{n()&&x(f)})}p(u,v),re()}Ae(["click"]);var Tn=L('<div class="flex items-center justify-between"><span class="font-serif text-sm text-text-main/80"> </span> <kbd class="rounded border border-ui-structural/20 bg-canvas-bg px-2 py-1 font-mono text-[10px] font-bold text-ui-structural shadow-sm ring-1 ring-ui-structural/10"> </kbd></div>');function In(u,e){ae(e,!0);var t=Tn(),n=i(t),l=i(n,!0);r(n);var d=o(n,2),v=i(d,!0);r(d),r(t),I((c,f)=>{E(l,c),E(v,f)},[()=>A(e.label),()=>e.customKey||Ge.getLabel(e.intent)]),p(u,t),re()}var Pn=L('<div class="flex flex-col gap-4"><h3 class="border-b border-text-main/10 pb-2 font-serif text-sm font-bold tracking-[0.2em] text-text-main/60 uppercase"> </h3> <div class="grid grid-cols-2 gap-x-12 gap-y-4"></div></div>');function jn(u,e){ae(e,!0);var t=Pn(),n=i(t),l=i(n,!0);r(n);var d=o(n,2);_e(d,21,()=>e.group.items,ke,(v,c)=>{In(v,{get intent(){return a(c).intent},get label(){return a(c).label},get customKey(){return a(c).customKey}})}),r(d),r(t),I(v=>E(l,v),[()=>A(e.group.group)]),p(u,t),re()}var $n=L('<div class="flex flex-col"><span class="font-tiny5 text-[10px] text-ui-accent uppercase"> </span> <span class="font-serif text-[10px] text-text-main/40 italic"> </span></div>'),Rn=L('<div class="flex flex-col gap-12"><header class="flex flex-col gap-2 rounded-xl bg-ui-structural/5 p-6 ring-1 ring-ui-structural/10" aria-labelledby="guide-header-title"><h3 id="guide-header-title" class="font-tiny5 text-xl text-text-main uppercase"> </h3> <p class="font-serif text-xs leading-relaxed text-text-main/60"> </p> <div class="mt-4 grid grid-cols-3 gap-4 border-t border-text-main/5 pt-4"></div></header> <div class="grid grid-cols-2 gap-x-16 gap-y-12 px-2"></div> <footer class="mt-4 border-t border-text-main/5 pt-8 text-center"><p class="font-serif text-[11px] text-text-main/40 italic"> </p></footer></div>');function On(u,e){ae(e,!0);let t=ie(e,"onClose",3,()=>s.showShortcuts=!1);const n=B(()=>Ge.getGroupedActions());ka(u,{title:"shortcuts:title",isOpen:!0,get onClose(){return t()},width:"1000px",children:(l,d)=>{var v=Rn(),c=i(v),f=i(c),x=i(f,!0);r(f);var _=o(f,2),h=i(_,!0);r(_);var g=o(_,2);_e(g,20,()=>[["Frame","Frame"],["Layer","Layer"],["Color","Color"],["Tool","Tool"],["Paint","Paint"],["Delete","Delete"]],ke,(b,S)=>{var C=B(()=>er(S,2));let P=()=>a(C)[0],T=()=>a(C)[1];var $=$n(),j=i($),R=i(j,!0);r(j);var F=o(j,2),ee=i(F,!0);r(F),r($),I(Z=>{E(R,P()),E(ee,Z)},[()=>A("shortcuts:glossary_meaning",{replace:{tech:T()}})]),p(b,$)}),r(g),r(c);var w=o(c,2);_e(w,21,()=>a(n),ke,(b,S)=>{jn(b,{get group(){return a(S)}})}),r(w);var y=o(w,2),m=i(y),k=i(m);r(m),r(y),r(v),I((b,S,C)=>{E(x,b),E(h,S),E(k,`"${C??""}"`)},[()=>A("shortcuts:header_title"),()=>A("shortcuts:header_desc"),()=>A("shortcuts:footer_quote")]),p(l,v)},$$slots:{default:!0}}),re()}var Mn=L('<div class="flex flex-col gap-6"><div class="rounded-xl border border-text-main/5 bg-text-main/[0.05] p-6"><h3 class="mb-2 font-serif text-sm font-bold tracking-tight text-text-main/60 uppercase">Project File (.rupa)</h3> <p class="font-serif text-sm leading-relaxed text-text-main/50"> </p></div> <div class="flex flex-col gap-3"><!> <!></div></div>');function Dn(u,e){ae(e,!0);let t=ie(e,"onClose",3,()=>s.showPersistenceMenu=!1);lt(u,{title:"actions:save",subtitle:"workspace:project.saved",isOpen:!0,get onClose(){return t()},width:"400px",children:(n,l)=>{var d=Mn(),v=i(d),c=o(i(v),2),f=i(c,!0);r(c),r(v);var x=o(v,2),_=i(x);fe(_,{variant:"primary",class:"w-full py-4",onclick:()=>{Q.persistence.save(),t()()},ariaLabel:"actions:save",children:(g,w)=>{xe();var y=ce();I(m=>E(y,m),[()=>A("actions:save")]),p(g,y)},$$slots:{default:!0}});var h=o(_,2);fe(h,{variant:"secondary",class:"w-full py-4",onclick:()=>{Q.persistence.load(),t()()},ariaLabel:"actions:open",children:(g,w)=>{xe();var y=ce();I(m=>E(y,m),[()=>A("actions:open")]),p(g,y)},$$slots:{default:!0}}),r(x),r(d),I(g=>E(f,g),[()=>A("generic:loading")]),p(n,d)},$$slots:{default:!0}}),re()}var zn=L('<div class="flex flex-col gap-8"><div class="flex flex-col gap-6 rounded-xl border border-text-main/5 bg-text-main/[0.05] p-8"><div class="grid grid-cols-2 gap-8"><!> <!></div> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <!> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <!> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <div class="flex items-center justify-between"><div class="flex flex-col gap-1"><span class="font-serif text-sm font-bold tracking-tight text-text-main/60 uppercase"> </span> <span class="font-serif text-[10px] text-text-main/40"> </span></div> <button class="group relative flex items-center gap-3"><div class="editor-checker-small h-10 w-16 rounded-xl border-2 border-canvas-bg shadow-sm transition-transform group-hover:scale-105"></div> <div class="absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-ui-accent text-[8px] text-white opacity-0 transition-opacity group-hover:opacity-100">üé®</div></button></div> <p class="font-serif text-[10px] leading-relaxed text-text-main/40 italic"> </p></div> <!></div>'),Fn=L("<!> <!>",1);function Nn(u,e){ae(e,!0);let t=ie(e,"onClose",3,()=>s.showCanvasSettings=!1),n=ve(yt(s.canvas.width)),l=ve(yt(s.canvas.height)),d=ve(!1);function v(){Q.manipulation.resize(a(n),a(l)),t()()}var c=Fn(),f=se(c);lt(f,{title:"workspace:settings.title",subtitle:"workspace:settings.subtitle",isOpen:!0,get onClose(){return t()},width:"450px",children:(h,g)=>{var w=zn(),y=i(w),m=i(y),k=i(m);Be(k,{label:"workspace:settings.width",type:"number",ariaLabel:"workspace:settings.width",get value(){return a(n)},set value(K){U(n,K,!0)}});var b=o(k,2);Be(b,{label:"workspace:settings.height",type:"number",ariaLabel:"workspace:settings.height",get value(){return a(l)},set value(K){U(l,K,!0)}}),r(m);var S=o(m,4);ot(S,{label:"workspace:settings.stabilization",min:0,max:100,ariaLabel:"workspace:settings.stabilization",get value(){return s.studio.stabilization},set value(K){s.studio.stabilization=K}});var C=o(S,4);Be(C,{label:"workspace:settings.fps_label",type:"number",min:1,max:60,ariaLabel:"workspace:settings.fps_label",class:"w-24",get value(){return s.project.fps},set value(K){s.project.fps=K}});var P=o(C,4),T=i(P),$=i(T),j=i($,!0);r($);var R=o($,2),F=i(R,!0);r(R),r(T);var ee=o(T,2);ee.__click=()=>U(d,!0);var Z=i(ee);xe(2),r(ee),r(P);var N=o(P,2),Y=i(N,!0);r(N),r(y);var H=o(y,2);fe(H,{variant:"primary",class:"w-full py-4 text-lg",onclick:v,ariaLabel:"workspace:settings.apply",children:(K,oe)=>{xe();var G=ce();I(z=>E(G,z),[()=>A("workspace:settings.apply")]),p(K,G)},$$slots:{default:!0}}),r(w),I((K,oe,G,z)=>{E(j,K),E(F,oe),D(ee,"aria-label",G),ue(Z,`background-color: ${s.backgroundColor??""};`),E(Y,z)},[()=>A("workspace:settings.background_label"),()=>A("workspace:settings.background_desc"),()=>A("actions:pick_color"),()=>A("workspace:settings.note")]),p(h,w)},$$slots:{default:!0}});var x=o(f,2);{var _=h=>{ia(h,{onClose:()=>U(d,!1),get value(){return s.backgroundColor},set value(g){s.backgroundColor=g}})};M(x,h=>{a(d)&&h(_)})}p(u,c),re()}Ae(["click"]);var Bn=L('<div class="h-3 w-3 rounded-sm shadow-inner"></div>'),Gn=L('<span class="font-mono text-[8px] opacity-20"> </span>'),Un=L('<div class="group flex items-center justify-between rounded-xl border border-text-main/5 bg-text-main/[0.05] p-4 transition-all hover:bg-ui-highlight/10"><div class="flex flex-col gap-2 overflow-hidden"><div class="flex items-center gap-3"><span class="font-serif text-sm font-bold text-text-main"> </span> <!></div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex items-center gap-2 opacity-0 transition-opacity group-hover:opacity-100"><!> <!> <!></div></div>');function Hn(u,e){ae(e,!0);function t(C){return C.replace(/_/g," ").toLowerCase().split(" ").map(P=>P.charAt(0).toUpperCase()+P.slice(1)).join(" ")}var n=Un(),l=i(n),d=i(l),v=i(d),c=i(v,!0);r(v);var f=o(v,2);{var x=C=>{ze(C,{variant:"secondary",size:"sm",children:(P,T)=>{xe();var $=ce();I(j=>E($,j),[()=>A("ui:labels.default")]),p(P,$)},$$slots:{default:!0}})};M(f,C=>{e.preset.isDefault&&C(x)})}r(d);var _=o(d,2),h=i(_);_e(h,17,()=>e.preset.colors.slice(0,12),ke,(C,P)=>{var T=Bn();I(()=>ue(T,`background-color: ${a(P)??""};`)),p(C,T)});var g=o(h,2);{var w=C=>{var P=Gn(),T=i(P);r(P),I(()=>E(T,`+${e.preset.colors.length-12}`)),p(C,P)};M(g,C=>{e.preset.colors.length>12&&C(w)})}r(_),r(l);var y=o(l,2),m=i(y);fe(m,{variant:"primary",size:"sm",onclick:()=>e.onApply(e.preset.id),ariaLabel:"tools:palette_library.button.apply",children:(C,P)=>{xe();var T=ce();I($=>E(T,$),[()=>A("tools:palette_library.button.apply")]),p(C,T)},$$slots:{default:!0}});var k=o(m,2);fe(k,{variant:"secondary",size:"sm",onclick:()=>e.onExport(e.preset.id),ariaLabel:"export:button.export_recipe",class:"h-8 w-8 !p-0",children:(C,P)=>{xe();var T=ce("üì•");p(C,T)},$$slots:{default:!0}});var b=o(k,2);{var S=C=>{fe(C,{variant:"danger",size:"sm",onclick:()=>e.onDelete(e.preset.id),ariaLabel:"tools:palette_library.button.delete",class:"h-8 w-8 !p-0",children:(P,T)=>{xe();var $=ce("üóëÔ∏è");p(P,$)},$$slots:{default:!0}})};M(b,C=>{e.preset.isDefault||C(S)})}r(y),r(n),I(C=>E(c,C),[()=>t(e.preset.name)]),pe(3,n,()=>Aa,()=>({duration:200})),p(u,n),re()}var Vn=L('<div class="flex flex-col gap-8"><div class="flex items-center gap-3"><button class="flex flex-1 items-center justify-center gap-2 rounded-xl border-2 border-dashed border-text-main/10 bg-text-main/[0.05] py-4 transition-all hover:border-ui-accent/40 hover:bg-ui-highlight/20"><span class="text-lg">üè∫</span> <div class="flex flex-col items-start"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/60 uppercase"> </span> <span class="font-serif text-[8px] text-text-main/30 italic"> </span></div></button> <button class="flex flex-1 items-center justify-center gap-2 rounded-xl border-2 border-dashed border-text-main/10 bg-text-main/[0.05] py-4 transition-all hover:border-ui-accent/40 hover:bg-ui-highlight/20"><span class="text-lg">üì¶</span> <div class="flex flex-col items-start"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/60 uppercase"> </span> <span class="font-serif text-[8px] text-text-main/30 italic"> </span></div></button></div> <div class="flex flex-col gap-3 rounded-xl border border-ui-accent/10 bg-ui-accent/5 p-6"><div class="flex flex-col gap-1"><span class="font-serif text-[10px] font-bold tracking-widest text-ui-accent uppercase"> </span> <span class="font-serif text-[9px] text-ui-accent/60 italic"> </span></div> <div class="flex items-end gap-2"><!> <!></div></div> <div class="flex flex-col gap-4"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/30 uppercase"> </span> <div class="flex flex-col gap-2"></div></div></div>'),Yn=L('<input type="file" accept=".gpl,.txt" class="hidden"/> <!>',1);function Kn(u,e){ae(e,!0);let t=ie(e,"onClose",3,()=>s.studio.showPaletteLibrary=!1),n=ve(""),l=ve(void 0);function d(){a(n).trim()&&(s.paletteState.savePreset(a(n).trim()),U(n,""),Q.persistence.backup(),Q.persistence.saveGlobalPalettes())}function v(m){s.paletteState.applyPreset(m),s.studio.show(A("tools:palette_library.applied_toast"))}function c(m){s.paletteState.deletePreset(m),Q.persistence.backup(),Q.persistence.saveGlobalPalettes()}function f(){s.paletteState.newPalette(),s.studio.show(A("tools:palette_library.new_toast"))}function x(){a(l)?.click()}async function _(m){const k=m.target.files?.[0];if(!k)return;const b=await k.text();s.paletteState.importPalette(b)?s.studio.show(A("tools:palette_library.import_success_toast",{replace:{name:k.name}})):s.studio.show(A("tools:palette_library.import_error_toast")),m.target.value=""}function h(m){const k=s.paletteState.presets.find(T=>T.id===m);if(!k)return;const b=dt.toGPL(k.name,k.colors),S=new Blob([b],{type:"text/plain"}),C=URL.createObjectURL(S),P=document.createElement("a");P.href=C,P.download=`${k.name.toLowerCase().replace(/\s+/g,"-")}.gpl`,P.click(),URL.revokeObjectURL(C)}var g=Yn(),w=se(g);w.__change=_,gt(w,m=>U(l,m),()=>a(l));var y=o(w,2);lt(y,{title:"tools:palette_library.title",subtitle:"tools:palette_library.subtitle",isOpen:!0,get onClose(){return t()},width:"600px",children:(m,k)=>{var b=Vn(),S=i(b),C=i(S);C.__click=f;var P=o(i(C),2),T=i(P),$=i(T,!0);r(T);var j=o(T,2),R=i(j,!0);r(j),r(P),r(C);var F=o(C,2);F.__click=x;var ee=o(i(F),2),Z=i(ee),N=i(Z,!0);r(Z);var Y=o(Z,2),H=i(Y,!0);r(Y),r(ee),r(F),r(S);var K=o(S,2),oe=i(K),G=i(oe),z=i(G,!0);r(G);var X=o(G,2),O=i(X,!0);r(X),r(oe);var J=o(oe,2),V=i(J);Be(V,{placeholder:"tools:palette_library.name_placeholder",ariaLabel:"tools:palette_library.save_label",class:"flex-1",onkeydown:W=>W.key==="Enter"&&d(),get value(){return a(n)},set value(W){U(n,W,!0)}});var te=o(V,2);{let W=B(()=>!a(n).trim());fe(te,{variant:"primary",onclick:d,get disabled(){return a(W)},ariaLabel:"tools:palette_library.button.save",class:"py-2.5",children:(be,Re)=>{xe();var Oe=ce();I(Te=>E(Oe,Te),[()=>A("tools:palette_library.button.save")]),p(be,Oe)},$$slots:{default:!0}})}r(J),r(K);var q=o(K,2),le=i(q),Le=i(le,!0);r(le);var Ee=o(le,2);_e(Ee,21,()=>s.paletteState.presets,W=>W.id,(W,be)=>{Hn(W,{get preset(){return a(be)},onApply:v,onExport:h,onDelete:c})}),r(Ee),r(q),r(b),I((W,be,Re,Oe,Te,Qe,He,Ve,it)=>{D(C,"aria-label",W),E($,be),E(R,Re),D(F,"aria-label",Oe),E(N,Te),E(H,Qe),E(z,He),E(O,Ve),E(Le,it)},[()=>A("tools:palette_library.new_set"),()=>A("tools:palette_library.new_set"),()=>A("tools:palette_library.new_set_desc"),()=>A("tools:palette_library.import"),()=>A("tools:palette_library.import"),()=>A("tools:palette_library.import_desc"),()=>A("tools:palette_library.save_label"),()=>A("tools:palette_library.save_desc"),()=>A("tools:palette_library.list_title")]),p(m,b)},$$slots:{default:!0}}),p(u,g),re()}Ae(["change","click"]);var Qn=L('<div class="flex flex-col gap-8"><div class="flex flex-col gap-6 rounded-xl border border-text-main/5 bg-text-main/[0.05] p-8"><div class="grid grid-cols-2 gap-8"><!> <!></div> <p class="font-serif text-[10px] leading-relaxed text-text-main/40 italic"> </p></div> <!></div>');function qn(u,e){ae(e,!0);let t=ie(e,"onClose",3,()=>s.studio.showGoTo=!1),n=ve(yt(s.displayCoords.x)),l=ve(yt(s.displayCoords.y));function d(){Q.jumpTo(a(n),a(l)),t()()}function v(c){c.key==="Enter"&&d()}_t(()=>{setTimeout(()=>{const c=document.getElementById("goto-x");c&&c.focus()},100)}),lt(u,{title:"workspace:navigation.title",subtitle:"workspace:navigation.subtitle",isOpen:!0,get onClose(){return t()},width:"400px",children:(c,f)=>{var x=Qn(),_=i(x),h=i(_),g=i(h);Be(g,{id:"goto-x",label:"workspace:navigation.label_x",type:"number",onkeydown:v,ariaLabel:"workspace:navigation.label_x",get value(){return a(n)},set value(b){U(n,b,!0)}});var w=o(g,2);Be(w,{id:"goto-y",label:"workspace:navigation.label_y",type:"number",onkeydown:v,ariaLabel:"workspace:navigation.label_y",get value(){return a(l)},set value(b){U(l,b,!0)}}),r(h);var y=o(h,2),m=i(y,!0);r(y),r(_);var k=o(_,2);fe(k,{variant:"primary",class:"w-full py-4 text-lg",onclick:d,ariaLabel:"workspace:navigation.action",children:(b,S)=>{xe();var C=ce();I(P=>E(C,P),[()=>A("workspace:navigation.action")]),p(b,C)},$$slots:{default:!0}}),r(x),I(b=>E(m,b),[()=>A("workspace:navigation.current",{replace:{x:s.displayCoords.x,y:s.displayCoords.y}})]),p(c,x)},$$slots:{default:!0}}),re()}var Wn=L('<div class="flex flex-col gap-8"><div class="flex items-center justify-between rounded-xl border border-text-main/5 bg-text-main/[0.05] p-6 shadow-sm"><div class="flex flex-col"><span class="font-serif text-sm font-bold tracking-tight text-text-main/60 uppercase"> </span> <span class="font-serif text-[10px] text-text-main/40"> </span></div> <!></div> <div class="flex flex-col gap-6 rounded-xl border border-text-main/5 bg-text-main/[0.05] p-8"><!> <!></div> <div class="rounded-xl bg-text-main/5 p-6"><h3 class="font-tiny5 mb-2 text-lg text-ui-accent"> </h3> <div class="flex flex-col gap-2 font-serif text-[11px] leading-relaxed text-text-main/60"><div class="flex justify-between"><span> </span> <span class="font-mono"> </span></div> <p class="text-text-main/50 italic"><!></p></div></div> <!></div>');function Xn(u,e){ae(e,!0);let t=ie(e,"onClose",3,()=>s.showAudioSettings=!1);lt(u,{title:"workspace:hud.audio.title",subtitle:"workspace:hud.audio.flow_title",isOpen:!0,get onClose(){return t()},width:"450px",children:(n,l)=>{var d=Wn(),v=i(d),c=i(v),f=i(c),x=i(f,!0);r(f);var _=o(f,2),h=i(_,!0);r(_),r(c);var g=o(c,2);{let H=B(()=>s.isMuted?"primary":"secondary"),K=B(()=>s.isMuted?"actions:hud.unmute_audio":"actions:hud.mute_audio");fe(g,{get variant(){return a(H)},class:"!px-6 !py-2",onclick:()=>s.toggleMute(),get ariaLabel(){return a(K)},children:(oe,G)=>{xe();var z=ce();I(()=>E(z,s.isMuted?"üîá Muted":"üéê Active")),p(oe,z)},$$slots:{default:!0}})}r(v);var w=o(v,2),y=i(w);ot(y,{label:"workspace:hud.audio.sfx_label",min:0,max:1,step:.01,ariaLabel:"workspace:hud.audio.sfx_label",get value(){return s.sfxVolume},set value(H){s.sfxVolume=H}});var m=o(y,2);ot(m,{label:"workspace:hud.audio.bgm_label",min:0,max:1,step:.01,ariaLabel:"workspace:hud.audio.bgm_label",get value(){return s.bgmVolume},set value(H){s.bgmVolume=H}}),r(w);var k=o(w,2),b=i(k),S=i(b,!0);r(b);var C=o(b,2),P=i(C),T=i(P),$=i(T,!0);r(T);var j=o(T,2),R=i(j);r(j),r(P);var F=o(P,2),ee=i(F);{var Z=H=>{var K=ce();I(oe=>E(K,oe),[()=>A("workspace:hud.audio.status_awaiting")]),p(H,K)},N=H=>{var K=ce();I(oe=>E(K,oe),[()=>A("workspace:hud.audio.status_playing")]),p(H,K)};M(ee,H=>{s.usageMinutes<30?H(Z):H(N,!1)})}r(F),r(C),r(k);var Y=o(k,2);fe(Y,{variant:"primary",class:"w-full py-4",get onclick(){return t()},ariaLabel:"ui:labels.confirm",children:(H,K)=>{xe();var oe=ce();I(G=>E(oe,G),[()=>A("ui:labels.confirm")]),p(H,oe)},$$slots:{default:!0}}),r(d),I((H,K,oe,G)=>{E(x,H),E(h,K),E(S,oe),E($,G),E(R,`${s.usageMinutes??""} minutes`)},[()=>A("workspace:hud.audio.master_mute"),()=>A("workspace:hud.audio.mute_desc"),()=>A("workspace:hud.audio.flow_title"),()=>A("workspace:hud.audio.duration_label")]),p(n,d)},$$slots:{default:!0}}),re()}var Zn=L('<div class="flex flex-col gap-12"><section class="flex flex-col gap-6" aria-labelledby="philosophy-title"><div class="flex items-center gap-4 border-b border-text-main/10 pb-4"><span class="text-3xl" aria-hidden="true">üåø</span> <h3 id="philosophy-title" class="font-tiny5 text-3xl tracking-tighter text-ui-accent uppercase"> </h3></div> <div class="space-y-4 font-serif text-base leading-relaxed text-text-main/80"><p> </p> <p> </p> <p class="text-ui-accent italic"> </p></div></section> <div class="grid grid-cols-3 gap-6" role="list"><div class="flex flex-col gap-3 rounded-2xl border border-text-main/5 bg-text-main/[0.05] p-6 shadow-sm transition-all hover:bg-text-main/10" role="listitem"><div class="text-2xl" aria-hidden="true">üñåÔ∏è</div> <h4 class="font-tiny5 text-lg tracking-tight text-ui-accent uppercase"> </h4> <p class="font-serif text-[12px] leading-relaxed text-text-main/60"> </p></div> <div class="flex flex-col gap-3 rounded-2xl border border-text-main/5 bg-text-main/[0.05] p-6 shadow-sm transition-all hover:bg-text-main/10" role="listitem"><div class="text-2xl" aria-hidden="true">üçµ</div> <h4 class="font-tiny5 text-lg tracking-tight text-ui-accent uppercase"> </h4> <p class="font-serif text-[12px] leading-relaxed text-text-main/60"> </p></div> <div class="flex flex-col gap-3 rounded-2xl border border-text-main/5 bg-text-main/[0.05] p-6 shadow-sm transition-all hover:bg-text-main/10" role="listitem"><div class="text-2xl" aria-hidden="true">üìÑ</div> <h4 class="font-tiny5 text-lg tracking-tight text-ui-accent uppercase"> </h4> <p class="font-serif text-[12px] leading-relaxed text-text-main/60"> </p></div></div> <section class="flex flex-col gap-8 rounded-3xl bg-ui-accent/5 p-10 ring-1 ring-ui-accent/10" aria-labelledby="techniques-title"><h3 id="techniques-title" class="font-tiny5 text-2xl tracking-tighter text-ui-accent uppercase"> </h3> <div class="grid grid-cols-2 gap-x-12 gap-y-8"><div class="flex gap-5"><div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-2xl bg-canvas-bg text-2xl shadow-sm" aria-hidden="true">üéã</div> <div class="flex flex-col gap-1"><span class="font-serif text-sm font-black tracking-widest text-text-main/80 uppercase"> </span> <p class="font-serif text-[11px] leading-relaxed text-text-main/60"> </p></div></div> <div class="flex gap-5"><div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-2xl bg-canvas-bg text-2xl shadow-sm" aria-hidden="true">‚ú®</div> <div class="flex flex-col gap-1"><span class="font-serif text-sm font-black tracking-widest text-text-main/80 uppercase"> </span> <p class="font-serif text-[11px] leading-relaxed text-text-main/60"> </p></div></div> <div class="flex gap-5"><div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-2xl bg-canvas-bg text-2xl shadow-sm" aria-hidden="true">üåÄ</div> <div class="flex flex-col gap-1"><span class="font-serif text-sm font-black tracking-widest text-text-main/80 uppercase"> </span> <p class="font-serif text-[11px] leading-relaxed text-text-main/60"> </p></div></div> <div class="flex gap-5"><div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-2xl bg-canvas-bg text-2xl shadow-sm" aria-hidden="true">üéê</div> <div class="flex flex-col gap-1"><span class="font-serif text-sm font-black tracking-widest text-text-main/80 uppercase"> </span> <p class="font-serif text-[11px] leading-relaxed text-text-main/60"> </p></div></div></div></section> <footer class="flex flex-col items-center gap-6 border-t border-text-main/10 pt-10 text-center"><div class="flex flex-col items-center gap-2"><p class="font-serif text-sm text-text-main/50 italic"> </p> <span class="font-tiny5 text-[10px] tracking-[0.3em] text-text-main/30 uppercase"> </span></div> <div class="flex items-center gap-4"><!> <!></div></footer></div>');function Jn(u,e){ae(e,!0);let t=ie(e,"onClose",3,()=>s.showManual=!1);ka(u,{title:"manual:title",isOpen:!0,get onClose(){return t()},width:"850px",children:(n,l)=>{var d=Zn(),v=i(d),c=i(v),f=o(i(c),2),x=i(f,!0);r(f),r(c);var _=o(c,2),h=i(_),g=i(h,!0);r(h);var w=o(h,2),y=i(w,!0);r(w);var m=o(w,2),k=i(m,!0);r(m),r(_),r(v);var b=o(v,2),S=i(b),C=o(i(S),2),P=i(C,!0);r(C);var T=o(C,2),$=i(T,!0);r(T),r(S);var j=o(S,2),R=o(i(j),2),F=i(R,!0);r(R);var ee=o(R,2),Z=i(ee,!0);r(ee),r(j);var N=o(j,2),Y=o(i(N),2),H=i(Y,!0);r(Y);var K=o(Y,2),oe=i(K,!0);r(K),r(N),r(b);var G=o(b,2),z=i(G),X=i(z,!0);r(z);var O=o(z,2),J=i(O),V=o(i(J),2),te=i(V),q=i(te,!0);r(te);var le=o(te,2),Le=i(le,!0);r(le),r(V),r(J);var Ee=o(J,2),W=o(i(Ee),2),be=i(W),Re=i(be,!0);r(be);var Oe=o(be,2),Te=i(Oe,!0);r(Oe),r(W),r(Ee);var Qe=o(Ee,2),He=o(i(Qe),2),Ve=i(He),it=i(Ve,!0);r(Ve);var qe=o(Ve,2),vt=i(qe,!0);r(qe),r(He),r(Qe);var Et=o(Qe,2),xt=o(i(Et),2),Lt=i(xt),Kt=i(Lt,!0);r(Lt);var St=o(Lt,2),Ot=i(St,!0);r(St),r(xt),r(Et),r(O),r(G);var Mt=o(G,2),Ct=i(Mt),ye=i(Ct),Me=i(ye);r(ye);var We=o(ye,2),Ye=i(We,!0);r(We),r(Ct);var Fe=o(Ct,2),Xe=i(Fe);fe(Xe,{variant:"secondary",class:"px-10 py-4",onclick:()=>{t()(),s.showShortcuts=!0},ariaLabel:"manual:footer.all_shortcuts",children:(we,De)=>{xe();var Ie=ce();I(Pe=>E(Ie,Pe),[()=>A("manual:footer.all_shortcuts")]),p(we,Ie)},$$slots:{default:!0}});var Ke=o(Xe,2);fe(Ke,{variant:"primary",class:"px-16 py-4 text-xl",get onclick(){return t()},ariaLabel:"manual:footer.enter",children:(we,De)=>{xe();var Ie=ce();I(Pe=>E(Ie,Pe),[()=>A("manual:footer.enter")]),p(we,Ie)},$$slots:{default:!0}}),r(Fe),r(Mt),r(d),I((we,De,Ie,Pe,Se,Tt,ct,Dt,zt,Qt,qt,ut,Ft,Ea,La,Sa,Ca,Ta,Ia,Pa,ja)=>{E(x,we),E(g,De),E(y,Ie),E(k,Pe),E(P,Se),E($,Tt),E(F,ct),E(Z,Dt),E(H,zt),E(oe,Qt),E(X,qt),E(q,ut),E(Le,Ft),E(Re,Ea),E(Te,La),E(it,Sa),E(vt,Ca),E(Kt,Ta),E(Ot,Ia),E(Me,`"${Pa??""}"`),E(Ye,ja)},[()=>A("manual:philosophy.title"),()=>A("manual:philosophy.p1"),()=>A("manual:philosophy.p2"),()=>A("manual:philosophy.p3"),()=>A("manual:pillars.cursor.title"),()=>A("manual:pillars.cursor.desc"),()=>A("manual:pillars.colors.title"),()=>A("manual:pillars.colors.desc"),()=>A("manual:pillars.layers.title"),()=>A("manual:pillars.layers.desc"),()=>A("manual:techniques.title"),()=>A("manual:techniques.continuous.title"),()=>A("manual:techniques.continuous.desc"),()=>A("manual:techniques.magic_select.title"),()=>A("manual:techniques.magic_select.desc"),()=>A("manual:techniques.timeline.title"),()=>A("manual:techniques.timeline.desc"),()=>A("manual:techniques.audio.title"),()=>A("manual:techniques.audio.desc"),()=>A("manual:footer.quote"),()=>A("manual:footer.guild")]),p(n,d)},$$slots:{default:!0}}),re()}var el=L('<div class="grid grid-cols-2 items-start gap-8"><div class="flex flex-col gap-2"><span class="text-xs font-bold text-text-main/60 uppercase"> </span> <!></div> <!></div> <div class="flex flex-col gap-2"><span class="text-xs font-bold text-text-main/60 uppercase"> </span> <div class="flex items-center gap-4"><!> <span class="text-[10px] text-text-main/40 italic">Use Ctrl + Alt + Arrows to nudge on canvas.</span></div></div> <div class="border-t border-text-main/5 pt-4"><!></div>',1),tl=L('<div class="flex flex-col gap-6"><div class="flex flex-col gap-2"><label class="text-xs font-bold text-text-main/60 uppercase" for="underlay-file"> </label> <input id="underlay-file" type="file" accept="image/*" class="text-xs text-text-main/80"/></div> <!></div>');function al(u,e){ae(e,!1);const t=fa(s.studio);function n(d){const v=d.target;if(v.files&&v.files[0]){const c=new FileReader;c.onload=f=>{at(t,a(t).underlayImage=f.target?.result)},c.readAsDataURL(v.files[0])}}function l(){at(t,a(t).underlayOffset={x:0,y:0}),at(t,a(t).underlayScale=1)}Ce(),lt(u,{title:"actions:open_underlay_menu",isOpen:!0,onClose:()=>at(t,a(t).showUnderlayMenu=!1),children:(d,v)=>{var c=tl(),f=i(c),x=i(f),_=i(x,!0);r(x);var h=o(x,2);h.__change=n,r(f);var g=o(f,2);{var w=y=>{var m=el(),k=se(m),b=i(k),S=i(b),C=i(S,!0);r(S);var P=o(S,2);{let Y=ht(()=>a(t).isUnderlayVisible?"ui:labels.on":"ui:labels.off");Yt(P,{get label(){return a(Y)},ariaLabel:"workspace:underlay.visibility",get checked(){return a(t).isUnderlayVisible},set checked(H){at(t,a(t).isUnderlayVisible=H)},$$legacy:!0})}r(b);var T=o(b,2);ot(T,{label:"workspace:project_panel.opacity",min:0,max:1,step:.05,ariaLabel:"workspace:project_panel.opacity",get value(){return a(t).underlayOpacity},set value(Y){at(t,a(t).underlayOpacity=Y)},$$legacy:!0}),r(k);var $=o(k,2),j=i($),R=i(j,!0);r(j);var F=o(j,2),ee=i(F);fe(ee,{variant:"secondary",size:"sm",onclick:l,ariaLabel:"actions:reset_viewport",children:(Y,H)=>{xe();var K=ce();I(oe=>E(K,oe),[()=>A("actions:reset_viewport")]),p(Y,K)},$$slots:{default:!0}}),xe(2),r(F),r($);var Z=o($,2),N=i(Z);fe(N,{variant:"ghost",class:"w-full text-xs text-red-500 hover:underline",onclick:()=>at(t,a(t).underlayImage=null),ariaLabel:"actions:delete",children:(Y,H)=>{xe();var K=ce("Clear Reference Image");p(Y,K)},$$slots:{default:!0}}),r(Z),I((Y,H)=>{E(C,Y),E(R,H)},[()=>A("workspace:underlay.visibility"),()=>A("workspace:underlay.positioning")]),p(y,m)};M(g,y=>{a(t).underlayImage&&y(w)})}r(c),I(y=>E(_,y),[()=>A("workspace:underlay.upload_label")]),p(d,c)},$$slots:{default:!0}}),re()}Ae(["change"]);var rl=L('<div class="flex flex-col gap-8"><!> <div class="flex flex-col gap-4"><div class="flex flex-col gap-1"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/60 uppercase"> </span> <span class="font-serif text-[9px] text-text-main/40 italic"> </span></div> <div class="grid grid-cols-2 gap-4"><!> <!></div></div> <!></div>');function il(u,e){ae(e,!0);let t=ie(e,"onClose",3,()=>s.studio.showPourBasin=!1),n=ve(5),l=ve(1),d=ve(0);function v(){Q.selection.propagate(a(n),a(l),a(d)),t()()}lt(u,{title:"export:propagation.title",subtitle:"export:propagation.subtitle",isOpen:!0,get onClose(){return t()},width:"400px",children:(c,f)=>{var x=rl(),_=i(x);{let T=B(()=>s.project.frames.length-s.project.activeFrameIndex-1);Be(_,{label:"export:propagation.frames_label",type:"number",min:1,get max(){return a(T)},ariaLabel:"export:propagation.frames_label",get value(){return a(n)},set value($){U(n,$,!0)}})}var h=o(_,2),g=i(h),w=i(g),y=i(w,!0);r(w);var m=o(w,2),k=i(m,!0);r(m),r(g);var b=o(g,2),S=i(b);Be(S,{label:"workspace:navigation.label_x",type:"number",ariaLabel:"workspace:navigation.label_x",get value(){return a(l)},set value(T){U(l,T,!0)}});var C=o(S,2);Be(C,{label:"workspace:navigation.label_y",type:"number",ariaLabel:"workspace:navigation.label_y",get value(){return a(d)},set value(T){U(d,T,!0)}}),r(b),r(h);var P=o(h,2);{let T=B(()=>a(n)<=0);fe(P,{variant:"primary",class:"w-full py-4 text-lg",onclick:v,get disabled(){return a(T)},ariaLabel:"export:propagation.action",children:($,j)=>{xe();var R=ce();I(F=>E(R,F),[()=>A("export:propagation.action")]),p($,R)},$$slots:{default:!0}})}r(x),I((T,$)=>{E(y,T),E(k,$)},[()=>A("export:propagation.offset_label"),()=>A("export:propagation.offset_desc")]),p(c,x)},$$slots:{default:!0}}),re()}var sl=L('<div class="mt-4 flex flex-col gap-1"><span class="font-mono text-[10px] font-bold text-text-main/40 uppercase">Technical Trace</span> <pre class="max-h-40 overflow-auto rounded-lg bg-text-main/5 p-4 font-mono text-[11px] whitespace-pre-wrap text-text-main/60"> </pre></div>'),ol=L('<div class="flex flex-col gap-6"><div class="flex flex-col gap-2"><p class="text-sm font-medium text-text-main/80"> </p> <!></div> <div class="flex justify-end gap-3 border-t border-text-main/5 pt-4"><!></div></div>');function nl(u,e){ae(e,!0);let t=ie(e,"onClose",3,()=>s.studio.showErrorDialog=!1);const n=B(()=>s.studio.lastError);{let l=B(()=>a(n)?.title||"System Error");lt(u,{get title(){return a(l)},subtitle:"Technical Exception Details",isOpen:!0,get onClose(){return t()},width:"500px",children:(d,v)=>{var c=ol(),f=i(c),x=i(f),_=i(x,!0);r(x);var h=o(x,2);{var g=m=>{var k=sl(),b=o(i(k),2),S=i(b);r(b),r(k),I(()=>E(S,`
						${a(n).technical??""}
					`)),p(m,k)};M(h,m=>{a(n)?.technical&&m(g)})}r(f);var w=o(f,2),y=i(w);fe(y,{variant:"primary",get onclick(){return t()},ariaLabel:"ui:labels.confirm",children:(m,k)=>{xe();var b=ce();I(S=>E(b,S),[()=>A("ui:labels.confirm")]),p(m,b)},$$slots:{default:!0}}),r(w),r(c),I(()=>E(_,a(n)?.message||"An unexpected error has occurred.")),p(d,c)},$$slots:{default:!0}})}re()}var ll=L('<div class="flex flex-col gap-6"><p class="text-sm leading-relaxed text-text-main/70"> </p> <div class="flex justify-end gap-3 border-t border-text-main/5 pt-4"><!> <!></div></div>');function cl(u,e){ae(e,!0);async function t(){await Q.persistence.restoreLastSession()&&s.studio.show(A("ui:studio.session_restored")),e.onResolve()}async function n(){await xa.saveProject("autosave_session",""),e.onResolve()}lt(u,{title:"ui:labels.recovery_title",subtitle:"ui:labels.recovery_subtitle",isOpen:!0,onClose:n,width:"450px",children:(l,d)=>{var v=ll(),c=i(v),f=i(c,!0);r(c);var x=o(c,2),_=i(x);fe(_,{variant:"danger",onclick:n,ariaLabel:"ui:labels.cancel",children:(g,w)=>{xe();var y=ce();I(m=>E(y,m),[()=>A("ui:labels.cancel")]),p(g,y)},$$slots:{default:!0}});var h=o(_,2);fe(h,{variant:"primary",onclick:t,ariaLabel:"ui:labels.confirm",children:(g,w)=>{xe();var y=ce();I(m=>E(y,m),[()=>A("ui:labels.confirm")]),p(g,y)},$$slots:{default:!0}}),r(x),r(v),I(g=>E(f,g),[()=>A("ui:labels.recovery_description")]),p(l,v)},$$slots:{default:!0}}),re()}var dl=L('<span class="text-xs opacity-60"> </span>'),vl=L('<button><div class="flex items-center gap-3"><!> <span class="font-serif text-xs font-medium"> </span></div></button>'),ul=L('<div class="fixed z-[2000] min-w-[160px] overflow-hidden rounded-lg border border-text-main/10 bg-canvas-bg/95 p-1 shadow-xl backdrop-blur-md" role="menu" tabindex="-1"><div class="flex flex-col gap-0.5"></div></div>');function pl(u,e){ae(e,!0);let t=ve(null),n=ve(160),l=ve(100),d=B(()=>e.x+a(n)>(typeof window<"u"?window.innerWidth:1e3)?e.x-a(n):e.x),v=B(()=>e.y+a(l)>(typeof window<"u"?window.innerHeight:1e3)?e.y-a(l):e.y);_t(()=>{a(t)&&(U(n,a(t).offsetWidth,!0),U(l,a(t).offsetHeight,!0))});var c=ul();$e("mousedown",ea,x=>!a(t)?.contains(x.target)&&e.onClose()),c.__contextmenu=x=>x.preventDefault();var f=i(c);_e(f,21,()=>e.items,ke,(x,_)=>{var h=vl();h.__click=()=>{a(_).disabled||(a(_).action(),e.onClose())};var g=i(h),w=i(g);{var y=b=>{var S=dl(),C=i(S,!0);r(S),I(()=>E(C,a(_).icon)),p(b,S)};M(w,b=>{a(_).icon&&b(y)})}var m=o(w,2),k=i(m,!0);r(m),r(g),r(h),I(()=>{h.disabled=a(_).disabled,ne(h,1,`flex w-full items-center justify-between rounded px-3 py-2 text-left transition-colors ${a(_).danger?"text-red-600 hover:bg-red-50":"text-text-main hover:bg-ui-accent/5"} ${a(_).disabled?"cursor-not-allowed opacity-30 grayscale":""}`),E(k,a(_).label)}),p(x,h)}),r(f),r(c),gt(c,x=>U(t,x),()=>a(t)),I(()=>ue(c,`left: ${a(d)??""}px; top: ${a(v)??""}px;`)),pe(3,c,()=>kt,()=>({duration:100,start:.95,opacity:0})),p(u,c),re()}Ae(["contextmenu","click"]);var fl=L('<div class="pointer-events-none fixed bottom-24 left-1/2 z-[2000] -translate-x-1/2 rounded-full border border-ui-accent/20 bg-canvas-bg/95 px-6 py-2 shadow-2xl backdrop-blur-md"><div class="flex items-center gap-3"><span class="font-tiny5 text-lg tracking-widest text-ui-accent uppercase"> </span></div></div>');function xl(u,e){ae(e,!1);const t=s.studio;Ce();var n=me(),l=se(n);{var d=v=>{var c=fl(),f=i(c),x=i(f),_=i(x,!0);r(x),r(f),r(c),I(()=>E(_,t.toastMessage)),pe(3,c,()=>Vt,()=>({y:20,duration:300})),p(v,c)};M(l,v=>{t.showToast&&v(d)})}p(u,n),re()}var gl=L('<header class="app-header z-30 h-14 shrink-0 border-b border-text-main/10 bg-canvas-bg shadow-sm svelte-1towcbt"><!></header>'),ml=L('<aside class="app-sidebar-left z-20 w-72 shrink-0 border-r border-text-main/10 bg-canvas-bg/50 shadow-sm svelte-1towcbt"><!></aside>'),hl=L('<aside class="app-sidebar-right z-20 w-80 shrink-0 border-l border-text-main/10 bg-canvas-bg/50 shadow-sm svelte-1towcbt"><!></aside>'),_l=L('<footer class="app-footer z-30 h-auto shrink-0 border-t border-text-main/10 bg-canvas-bg shadow-sm svelte-1towcbt"><!></footer>'),bl=L('<div class="app-overlay-layer pointer-events-none fixed inset-0 z-[500] overflow-hidden"><!></div>'),Al=L('<div class="app-shell h-screen w-screen overflow-hidden bg-canvas-bg font-serif text-text-main svelte-1towcbt"><!> <main class="app-main flex flex-1 overflow-hidden"><!> <section class="app-viewport relative flex-1 overflow-hidden bg-grid-border/5 svelte-1towcbt"><!></section> <!></main> <!> <!></div>');function yl(u,e){var t=Al(),n=i(t);{var l=b=>{var S=gl(),C=i(S);je(C,()=>e.header),r(S),p(b,S)};M(n,b=>{e.header&&b(l)})}var d=o(n,2),v=i(d);{var c=b=>{var S=ml(),C=i(S);je(C,()=>e.sidebarLeft),r(S),p(b,S)};M(v,b=>{e.sidebarLeft&&b(c)})}var f=o(v,2),x=i(f);{var _=b=>{var S=me(),C=se(S);je(C,()=>e.viewport),p(b,S)};M(x,b=>{e.viewport&&b(_)})}r(f);var h=o(f,2);{var g=b=>{var S=hl(),C=i(S);je(C,()=>e.sidebarRight),r(S),p(b,S)};M(h,b=>{e.sidebarRight&&b(g)})}r(d);var w=o(d,2);{var y=b=>{var S=_l(),C=i(S);je(C,()=>e.footer),r(S),p(b,S)};M(w,b=>{e.footer&&b(y)})}var m=o(w,2);{var k=b=>{var S=bl(),C=i(S);je(C,()=>e.overlay),r(S),p(b,S)};M(m,b=>{e.overlay&&b(k)})}r(t),p(u,t)}var wl=L('<div class="flex h-full w-full items-center px-4"><!></div>');function kl(u,e){var t=wl(),n=i(t);je(n,()=>e.children),r(t),p(u,t)}var El=L('<div class="flex h-full w-full items-center px-4"><!></div>');function Ll(u,e){var t=El(),n=i(t);je(n,()=>e.children),r(t),p(u,t)}var Sl=L('<div class="flex h-full w-full flex-col overflow-hidden"><!></div>');function va(u,e){ie(e,"side",3,"left");var t=Sl(),n=i(t);je(n,()=>e.children),r(t),p(u,t)}var Cl=L('<div class="h-full w-full"><!></div>');function Tl(u,e){var t=Cl(),n=i(t);je(n,()=>e.children),r(t),p(u,t)}var Il=L('<div class="app-overlay contents-interactive pointer-events-none absolute inset-0 svelte-1e74jgv"><!></div>');function Pl(u,e){var t=Il(),n=i(t);je(n,()=>e.children),r(t),p(u,t)}var de=wt(()=>s),jl=L('<div class="relative flex h-full w-full items-center justify-center overflow-hidden bg-grid-border/20 p-6"><div><!></div></div>'),$l=L("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1);function Gl(u,e){ae(e,!1),_t(()=>Ze.mount()),Ce(),yl(u,{header:f=>{kl(f,{children:(x,_)=>{Mr(x)}})},sidebarLeft:f=>{va(f,{side:"left",children:(x,_)=>{Si(x,{})},$$slots:{default:!0}})},viewport:f=>{Tl(f,{children:(x,_)=>{var h=jl(),g=i(h),w=i(g);Vo(w,{}),r(g),r(h),I(()=>ne(g,1,`editor-frame flex h-full w-full items-center justify-center overflow-hidden shadow-2xl transition-all duration-700 ease-out ${de().project.isPlaying&&de().project.frames.length>1?"ring-palette-0 animate-pulse ring-8 ring-inset":""}`)),p(x,h)}})},sidebarRight:f=>{va(f,{side:"right",children:(x,_)=>{Vi(x)},$$slots:{default:!0}})},footer:f=>{Ll(f,{children:(x,_)=>{uo(x)}})},overlay:f=>{Pl(f,{children:(x,_)=>{var h=$l(),g=se(h);Qo(g,{});var w=o(g,2);{var y=W=>{Jn(W,{onClose:()=>de(de().showManual=!1)})};M(w,W=>{de().showManual&&W(y)})}var m=o(w,2);{var k=W=>{cn(W,{onClose:()=>de(de().showCommandPalette=!1)})};M(m,W=>{de().showCommandPalette&&W(k)})}var b=o(m,2);{var S=W=>{Ln(W,{onExport:(be,Re,Oe)=>Q.createArtifact(be,Re,Oe),onClose:()=>de(de().showExportMenu=!1)})};M(b,W=>{de().showExportMenu&&W(S)})}var C=o(b,2);{var P=W=>{Dn(W,{onClose:()=>de(de().showPersistenceMenu=!1)})};M(C,W=>{de().showPersistenceMenu&&W(P)})}var T=o(C,2);{var $=W=>{Kn(W,{onClose:()=>de(de().studio.showPaletteLibrary=!1)})};M(T,W=>{de().studio.showPaletteLibrary&&W($)})}var j=o(T,2);{var R=W=>{Nn(W,{onClose:()=>de(de().showCanvasSettings=!1)})};M(j,W=>{de().showCanvasSettings&&W(R)})}var F=o(j,2);{var ee=W=>{qn(W,{onClose:()=>de(de().showGoTo=!1)})};M(F,W=>{de().showGoTo&&W(ee)})}var Z=o(F,2);{var N=W=>{il(W,{onClose:()=>de(de().studio.showPourBasin=!1)})};M(Z,W=>{de().studio.showPourBasin&&W(N)})}var Y=o(Z,2);{var H=W=>{Xn(W,{onClose:()=>de(de().showAudioSettings=!1)})};M(Y,W=>{de().showAudioSettings&&W(H)})}var K=o(Y,2);{var oe=W=>{On(W,{onClose:()=>de(de().showShortcuts=!1)})};M(K,W=>{de().showShortcuts&&W(oe)})}var G=o(K,2);{var z=W=>{al(W,{})};M(G,W=>{de().studio.showUnderlayMenu&&W(z)})}var X=o(G,2);{var O=W=>{nl(W,{onClose:()=>de(de().studio.showErrorDialog=!1)})};M(X,W=>{de().studio.showErrorDialog&&W(O)})}var J=o(X,2);{var V=W=>{cl(W,{onResolve:()=>de(de().studio.showRecoveryPrompt=!1)})};M(J,W=>{de().studio.showRecoveryPrompt&&W(V)})}var te=o(J,2);{var q=W=>{pl(W,{get x(){return de().studio.contextMenu.x},get y(){return de().studio.contextMenu.y},get items(){return de().studio.contextMenu.items},onClose:()=>de(de().studio.contextMenu=null)})};M(te,W=>{de().studio.contextMenu&&W(q)})}var le=o(te,2);{var Le=W=>{ia(W,{onClose:()=>de(de().showColorPicker=!1),get value(){return de().paletteState.activeColor},set value(be){de(de().paletteState.activeColor=be)},$$legacy:!0})};M(le,W=>{de().showColorPicker&&W(Le)})}var Ee=o(le,2);xl(Ee,{}),p(x,h)}})}}),re()}export{Gl as component};
