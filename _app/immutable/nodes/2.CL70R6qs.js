const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BZqdlsFf.js","../chunks/C2VBFIMg.js","../chunks/8aFoJhGr.js"])))=>i.map(i=>d[i]);
import{a as f,f as S,c as Te,t as ve,d as lt}from"../chunks/Co9eaF-V.js";import{i as je}from"../chunks/BCD8ZGtS.js";import{o as _t}from"../chunks/B4u-zkbD.js";import{O as yt,V as Ma,aX as Oa,U as Da,A as za,W as Fa,aY as Na,a7 as Ba,n as Vt,aZ as Ga,a_ as Ha,a$ as Ua,b0 as Va,q as pa,b1 as jt,ay as fa,b as Mt,b2 as Ya,b3 as Ka,b4 as Qa,b5 as xa,b6 as qa,b7 as Wa,b8 as Xa,H as $t,aL as Za,o as Ja,b9 as er,y as B,g as t,ab as tr,aM as ce,p as ae,k as i,m as r,s as o,t as P,j as re,a1 as H,i as ne,a as He,ar as ge,aK as ga,ba as at,F as bt,bb as ta,x as wt,bc as ar}from"../chunks/C2VBFIMg.js";import{B as rr,_ as ir,i as O}from"../chunks/8aFoJhGr.js";import{t as sr,e as s,k as Ve,p as xt,c as aa,d as Xt,f as rt,g as K,S as ha,h as ma,_,C as vt,a as _e,s as pe,i as Le,b as Me,m as Je,j as or,G as Gt}from"../chunks/BZqdlsFf.js";import{a as nr,s as E,d as te,b as Ae,e as Oe}from"../chunks/gDyIRYao.js";import{p as se,b as gt}from"../chunks/CySLd6_A.js";const lr=Symbol("NaN");function cr(u,e,a){yt&&Ma();var n=new rr(u),l=!Oa();Da(()=>{var c=e();c!==c&&(c=lr),l&&c!==null&&typeof c=="object"&&(c={}),n.ensure(c,a)})}const dr=()=>performance.now(),ft={tick:u=>requestAnimationFrame(u),now:()=>dr(),tasks:new Set};function ba(){const u=ft.now();ft.tasks.forEach(e=>{e.c(u)||(ft.tasks.delete(e),e.f())}),ft.tasks.size!==0&&ft.tick(ba)}function vr(u){let e;return ft.tasks.size===0&&ft.tick(ba),{promise:new Promise(a=>{ft.tasks.add(e={c:u,f:a})}),abort(){ft.tasks.delete(e)}}}function Ht(u,e){fa(()=>{u.dispatchEvent(new CustomEvent(e))})}function ur(u){if(u==="float")return"cssFloat";if(u==="offset")return"cssOffset";if(u.startsWith("--"))return u;const e=u.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(a=>a[0].toUpperCase()+a.slice(1)).join("")}function oa(u){const e={},a=u.split(";");for(const n of a){const[l,c]=n.split(":");if(!l||c===void 0)break;const v=ur(l.trim());e[v]=c.trim()}return e}const pr=u=>u;function fe(u,e,a,n){var l=(u&Ha)!==0,c=(u&Ua)!==0,v=l&&c,d=(u&Ga)!==0,p=v?"both":l?"in":"out",x,b=e.inert,h=e.style.overflow,g,y;function w(){return fa(()=>x??=a()(e,n?.()??{},{direction:p}))}var m={is_global:d,in(){if(e.inert=b,!l){y?.abort(),y?.reset?.();return}c||g?.abort(),g=ra(e,w(),y,1,()=>{Ht(e,"introend"),g?.abort(),g=x=void 0,e.style.overflow=h})},out(T){if(!c){T?.(),x=void 0;return}e.inert=!0,y=ra(e,w(),g,0,()=>{Ht(e,"outroend"),T?.()})},stop:()=>{g?.abort(),y?.abort()}},k=za;if((k.nodes.t??=[]).push(m),l&&nr){var A=d;if(!A){for(var C=k.parent;C&&(C.f&Fa)!==0;)for(;(C=C.parent)&&(C.f&Na)===0;);A=!C||(C.f&Ba)!==0}A&&Vt(()=>{Mt(()=>m.in())})}}function ra(u,e,a,n,l){var c=n===1;if(Va(e)){var v,d=!1;return pa(()=>{if(!d){var k=e({direction:c?"in":"out"});v=ra(u,k,a,n,l)}}),{abort:()=>{d=!0,v?.abort()},deactivate:()=>v.deactivate(),reset:()=>v.reset(),t:()=>v.t()}}if(a?.deactivate(),!e?.duration&&!e?.delay)return Ht(u,c?"introstart":"outrostart"),l(),{abort:jt,deactivate:jt,reset:jt,t:()=>n};const{delay:p=0,css:x,tick:b,easing:h=pr}=e;var g=[];if(c&&a===void 0&&(b&&b(0,1),x)){var y=oa(x(0,1));g.push(y,y)}var w=()=>1-n,m=u.animate(g,{duration:p,fill:"forwards"});return m.onfinish=()=>{m.cancel(),Ht(u,c?"introstart":"outrostart");var k=a?.t()??1-n;a?.abort();var A=n-k,C=e.duration*Math.abs(A),T=[];if(C>0){var L=!1;if(x)for(var I=Math.ceil(C/16.666666666666668),$=0;$<=I;$+=1){var j=k+A*h($/I),R=oa(x(j,1-j));T.push(R),L||=R.overflow==="hidden"}L&&(u.style.overflow="hidden"),w=()=>{var F=m.currentTime;return k+A*h(F/C)},b&&vr(()=>{if(m.playState!=="running")return!1;var F=w();return b(F,1-F),!0})}m=u.animate(T,{duration:C,fill:"forwards"}),m.onfinish=()=>{w=()=>n,b?.(n,1-n),l()}},{abort:()=>{m&&(m.cancel(),m.effect=null,m.onfinish=jt)},deactivate:()=>{l=jt},reset:()=>{n===0&&b?.(1,0)},t:()=>w()}}function _a(u,e,a){Vt(()=>{var n=Mt(()=>e(u,a?.())||{});if(n?.destroy)return()=>n.destroy()})}function oe(u,e,a,n,l,c){var v=u.__className;if(yt||v!==a||v===void 0){var d=sr(a,n,c);(!yt||d!==u.getAttribute("class"))&&(d==null?u.removeAttribute("class"):e?u.className=d:u.setAttribute("class",d)),u.__className=a}else if(c&&l!==c)for(var p in c){var x=!!c[p];(l==null||x!==!!l[p])&&u.classList.toggle(p,x)}return c}const fr=Symbol("is custom element"),xr=Symbol("is html"),gr=xa?"link":"LINK",hr=xa?"progress":"PROGRESS";function kt(u){if(yt){var e=!1,a=()=>{if(!e){if(e=!0,u.hasAttribute("value")){var n=u.value;z(u,"value",null),u.value=n}if(u.hasAttribute("checked")){var l=u.checked;z(u,"checked",null),u.checked=l}}};u.__on_r=a,pa(a),Ka()}}function mr(u,e){var a=Aa(u);a.value===(a.value=e??void 0)||u.value===e&&(e!==0||u.nodeName!==hr)||(u.value=e??"")}function z(u,e,a,n){var l=Aa(u);yt&&(l[e]=u.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&u.nodeName===gr)||l[e]!==(l[e]=a)&&(e==="loading"&&(u[Ya]=a),a==null?u.removeAttribute(e):typeof a!="string"&&br(u).includes(e)?u[e]=a:u.setAttribute(e,a))}function Aa(u){return u.__attributes??={[fr]:u.nodeName.includes("-"),[xr]:u.namespaceURI===Qa}}var na=new Map;function br(u){var e=u.getAttribute("is")||u.nodeName,a=na.get(e);if(a)return a;na.set(e,a=[]);for(var n,l=u,c=Element.prototype;c!==l;){n=Wa(l);for(var v in n)n[v].set&&a.push(v);l=qa(l)}return a}function Ot(u,e,a=e){var n=new WeakSet;Xa(u,"input",async l=>{var c=l?u.defaultValue:u.value;if(c=Zt(u)?Jt(c):c,a(c),$t!==null&&n.add($t),await Za(),c!==(c=e())){var v=u.selectionStart,d=u.selectionEnd,p=u.value.length;if(u.value=c??"",d!==null){var x=u.value.length;v===d&&d===p&&x>p?(u.selectionStart=x,u.selectionEnd=x):(u.selectionStart=v,u.selectionEnd=Math.min(d,x))}}}),(yt&&u.defaultValue!==u.value||Mt(e)==null&&u.value)&&(a(Zt(u)?Jt(u.value):u.value),$t!==null&&n.add($t)),Ja(()=>{var l=e();if(u===document.activeElement){var c=er??$t;if(n.has(c))return}Zt(u)&&l===Jt(u.value)||u.type==="date"&&!l&&!u.value||l!==u.value&&(u.value=l??"")})}function Zt(u){var e=u.type;return e==="number"||e==="range"}function Jt(u){return u===""?null:+u}function Et(u){var e=tr(0);return function(){return arguments.length===1?(B(e,t(e)+1),arguments[0]):(t(e),u())}}class _r{#e=ce("KEYBOARD");get activeSource(){return t(this.#e)}set activeSource(e){B(this.#e,e,!0)}listeners=[];constructor(){}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(a=>a!==e)}}emit(e,a,n){this.activeSource=a;const l={intent:e,source:a,meta:n};this.listeners.forEach(c=>c(l))}mount(e){const a=l=>{if(!s.isAppReady)return;Ve.updatePhysicalState(l,"down");const c=l.target,v=document.activeElement;if((c.tagName==="INPUT"||c.tagName==="TEXTAREA"||c.isContentEditable||c.closest('input, textarea, [contenteditable="true"]')||v?.tagName==="INPUT"||v?.tagName==="TEXTAREA"||v?.isContentEditable)&&l.key!=="Escape")return;const p=Ve.getIntent(l);p&&(l.preventDefault(),this.emit(p,"KEYBOARD"))},n=l=>{Ve.updatePhysicalState(l,"up")};return e.addEventListener("keydown",a),e.addEventListener("keyup",n),()=>{e.removeEventListener("keydown",a),e.removeEventListener("keyup",n)}}bindCanvas(e){const a=c=>{const v=c.pointerType==="pen"?"PEN":c.pointerType==="touch"?"TOUCH":"MOUSE";xt.handleStart(c,e),this.activeSource=v},n=c=>{xt.handleMove(c,e)},l=c=>{xt.handleEnd()};return e.addEventListener("pointerdown",a),window.addEventListener("pointermove",n),window.addEventListener("pointerup",l),()=>{e.removeEventListener("pointerdown",a),window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",l)}}}const ea=new _r;class Ar{isPlaying=!1;nextNoteTime=0;timer=null;get ctx(){return aa.ctx}scale=Xt.ambient.scale;chords=Xt.ambient.chords;currentChordIndex=0;toggle(){this.isPlaying?this.stop():this.start()}start(){this.isPlaying||(this.isPlaying=!0,this.nextNoteTime=this.ctx.currentTime,this.scheduler())}stop(){this.isPlaying=!1,clearTimeout(this.timer)}scheduler(){if(!this.isPlaying||s.studio.isMuted||!s.studio.isAmbientPlaying){this.timer=setTimeout(()=>this.scheduler(),100);return}for(;this.nextNoteTime<this.ctx.currentTime+.1;){this.playGenerativeNote(this.nextNoteTime);const e=.8+Math.random()*1.7;this.nextNoteTime+=e,Math.random()>.85&&(this.currentChordIndex=(this.currentChordIndex+1)%this.chords.length)}this.timer=setTimeout(()=>this.scheduler(),50)}playGenerativeNote(e){const a=this.chords[this.currentChordIndex],l=Math.random()>.3?a[Math.floor(Math.random()*a.length)]:this.scale[Math.floor(Math.random()*this.scale.length)];this.pianoPluck(l,e),this.pianoPluck(l*2,e,.08),Math.random()>.7&&this.pianoPluck(l*.5,e+.05,.1)}pianoPluck(e,a,n=.3){const{startMins:l,fullMins:c}=Xt.ambient.fade,v=s.usageMinutes;let d=0;v>=l&&v<c?d=(v-l)/(c-l):v>=c&&(d=1);const p=n*d*s.bgmVolume;if(p<.001)return;const x=this.ctx.createOscillator(),b=this.ctx.createGain(),h=this.ctx.createBiquadFilter();x.type=Math.random()>.5?"sine":"triangle",x.frequency.setValueAtTime(e,a),h.type="lowpass",h.frequency.setValueAtTime(1200,a),h.frequency.exponentialRampToValueAtTime(400,a+1.5),b.gain.setValueAtTime(0,a),b.gain.linearRampToValueAtTime(p,a+.02),b.gain.exponentialRampToValueAtTime(1e-4,a+2.5),x.connect(h),h.connect(b),b.connect(this.ctx.destination),x.start(a),x.stop(a+2.6)}}const yr=new Ar;class wr{#e=ce(!0);get isEnabled(){return t(this.#e)}set isEnabled(e){B(this.#e,e,!0)}#t=ce(!1);get screenShake(){return t(this.#t)}set screenShake(e){B(this.#t,e,!0)}#a=ce(null);get flashColor(){return t(this.#a)}set flashColor(e){B(this.#a,e,!0)}emit(e){this.isEnabled&&(this.playAudio(e),this.triggerVisual(e),typeof navigator.vibrate=="function"&&this.triggerHaptic(e))}playAudio(e){switch(e){case"DRAW":rt.playDraw();break;case"ERASE":rt.playErase();break;case"MOVE":rt.playMove();break;case"STARTUP":rt.playStartup();break;case"READY":rt.playReady();break}}triggerVisual(e){e==="CLEAR_CANVAS"&&(this.screenShake=!0,setTimeout(()=>this.screenShake=!1,200)),e==="READY"&&(this.flashColor="rgba(211, 54, 130, 0.1)",setTimeout(()=>this.flashColor=null,500))}triggerHaptic(e){e==="DRAW"&&navigator.vibrate(5),e==="ERASE"&&navigator.vibrate(10)}}const he=new wr;class kr{backupInterval=null;autoSaveTimer=null;unsubscribeInput=null;mount(){this.backupInterval=setInterval(()=>K.persistence.backup(),600*1e3),s.studio.mount(),s.canvas.mount();const e=async()=>{s.studio.isAudioReady||(await aa.resume(),yr.start(),s.studio.isAudioReady=!0,window.removeEventListener("pointerdown",e),window.removeEventListener("keydown",e))};window.addEventListener("pointerdown",e,{passive:!0}),window.addEventListener("keydown",e,{passive:!0}),xt.onActivity=()=>{s.cursor.resetInactivityTimer(),this.resetAutoSaveTimer()},ir(()=>import("../chunks/BZqdlsFf.js").then(n=>n.l),__vite__mapDeps([0,1,2]),import.meta.url).then(async({PersistenceService:n})=>{const l=new n,c=await ha.loadProject("autosave_session");c&&c.length>1e3&&(s.studio.showRecoveryPrompt=!0),l.loadGlobalPalettes()}),this.unsubscribeInput=ea.subscribe(n=>{this.handleIntent(n.intent)});const a=ea.mount(window);return()=>{this.unsubscribeInput&&this.unsubscribeInput(),a(),clearInterval(this.backupInterval),this.autoSaveTimer&&clearTimeout(this.autoSaveTimer)}}connectCanvas(e){return ea.bindCanvas(e)}handleIntent(e){if(aa.resume(),s.cursor.resetInactivityTimer(),this.resetAutoSaveTimer(),Ve.isCtrlActive&&Ve.isAltActive&&["MOVE_UP","MOVE_DOWN","MOVE_LEFT","MOVE_RIGHT"].includes(e)){const a=e==="MOVE_LEFT"?-1:e==="MOVE_RIGHT"?1:0,n=e==="MOVE_UP"?-1:e==="MOVE_DOWN"?1:0;s.studio.underlayOffset.x+=a,s.studio.underlayOffset.y+=n;return}this.handleNavigationIntent(e)||this.handleDrawIntent(e)||this.handleSelectionIntent(e)||this.handleProjectIntent(e)||this.handleViewportIntent(e)||this.handleToolSettingsIntent(e)||this.handleSystemIntent(e)}handleNavigationIntent(e){switch(e){case"MOVE_UP":return this.executeMove(0,-1),!0;case"MOVE_DOWN":return this.executeMove(0,1),!0;case"MOVE_LEFT":return this.executeMove(-1,0),!0;case"MOVE_RIGHT":return this.executeMove(1,0),!0;case"JUMP_HOME":return K.jumpHome(),!0;case"GOTO":return s.showGoTo=!0,!0;case"RESET_PAN":return s.studio.resetPan(),he.emit("READY"),!0}return!1}handleDrawIntent(e){switch(e){case"PAINT":return s.selection.isActive?K.selection.fillSelection():s.studio.activeTool!=="BRUSH"?K.draw.commitShape():K.draw.draw(),!0;case"ERASE":return s.selection.isActive?K.selection.eraseSelection():K.draw.erase(),!0;case"FLOOD_FILL":return K.color.floodFill(),!0;case"PICK_COLOR":return K.color.pickFromCanvas(),!0;case"RECOLOR":return K.manipulation.recolorAll(),!0}return!1}handleSelectionIntent(e){switch(e){case"BIND_VERTEX":return K.selection.addVertex(s.cursor.pos.x,s.cursor.pos.y),!0;case"SEAL_BINDING":return s.selection.vertices.length>=3?K.selection.commitPolygon():s.selection.isActive?K.selection.commit():s.studio.activeTool!=="BRUSH"?K.draw.commitShape():K.draw.draw(),!0;case"COPY":return K.clipboard.copy(),!0;case"CUT":return K.clipboard.cut(),!0;case"PASTE":return K.clipboard.paste(),!0;case"SELECT_ALL":return K.selection.selectAll(),!0;case"SELECT_SAME":return K.selection.magicWand(),!0}return!1}handleProjectIntent(e){switch(e){case"UNDO":return s.undo(),!0;case"REDO":return s.redo(),!0;case"SAVE":return s.showPersistenceMenu=!0,!0;case"OPEN":return K.persistence.load(),!0;case"NEW_ITEM":return s.studio.projectActiveTab==="frames"?K.project.addFrame():K.project.addLayer(),!0;case"NEW_LAYER_GROUP":return K.project.addGroup(),!0;case"DUPLICATE_ITEM":return s.studio.projectActiveTab==="frames"?K.project.duplicateFrame(s.project.activeFrameIndex):K.project.duplicateLayer(s.project.activeFrame.activeLayerIndex),!0;case"DELETE_ITEM":return s.studio.projectActiveTab==="frames"?K.project.removeFrame(s.project.activeFrameIndex):K.project.removeLayer(s.project.activeFrame.activeLayerIndex),!0;case"TOGGLE_LAYER_LOCK":return K.project.toggleLock(),!0;case"TOGGLE_LAYER_VISIBILITY":return K.project.toggleVisibility(),!0;case"MOVE_ITEM_UP":if(s.studio.projectActiveTab==="frames"){const a=s.project.activeFrameIndex;a<s.project.frames.length-1&&K.project.reorderFrame(a,a+1)}else K.project.moveLayerUp();return!0;case"MOVE_ITEM_DOWN":if(s.studio.projectActiveTab==="frames"){const a=s.project.activeFrameIndex;a>0&&K.project.reorderFrame(a,a-1)}else K.project.moveLayerDown();return!0;case"MOVE_ITEM_TOP":return s.studio.projectActiveTab==="frames"?K.project.reorderFrame(s.project.activeFrameIndex,s.project.frames.length-1):K.project.moveLayerToTop(),!0;case"MOVE_ITEM_BOTTOM":return s.studio.projectActiveTab==="frames"?K.project.reorderFrame(s.project.activeFrameIndex,0):K.project.moveLayerToBottom(),!0;case"MERGE_LAYERS":return K.project.mergeLayerDown(),!0;case"MERGE_SELECTED_LAYERS":return K.project.mergeSelectedLayers(),!0;case"MERGE_FRAMES":return K.project.mergeFrames(),!0;case"PLAY_PAUSE":return ma.togglePlayback(),!0;case"TOGGLE_GHOST_LAYERS":return s.showGhostLayers=!s.showGhostLayers,!0}return!1}handleViewportIntent(e){switch(e){case"ZOOM_IN":return s.studio.setZoom(.1),!0;case"ZOOM_OUT":return s.studio.setZoom(-.1),!0;case"RESET_ZOOM":return s.studio.resetZoom(),!0;case"RESET_VIEWPORT":return s.studio.resetZoom(),s.studio.resetPan(),he.emit("READY"),!0;case"FLIP_H":return K.manipulation.flip("horizontal"),!0;case"FLIP_V":return K.manipulation.flip("vertical"),!0;case"ROTATE":return K.manipulation.rotate(),!0;case"TAB_TIMELINE":return s.studio.projectActiveTab="frames",he.emit("READY"),!0;case"TAB_LAYERS":return s.studio.projectActiveTab="layers",he.emit("READY"),!0}return!1}handleToolSettingsIntent(e){switch(e){case"BRUSH_SIZE_INC":return s.studio.brushSize=Math.min(100,s.studio.brushSize+1),he.emit("READY"),!0;case"BRUSH_SIZE_DEC":return s.studio.brushSize=Math.max(1,s.studio.brushSize-1),he.emit("READY"),!0;case"TOGGLE_PATTERN_BRUSH":if(s.studio.isPatternBrushActive)s.studio.isPatternBrushActive=!1;else if(s.project.clipboard){const a=s.project.clipboard;s.studio.patternBrushData={width:a.width,height:a.height,data:new Uint32Array(a.data)},s.studio.isPatternBrushActive=!0}return he.emit("READY"),!0;case"TOGGLE_BRUSH_SHAPE":return s.studio.brushShape=s.studio.brushShape==="SQUARE"?"CIRCLE":"SQUARE",he.emit("READY"),!0;case"TOGGLE_AIRBRUSH":return s.studio.isAirbrushActive=!s.studio.isAirbrushActive,s.studio.show(_(s.studio.isAirbrushActive?"ui:studio.mist_active":"ui:studio.mist_off")),he.emit("READY"),!0;case"TOGGLE_PIXEL_PERFECT":return s.studio.isPixelPerfect=!s.studio.isPixelPerfect,he.emit("READY"),!0;case"TOGGLE_DITHER_BLEND":return s.studio.isDitherBlendActive=!s.studio.isDitherBlendActive,s.studio.show(_(s.studio.isDitherBlendActive?"ui:studio.blend_on":"ui:studio.blend_off")),he.emit("READY"),!0;case"TOGGLE_SHADE_LIGHTEN":case"SHADE_LIGHTEN":return s.studio.isShadingLighten=!s.studio.isShadingLighten,s.studio.isShadingLighten&&(s.studio.isShadingDarken=!1,s.studio.isShadingDither=!1),s.studio.show(_(s.studio.isShadingLighten?"ui:studio.light_roast_active":"ui:studio.light_roast_off")),he.emit("READY"),!0;case"TOGGLE_SHADE_DARKEN":case"SHADE_DARKEN":return s.studio.isShadingDarken=!s.studio.isShadingDarken,s.studio.isShadingDarken&&(s.studio.isShadingLighten=!1,s.studio.isShadingDither=!1),s.studio.show(_(s.studio.isShadingDarken?"ui:studio.dark_roast_active":"ui:studio.dark_roast_off")),he.emit("READY"),!0;case"TOGGLE_SHADE_DITHER":case"SHADE_DITHER":return s.studio.isShadingDither=!s.studio.isShadingDither,s.studio.isShadingDither&&(s.studio.isShadingLighten=!1,s.studio.isShadingDarken=!1),s.studio.show(_(s.studio.isShadingDither?"ui:studio.texture_active":"ui:studio.texture_off")),he.emit("READY"),!0;case"TOGGLE_COLOR_LOCK":if(s.studio.isColorLocked)s.studio.isColorLocked=!1,s.studio.colorLockSource=null;else{s.studio.isColorLocked=!0;const a=s.canvas.getColor(s.cursor.pos.x,s.cursor.pos.y);s.studio.colorLockSource=vt.uint32ToHex(a)}return he.emit("READY"),!0;case"POLY_SIDES_INC":return s.studio.polygonSides=Math.min(12,s.studio.polygonSides+1),s.studio.show(_("ui:studio.facets",{replace:{count:s.studio.polygonSides}})),he.emit("READY"),!0;case"POLY_SIDES_DEC":return s.studio.polygonSides=Math.max(3,s.studio.polygonSides-1),s.studio.show(_("ui:studio.facets",{replace:{count:s.studio.polygonSides}})),he.emit("READY"),!0;case"POLY_INDENT_INC":return s.studio.polygonIndentation=Math.min(100,s.studio.polygonIndentation+10),s.studio.show(_("ui:studio.steeping",{replace:{count:s.studio.polygonIndentation}})),he.emit("READY"),!0;case"POLY_INDENT_DEC":return s.studio.polygonIndentation=Math.max(0,s.studio.polygonIndentation-10),s.studio.show(_("ui:studio.steeping",{replace:{count:s.studio.polygonIndentation}})),he.emit("READY"),!0}return!1}handleSystemIntent(e){switch(e){case"OPEN_MENU":return s.showCommandPalette=!s.showCommandPalette,!0;case"OPEN_SETTINGS":return s.showSettings=!s.showSettings,!0;case"OPEN_PALETTE":return s.showColorPicker=!s.showColorPicker,!0;case"OPEN_AUDIO":return s.showAudioSettings=!s.showAudioSettings,!0;case"OPEN_EXPORT":return s.showExportMenu=!0,!0;case"OPEN_HELP":return s.showShortcuts=!0,!0;case"OPEN_MANUAL":return s.showManual=!0,!0;case"ESCAPE":return s.handleEscape(),!0;case"CLEAR_CANVAS":return K.manipulation.clearAll(),!0;case"TOGGLE_MUTE":return s.studio.toggleMute(),!0;case"TOGGLE_MINIMAP":return s.studio.showMinimap=!s.studio.showMinimap,he.emit("READY"),!0;case"TOGGLE_HAND_TOOL":return s.studio.isHandToolActive=!s.studio.isHandToolActive,he.emit("READY"),!0;case"CYCLE_SYMMETRY":const a=["OFF","HORIZONTAL","VERTICAL","QUADRANT"],n=a.indexOf(s.studio.symmetryMode);return s.studio.symmetryMode=a[(n+1)%a.length],he.emit("READY"),!0;case"TOGGLE_TILING":return s.studio.isTilingEnabled=!s.studio.isTilingEnabled,he.emit("READY"),!0;case"TOGGLE_ALPHA_LOCK":return s.studio.isAlphaLocked=!s.studio.isAlphaLocked,he.emit("READY"),!0;case"TOGGLE_UNDERLAY":return s.studio.isUnderlayVisible=!s.studio.isUnderlayVisible,he.emit("READY"),!0;case"OPEN_UNDERLAY_MENU":return s.studio.showUnderlayMenu=!s.studio.showUnderlayMenu,he.emit("READY"),!0;case"TOOL_RECTANGLE":return s.studio.activeTool="RECTANGLE",s.studio.shapeAnchor={...s.cursor.pos},he.emit("READY"),!0;case"TOOL_ELLIPSE":return s.studio.activeTool="ELLIPSE",s.studio.shapeAnchor={...s.cursor.pos},he.emit("READY"),!0;case"TOOL_POLYGON":return s.studio.activeTool="POLYGON",s.studio.shapeAnchor={...s.cursor.pos},he.emit("READY"),!0;case"TOOL_RECT_SELECT":return s.studio.activeTool="RECT_SELECT",he.emit("READY"),!0;case"TOOL_LASSO_SELECT":return s.studio.activeTool="LASSO_SELECT",he.emit("READY"),!0;case"TOOL_POLY_SELECT":return s.studio.activeTool="POLY_SELECT",he.emit("READY"),!0;case"TOOL_BRUSH":return s.studio.activeTool="BRUSH",he.emit("READY"),!0;case"TOOL_ERASER":return s.studio.activeTool="ERASER",he.emit("READY"),!0;case"TOOL_TRANSFORM":return s.selection.isActive&&(s.studio.isTransforming=!s.studio.isTransforming,he.emit("READY")),!0}if(e.startsWith("SET_SIDES_")){const a=parseInt(e.split("_")[2]);return s.studio.polygonSides=a,s.studio.show(_("ui:studio.facets",{replace:{count:a}})),he.emit("READY"),!0}if(e.startsWith("SELECT_COLOR_")){const a=parseInt(e.split("_")[2]);return K.color.select(a===0?9:a-1),!0}return!1}executeMove(e,a){if(s.studio.isTransforming&&s.selection.isActive){K.selection.nudge(e,a);return}const n=Ve.isCtrlActive&&Ve.isShiftActive,l=Ve.isCtrlActive&&!Ve.isShiftActive,c=Ve.isShiftActive&&!Ve.isCtrlActive;c&&!s.selection.start&&(s.studio.activeTool="RECT_SELECT",K.selection.begin(s.cursor.pos.x,s.cursor.pos.y)),K.movement.move(e,a)&&(c?K.selection.update(s.cursor.pos.x,s.cursor.pos.y):n?K.draw.erase():l&&K.draw.draw())}resetAutoSaveTimer(){this.autoSaveTimer&&clearTimeout(this.autoSaveTimer),this.autoSaveTimer=setTimeout(()=>{K.persistence.autoSaveSession()},1e4)}}const Xe=new kr;var Er=S('<div class="pixel-steam"></div>'),Lr=S('<div class="h-3 w-px bg-text-main/20" aria-hidden="true"></div>'),Sr=S('<div><div class="absolute -top-4 left-1/2 -translate-x-1/2"></div> <h1> </h1> <!> <p> </p></div>');function ya(u,e){ae(e,!0);let a=se(e,"size",3,"md");const n={sm:{h1:"text-2xl",p:"text-[9px]",gap:"gap-3"},md:{h1:"text-4xl",p:"text-[11px]",gap:"gap-2"},lg:{h1:"text-7xl",p:"text-[14px]",gap:"gap-4"}};let l=H(()=>n[a()]),c=H(()=>a()==="sm"?"flex-row items-center":"flex-col items-center");var v=Sr(),d=i(v);_e(d,20,()=>Array.from({length:3}),Le,(w,m,k)=>{var A=Er();pe(A,`
					animation: steam-drift ${2+k}s infinite ease-out; 
					animation-delay: ${k*.8}s;
					left: ${k*10-10}px;
				`),f(w,A)}),r(d);var p=o(d,2),x=i(p,!0);r(p);var b=o(p,2);{var h=w=>{var m=Lr();f(w,m)};O(b,w=>{a()==="sm"&&w(h)})}var g=o(b,2),y=i(g,!0);r(g),r(v),P((w,m)=>{oe(v,1,`relative flex ${t(c)??""} ${t(l).gap??""} justify-center text-center select-none`),oe(p,1,`font-tiny5 leading-none text-text-main ${t(l).h1??""} tracking-tighter`),E(x,w),oe(g,1,`font-serif font-bold tracking-[0.4em] text-text-main/40 uppercase ${t(l).p??""}`),E(y,m)},[()=>_("common:app.name"),()=>_("common:app.tagline")]),f(u,v),re()}var Cr=S("<button><!> <!></button>");function xe(u,e){ae(e,!0);let a=se(e,"variant",3,"secondary"),n=se(e,"size",3,"md"),l=se(e,"isActive",3,!1),c=se(e,"disabled",3,!1),v=se(e,"type",3,"button"),d=se(e,"class",3,"");const p={primary:"editor-primary-btn",secondary:"editor-secondary-btn",tool:"editor-tool-btn",ghost:"bg-transparent border-none shadow-none hover:bg-black/5 active:bg-black/10",danger:"bg-ui-danger text-white border-2 border-ui-structural shadow-[4px_4px_0px_var(--color-ui-structural)] hover:brightness-110 active:shadow-none active:translate-x-0.5 active:translate-y-0.5"},x={sm:"px-2 py-1 text-[10px]",md:"px-4 py-2 text-xs",lg:"px-6 py-3 text-sm"};var b=Cr(),h=i(b);{var g=m=>{var k=Te(),A=ne(k);Me(A,()=>e.icon),f(m,k)};O(h,m=>{e.icon&&m(g)})}var y=o(h,2);{var w=m=>{var k=Te(),A=ne(k);Me(A,()=>e.children),f(m,k)};O(y,m=>{e.children&&m(w)})}r(b),P((m,k)=>{z(b,"type",v()),b.disabled=c(),z(b,"aria-label",m),z(b,"title",k),oe(b,1,`
        relative flex cursor-pointer flex-nowrap items-center justify-center gap-2
        whitespace-nowrap select-none focus:ring-2 focus:ring-ui-accent
        focus:ring-offset-2 focus:outline-none disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50
        ${p[a()]??""}
        ${(a()!=="ghost"&&x[n()])??""}
        ${l()?"is-active tool-button":""}
        ${d()??""}
    `)},[()=>_(e.ariaLabel),()=>_(e.ariaLabel)]),te("click",b,function(...m){e.onclick?.apply(this,m)}),f(u,b),re()}Ae(["click"]);var tt=Et(()=>s),Tr=S('<span aria-hidden="true">üìñ</span> <span class="hidden xl:inline"> </span>',1),Ir=S('<span aria-hidden="true">üì¶</span> <span class="hidden xl:inline"> </span>',1),Pr=S('<span aria-hidden="true">üçÉ</span> <span class="hidden xl:inline"> </span>',1),jr=S('<span aria-hidden="true"> </span> <span class="hidden xl:inline"> </span>',1),$r=S('<span aria-hidden="true">üìú</span> <span class="hidden xl:inline"> </span>',1),Rr=S('<span aria-hidden="true">‚å®Ô∏è</span> <span class="hidden xl:inline"> </span>',1),Mr=S('<nav class="flex items-center gap-2" aria-label="Editor Tools"><div class="flex gap-1.5" role="group"><!> <!></div> <div class="mx-2 h-4 w-px bg-text-main/10" aria-hidden="true"></div> <div class="flex gap-1.5" role="group"><!> <!></div> <div class="mx-2 h-4 w-px bg-text-main/10" aria-hidden="true"></div> <div class="flex gap-1.5" role="group"><!> <!></div></nav>');function Or(u,e){ae(e,!1),je();var a=Mr(),n=i(a),l=i(n);xe(l,{variant:"tool",onclick:()=>tt(tt().showCommandPalette=!0),ariaLabel:"workspace:hud.menu.catalog_title",children:(g,y)=>{var w=Tr(),m=o(ne(w),2),k=i(m,!0);r(m),P(A=>E(k,A),[()=>_("workspace:hud.menu.catalog_title")]),f(g,w)},$$slots:{default:!0}});var c=o(l,2);xe(c,{variant:"tool",onclick:()=>tt(tt().showExportMenu=!0),ariaLabel:"export:title",children:(g,y)=>{var w=Ir(),m=o(ne(w),2),k=i(m,!0);r(m),P(A=>E(k,A),[()=>_("export:title")]),f(g,w)},$$slots:{default:!0}}),r(n);var v=o(n,4),d=i(v);xe(d,{variant:"tool",onclick:()=>tt().clearCanvas(),ariaLabel:"workspace:hud.actions.clear_canvas",children:(g,y)=>{var w=Pr(),m=o(ne(w),2),k=i(m,!0);r(m),P(A=>E(k,A),[()=>_("workspace:hud.actions.clear_canvas")]),f(g,w)},$$slots:{default:!0}});var p=o(d,2);xe(p,{variant:"tool",onclick:()=>tt(tt().showAudioSettings=!0),ariaLabel:"workspace:hud.audio.title",children:(g,y)=>{var w=jr(),m=ne(w),k=i(m,!0);r(m);var A=o(m,2),C=i(A,!0);r(A),P(T=>{E(k,tt().isMuted?"üîá":"üîä"),E(C,T)},[()=>_("workspace:hud.audio.title")]),f(g,w)},$$slots:{default:!0}}),r(v);var x=o(v,4),b=i(x);xe(b,{variant:"tool",onclick:()=>tt(tt().showManual=!0),ariaLabel:"manual:title",children:(g,y)=>{var w=$r(),m=o(ne(w),2),k=i(m,!0);r(m),P(A=>E(k,A),[()=>_("manual:title")]),f(g,w)},$$slots:{default:!0}});var h=o(b,2);xe(h,{variant:"tool",onclick:()=>tt(tt().showShortcuts=!0),ariaLabel:"shortcuts:title",children:(g,y)=>{var w=Rr(),m=o(ne(w),2),k=i(m,!0);r(m),P(A=>E(k,A),[()=>_("shortcuts:title")]),f(g,w)},$$slots:{default:!0}}),r(x),r(a),f(u,a),re()}var Dr=S('<div class="relative flex h-full w-full items-center justify-center overflow-hidden"><span>‚òÄÔ∏è</span> <span>üåô</span></div>');function zr(u,e){ae(e,!1);const a=s.studio;function n(){rt.playCeramicSlide(),a.toggleTheme()}je(),xe(u,{variant:"ghost",size:"sm",onclick:n,ariaLabel:"ui:labels.switch_theme",class:"relative h-8 w-8 !p-0",children:(l,c)=>{var v=Dr(),d=i(v),p=o(d,2);r(v),P(()=>{oe(d,1,`text-lg transition-transform duration-500 ${a.theme==="light"?"translate-y-0":"translate-y-10"}`),oe(p,1,`absolute text-lg transition-transform duration-500 ${a.theme==="dark"?"translate-y-0":"-translate-y-10"}`)}),f(l,v)},$$slots:{default:!0}}),re()}var Fr=S('<header class="hud-panel flex h-14 w-full items-center justify-between px-8 py-2 select-none svelte-dk19pb"><div class="flex items-center gap-12"><!> <div class="h-6 w-px bg-text-main/10" aria-hidden="true"></div> <!></div> <div class="flex items-center gap-6"><!> <!></div></header>');function Nr(u){var e=Fr(),a=i(e),n=i(a);ya(n,{size:"sm"});var l=o(n,4);Or(l,{}),r(a);var c=o(a,2),v=i(c);zr(v,{}),o(v,2),r(c),r(e),f(u,e)}const Br=u=>u;function ia(u){const e=u-1;return e*e*e+1}function la(u){const e=typeof u=="string"&&u.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[u,"px"]}function be(u,{delay:e=0,duration:a=400,easing:n=Br}={}){const l=+getComputedStyle(u).opacity;return{delay:e,duration:a,easing:n,css:c=>`opacity: ${c*l}`}}function Yt(u,{delay:e=0,duration:a=400,easing:n=ia,x:l=0,y:c=0,opacity:v=0}={}){const d=getComputedStyle(u),p=+d.opacity,x=d.transform==="none"?"":d.transform,b=p*(1-v),[h,g]=la(l),[y,w]=la(c);return{delay:e,duration:a,easing:n,css:(m,k)=>`
			transform: ${x} translate(${(1-m)*h}${g}, ${(1-m)*y}${w});
			opacity: ${p-b*k}`}}function wa(u,{delay:e=0,duration:a=400,easing:n=ia,axis:l="y"}={}){const c=getComputedStyle(u),v=+c.opacity,d=l==="y"?"height":"width",p=parseFloat(c[d]),x=l==="y"?["top","bottom"]:["left","right"],b=x.map(A=>`${A[0].toUpperCase()}${A.slice(1)}`),h=parseFloat(c[`padding${b[0]}`]),g=parseFloat(c[`padding${b[1]}`]),y=parseFloat(c[`margin${b[0]}`]),w=parseFloat(c[`margin${b[1]}`]),m=parseFloat(c[`border${b[0]}Width`]),k=parseFloat(c[`border${b[1]}Width`]);return{delay:e,duration:a,easing:n,css:A=>`overflow: hidden;opacity: ${Math.min(A*20,1)*v};${d}: ${A*p}px;padding-${x[0]}: ${A*h}px;padding-${x[1]}: ${A*g}px;margin-${x[0]}: ${A*y}px;margin-${x[1]}: ${A*w}px;border-${x[0]}-width: ${A*m}px;border-${x[1]}-width: ${A*k}px;min-${d}: 0`}}function Lt(u,{delay:e=0,duration:a=400,easing:n=ia,start:l=0,opacity:c=0}={}){const v=getComputedStyle(u),d=+v.opacity,p=v.transform==="none"?"":v.transform,x=1-l,b=d*(1-c);return{delay:e,duration:a,easing:n,css:(h,g)=>`
			transform: ${p} scale(${1-x*g});
			opacity: ${d-b*g}
		`}}var Gr=S('<div class="flex items-center justify-between px-1"><label class="text-[10px] font-bold tracking-widest text-text-main/70 uppercase"> </label> <span class="font-mono text-[10px] text-text-main/90"> </span></div>'),Hr=S(`<div><!> <div class="relative flex h-8 w-full items-center"><div class="absolute h-1.5 w-full overflow-hidden rounded-full border border-ui-structural bg-grid-border"><div class="h-full border-r border-ui-structural bg-ui-accent"></div></div> <input type="range" class="
                absolute inset-0 h-full w-full cursor-pointer opacity-0
                disabled:cursor-not-allowed
            "/> <div class="
                pointer-events-none absolute flex h-4 w-4 items-center justify-center
                rounded-sm border-2 border-ui-structural
                bg-canvas-bg shadow-[2px_2px_0px_var(--color-ui-structural)]
            "><div class="h-1.5 w-1.5 rounded-full bg-ui-structural opacity-20"></div></div></div></div>`);function nt(u,e){ae(e,!0);let a=se(e,"value",15),n=se(e,"min",3,0),l=se(e,"max",3,100),c=se(e,"step",3,1),v=se(e,"disabled",3,!1),d=se(e,"class",3,"");const p=`slider-${Math.random().toString(36).slice(2,9)}`;let x=H(()=>(a()-n())/(l()-n())*100);function b(L){const I=L.target,$=Number(I.value);a($),e.oninput&&e.oninput($)}function h(L){const I=L.target,$=Number(I.value);e.onchange&&e.onchange($)}var g=Hr(),y=i(g);{var w=L=>{var I=Gr(),$=i(I),j=i($,!0);r($);var R=o($,2),F=i(R,!0);r(R),r(I),P(ee=>{z($,"for",p),E(j,ee),E(F,a())},[()=>_(e.label)]),f(L,I)};O(y,L=>{e.label&&L(w)})}var m=o(y,2),k=i(m),A=i(k);r(k);var C=o(k,2);kt(C);var T=o(C,2);r(m),r(g),P(L=>{oe(g,1,`flex w-full flex-col gap-1.5 ${d()??""}`),pe(A,`width: ${t(x)??""}%`),z(C,"id",p),z(C,"min",n()),z(C,"max",l()),z(C,"step",c()),C.disabled=v(),z(C,"aria-label",L),z(C,"aria-valuemin",n()),z(C,"aria-valuemax",l()),z(C,"aria-valuenow",a()),pe(T,`left: calc(${t(x)??""}% - 8px)`)},[()=>_(e.ariaLabel)]),te("input",C,b),te("change",C,h),Ot(C,a),f(u,g),re()}Ae(["input","change"]);var Ur=S('<span class="text-xs font-bold tracking-widest text-text-main/90 uppercase"> </span>'),Vr=S('<div><button type="button" role="switch"><div></div></button> <!></div>');function Kt(u,e){ae(e,!0);let a=se(e,"checked",15),n=se(e,"disabled",3,!1),l=se(e,"class",3,"");function c(){n()||(a(!a()),e.onchange&&e.onchange(a()))}var v=Vr(),d=i(v),p=i(d);r(d);var x=o(d,2);{var b=h=>{var g=Ur(),y=i(g,!0);r(g),P(w=>E(y,w),[()=>_(e.label)]),f(h,g)};O(x,h=>{e.label&&h(b)})}r(v),P((h,g)=>{oe(v,1,`flex items-center gap-3 ${l()??""}`),z(d,"aria-checked",a()),z(d,"aria-label",h),z(d,"title",g),d.disabled=n(),oe(d,1,`
            relative flex h-6 w-10 cursor-pointer items-center rounded-full border-2
            border-ui-structural bg-grid-border transition-all select-none
            disabled:cursor-not-allowed disabled:opacity-50
            ${a()?"bg-ui-accent":""}
        `),oe(p,1,`
                absolute left-1 h-4 w-4 rounded-full border border-ui-structural
                bg-canvas-bg shadow-[1px_1px_0px_var(--color-ui-structural)] transition-transform duration-100
                ease-in-out
                ${a()?"translate-x-4":""}
            `)},[()=>_(e.ariaLabel),()=>_(e.ariaLabel)]),te("click",d,c),f(u,v),re()}Ae(["click"]);var Yr=S('<div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <div class="flex items-center justify-between"><div class="flex flex-col"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/40 uppercase"> </span> <span class="font-serif text-[8px] text-text-main/30 italic"> </span></div> <!></div> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <!> <!>',1),Kr=S('<div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <div class="flex flex-col gap-1 rounded-lg bg-ui-accent/5 p-2 ring-1 ring-ui-accent/10"><span class="font-serif text-[10px] font-bold tracking-widest text-ui-accent uppercase"> </span> <span class="font-serif text-[8px] leading-tight text-ui-accent/60 italic"> </span></div>',1),Qr=S('<div class="mr-2 mb-2 flex flex-col gap-4 rounded-xl border border-text-main/5 bg-white/40 p-4 pt-2 shadow-sm backdrop-blur-sm"><!> <!> <!></div>');function ca(u,e){ae(e,!0);let a=se(e,"target",7),n=H(()=>"isLinked"in a()),l=H(()=>"duration"in a());var c=Qr(),v=i(c);nt(v,{label:"workspace:project_panel.opacity",min:0,max:1,step:.01,ariaLabel:"workspace:project_panel.opacity",get value(){return a().opacity},set value(h){a().opacity=h}});var d=o(v,2);{var p=h=>{var g=Yr(),y=o(ne(g),2),w=i(y),m=i(w),k=i(m,!0);r(m);var A=o(m,2),C=i(A,!0);r(A),r(w);var T=o(w,2);Kt(T,{ariaLabel:"workspace:hud.sync_label",get checked(){return a().isLinked},set checked($){a().isLinked=$}}),r(y);var L=o(y,4);nt(L,{label:"export:wiggle_modifier",min:0,max:5,step:.5,ariaLabel:"export:wiggle_modifier",get value(){return a().wiggleAmount},set value($){a().wiggleAmount=$}});var I=o(L,2);nt(I,{label:"export:sway_modifier",min:0,max:20,step:1,ariaLabel:"export:sway_modifier",get value(){return a().swayAmount},set value($){a().swayAmount=$}}),P(($,j)=>{E(k,$),E(C,j)},[()=>_("workspace:hud.sync_label"),()=>_("workspace:hud.sync_desc")]),f(h,g)};O(d,h=>{t(n)&&h(p)})}var x=o(d,2);{var b=h=>{var g=Kr(),y=o(ne(g),2),w=i(y),m=i(w,!0);r(w);var k=o(w,2),A=i(k,!0);r(k),r(y),P((C,T)=>{E(m,C),E(A,T)},[()=>_("workspace:hud.master_pace_label"),()=>_("workspace:hud.master_pace_desc")]),f(h,g)};O(x,h=>{t(l)&&h(b)})}r(c),fe(3,c,()=>be,()=>({duration:100})),f(u,c),re()}var qr=S("<div></div>"),Wr=S('<button type="button" role="tab"><!> <!></button>'),Xr=S('<div role="tablist"></div>');function ka(u,e){ae(e,!0);let a=se(e,"tabs",19,()=>[]),n=se(e,"activeTab",15),l=se(e,"class",3,""),c=se(e,"variant",3,"horizontal");function v(p){p.disabled||(n(p.id),e.onchange&&e.onchange(p.id))}var d=Xr();_e(d,21,a,Le,(p,x)=>{var b=Wr(),h=i(b);{var g=k=>{var A=Te(),C=ne(A);Me(C,()=>t(x).icon),f(k,A)};O(h,k=>{t(x).icon&&k(g)})}var y=o(h),w=o(y);{var m=k=>{var A=qr();P(()=>oe(A,1,`
                        absolute bg-ui-accent
                        ${c()==="horizontal"?"bottom-0 left-0 h-1 w-full":"top-0 right-0 h-full w-1"}
                    `)),f(k,A)};O(w,k=>{n()===t(x).id&&k(m)})}r(b),P(k=>{z(b,"aria-selected",n()===t(x).id),z(b,"aria-disabled",t(x).disabled),b.disabled=t(x).disabled,oe(b,1,`
                relative flex flex-1 items-center justify-center gap-3 px-6 py-3
                text-[10px] font-bold tracking-widest uppercase transition-all
                				${n()===t(x).id?"border-ui-structural bg-canvas-bg text-text-main":t(x).disabled?"text-text-main/20":"text-text-main/40 hover:bg-text-main/5 hover:text-text-main/70"}                ${c()==="horizontal"?"-mb-0.5 border-x-2 border-t-2 first:border-l-0 last:border-r-0":"-mr-0.5 border-y-2 border-l-2 first:border-t-0 last:border-b-0"}
				${t(x).disabled?"cursor-not-allowed opacity-30 grayscale":""}
            `),E(y,` ${k??""} `)},[()=>_(t(x).label)]),te("click",b,()=>v(t(x))),f(p,b)}),r(d),P(p=>{z(d,"aria-label",p),oe(d,1,`
    flex ${c()==="horizontal"?"flex-row border-b-2":"flex-col border-r-2"}
    w-full border-ui-structural bg-sidebar-bg/10 ${l()??""}
`)},[()=>_(e.ariaLabel)]),f(u,d),re()}Ae(["click"]);var Zr=S('<input type="text" class="w-full bg-ui-accent/5 font-serif text-sm font-medium text-ui-accent ring-1 ring-ui-accent/30 outline-none"/>'),Jr=S('<button class="shrink-0 text-[10px] opacity-0 transition-opacity group-hover:opacity-40 hover:text-ui-accent">üóëÔ∏è</button>'),ei=S('<div role="button" tabindex="0" draggable="true"><div class="flex min-w-0 flex-1 items-center gap-2 overflow-hidden"><span class="w-4 shrink-0 text-center font-mono text-[9px] font-bold opacity-20" aria-hidden="true"> </span> <button> </button> <button><!></button></div> <div class="flex shrink-0 items-center gap-1.5 pl-2"><button class="shrink-0 text-[10px] opacity-0 transition-opacity group-hover:opacity-40 hover:text-ui-accent"> </button> <button class="shrink-0 text-[10px] opacity-0 transition-opacity group-hover:opacity-40 hover:text-ui-accent">üìã</button> <!></div></div>');function ti(u,e){ae(e,!0);let a=se(e,"tempName",15);function n(L){L.focus(),L.select()}var l=ei(),c=i(l),v=i(c),d=i(v,!0);r(v);var p=o(v,2),x=i(p,!0);r(p);var b=o(p,2),h=i(b);{var g=L=>{var I=Zr();kt(I),Vt(()=>Ot(I,a)),_a(I,$=>n?.($)),Oe("blur",I,function(...$){e.onCommitRename?.apply(this,$)}),te("keydown",I,$=>{$.stopPropagation(),$.key==="Enter"&&e.onCommitRename(),$.key==="Escape"&&e.onCancelRename()}),f(L,I)},y=L=>{var I=ve();P(()=>E(I,e.frame.name)),f(L,I)};O(h,L=>{e.isEditing?L(g):L(y,!1)})}r(b),r(c);var w=o(c,2),m=i(w),k=i(m,!0);r(m);var A=o(m,2),C=o(A,2);{var T=L=>{var I=Jr();P($=>z(I,"title",$),[()=>_("workspace:hud.actions.delete")]),te("click",I,$=>{$.stopPropagation(),K.project.removeFrame(e.index)}),f(L,I)};O(C,L=>{s.project.frames.length>1&&L(T)})}r(w),r(l),P((L,I,$)=>{oe(l,1,`group flex cursor-grab items-center justify-between rounded px-2 transition-all ${e.isSelected?"bg-ui-accent/10 text-ui-accent ring-1 ring-ui-accent/20":"hover:bg-text-main/5"} ${e.isActive?"bg-ui-accent/5 font-bold":""} ${e.isDropTarget?"shadow-[0_-2px_0_var(--color-ui-accent)]":""} ${e.isDragged?"opacity-40":""}`),z(l,"aria-current",e.isActive?"true":void 0),E(d,e.index+1),oe(p,1,`shrink-0 text-xs transition-opacity ${e.frame.isVisible?"opacity-100":"opacity-20"}`),z(p,"title",L),E(x,e.frame.isVisible?"üëÅÔ∏è":"üï∂Ô∏è"),oe(b,1,`min-w-0 flex-1 truncate py-2 text-left font-serif text-sm font-medium text-text-main ${e.frame.isVisible?"":"opacity-40"}`),z(m,"title",I),E(k,e.activePropertiesType==="frame"&&e.activePropertiesIndex===e.index?"üîº":"‚öôÔ∏è"),z(A,"title",$)},[()=>e.frame.isVisible?_("workspace:hud.project_panel.active"):_("workspace:hud.project_panel.visibility"),()=>_("workspace:hud.project_panel.properties"),()=>_("workspace:hud.actions.duplicate")]),te("click",l,L=>L.stopPropagation()),te("keydown",l,L=>{(L.key==="Enter"||L.key===" ")&&e.onSelect(e.index,L)}),Oe("dragstart",l,()=>e.onDragStart(e.index)),Oe("dragover",l,L=>e.onDragOver(L,e.index)),Oe("drop",l,L=>e.onDrop(L,e.index)),Oe("dragend",l,function(...L){e.onDragEnd?.apply(this,L)}),te("contextmenu",l,function(...L){e.oncontextmenu?.apply(this,L)}),te("click",p,L=>{L.stopPropagation(),K.project.toggleFrameVisibility(e.index)}),te("click",b,L=>e.onSelect(e.index,L)),te("dblclick",b,()=>e.onStartRename(e.index,e.frame.name)),te("click",m,L=>e.onToggleProperties(e.index,L)),te("click",A,L=>{L.stopPropagation(),K.project.duplicateFrame(e.index)}),f(u,l),re()}Ae(["click","keydown","contextmenu","dblclick"]);var ai=S('<button class="w-4 shrink-0 text-center text-[10px] opacity-40 hover:opacity-100"> </button>'),ri=S('<div class="w-4 shrink-0"></div>'),ii=S('<input type="text" class="w-full bg-ui-accent/5 font-serif text-sm font-medium text-ui-accent ring-1 ring-ui-accent/30 outline-none"/>'),si=S('<div role="button" tabindex="0" draggable="true"><div class="flex min-w-0 flex-1 items-center gap-2 overflow-hidden"><!> <button> </button> <button><!></button></div> <div class="flex shrink-0 items-center gap-1.5 pl-2"><button class="shrink-0 text-[10px] opacity-0 transition-opacity group-hover:opacity-40 hover:text-ui-accent"> </button> <button> </button> <button class="shrink-0 text-[10px] opacity-0 transition-opacity group-hover:opacity-40 hover:text-ui-accent">üóëÔ∏è</button></div></div>');function oi(u,e){ae(e,!0);let a=se(e,"layer",7),n=se(e,"tempName",15),l=H(()=>a().parentId!==null);function c(j){j.focus(),j.select()}var v=si(),d=i(v),p=i(d);{var x=j=>{var R=ai(),F=i(R,!0);r(R),P(()=>E(F,a().isCollapsed?"‚ñ∂":"‚ñº")),te("click",R,ee=>{ee.stopPropagation(),a().isCollapsed=!a().isCollapsed}),f(j,R)},b=j=>{var R=ri();f(j,R)};O(p,j=>{a().type==="FOLDER"?j(x):j(b,!1)})}var h=o(p,2),g=i(h,!0);r(h);var y=o(h,2),w=i(y);{var m=j=>{var R=ii();kt(R),Vt(()=>Ot(R,n)),_a(R,F=>c?.(F)),Oe("blur",R,function(...F){e.onCommitRename?.apply(this,F)}),te("keydown",R,F=>{F.stopPropagation(),F.key==="Enter"&&e.onCommitRename(),F.key==="Escape"&&e.onCancelRename()}),f(j,R)},k=j=>{var R=ve();P(()=>E(R,a().name)),f(j,R)};O(w,j=>{e.isEditing?j(m):j(k,!1)})}r(y),r(d);var A=o(d,2),C=i(A),T=i(C,!0);r(C);var L=o(C,2),I=i(L,!0);r(L);var $=o(L,2);r(A),r(v),P((j,R,F,ee)=>{oe(v,1,`group flex cursor-grab items-center justify-between rounded px-2 transition-all ${e.isSelected?"bg-ui-accent/10 text-ui-accent ring-1 ring-ui-accent/20":"hover:bg-text-main/5"} ${e.isActive?"bg-ui-accent/5 font-bold":""} ${e.isDropTarget?"shadow-[0_-2px_0_var(--color-ui-accent)]":""} ${e.isDragged?"opacity-40":""}`),pe(v,t(l)?"margin-left: 12px;":""),z(v,"aria-current",e.isActive?"true":void 0),oe(h,1,`shrink-0 text-xs transition-opacity ${a().isVisible?"opacity-100":"opacity-20"}`),z(h,"title",j),E(g,a().isVisible?a().type==="FOLDER"?"üìÇ":"üëÅÔ∏è":a().type==="FOLDER"?"üìÅ":"üï∂Ô∏è"),oe(y,1,`min-w-0 flex-1 truncate py-2 text-left font-serif text-sm font-medium text-text-main ${a().isVisible?"":"opacity-40"}`),z(C,"title",R),E(T,e.activePropertiesType==="layer"&&e.activePropertiesIndex===e.index?"üîº":"‚öôÔ∏è"),oe(L,1,`shrink-0 text-[10px] transition-opacity ${a().isLocked?"opacity-100":"opacity-20"}`),z(L,"title",F),E(I,a().isLocked?"üîí":"üîì"),z($,"title",ee)},[()=>_("workspace:hud.project_panel.visibility"),()=>_("workspace:hud.project_panel.properties"),()=>_("workspace:hud.project_panel.lock"),()=>_("workspace:hud.actions.delete")]),te("click",v,j=>j.stopPropagation()),te("keydown",v,j=>{(j.key==="Enter"||j.key===" ")&&e.onSelect(e.index,j)}),Oe("dragstart",v,()=>e.onDragStart(e.index)),Oe("dragover",v,j=>e.onDragOver(j,e.index)),Oe("drop",v,j=>e.onDrop(j,e.index)),Oe("dragend",v,function(...j){e.onDragEnd?.apply(this,j)}),te("contextmenu",v,function(...j){e.oncontextmenu?.apply(this,j)}),te("click",h,j=>{j.stopPropagation(),K.project.toggleVisibility(e.index)}),te("click",y,j=>e.onSelect(e.index,j)),te("dblclick",y,()=>e.onStartRename(e.index,a().name)),te("click",C,j=>e.onToggleProperties(e.index,j)),te("click",L,j=>{j.stopPropagation(),K.project.toggleLock(e.index)}),te("click",$,j=>{j.stopPropagation(),K.project.removeLayer(e.index)}),f(u,v),re()}Ae(["click","keydown","contextmenu","dblclick"]);var ni=S("<!> <!>",1),li=S('<div class="flex flex-col gap-1" role="list"></div>'),ci=S("<!> <!>",1),di=S('<div class="flex flex-col gap-1" role="list"></div>'),vi=S('<span aria-hidden="true">Ôºã</span> ',1),ui=S('<span aria-hidden="true">üìÅ</span> ',1),pi=S('<div class="flex h-full w-full flex-col overflow-hidden bg-transparent" role="region" aria-label="Project Explorer"><!> <div class="custom-scrollbar flex-1 overflow-y-auto p-2" role="presentation"><!></div> <div class="flex items-center justify-between border-t border-text-main/5 bg-text-main/5 px-4 py-2"><div class="flex items-center gap-3"><!> <!></div> <span class="font-mono text-[8px] font-bold text-text-main/20 uppercase"> </span></div></div>');function fi(u,e){ae(e,!0);let a=ce(null),n=ce(null),l=ce(null),c=ce(""),v=ce(null),d=ce(null);function p(N,W,M){M.stopPropagation(),rt.playPaperFlip(),t(v)===N&&t(d)===W?(B(v,null),B(d,null)):(B(v,N,!0),B(d,W,!0))}function x(N,W){B(l,N,!0),B(c,W,!0)}function b(){t(l)!==null&&(s.studio.projectActiveTab==="layers"?s.project.activeFrame.layers[t(l)].name=t(c):s.project.frames[t(l)].name=t(c),B(l,null))}function h(N){B(a,N,!0)}function g(N,W){N.preventDefault(),B(n,W,!0)}function y(N,W){N.preventDefault(),t(a)!==null&&(s.studio.projectActiveTab==="layers"?K.project.reorderLayer(t(a),W):K.project.reorderFrame(t(a),W)),B(a,null),B(n,null)}function w(){B(a,null),B(n,null)}function m(){const N=s.project;N.selectedFrameIndices=new Set([N.activeFrameIndex]);const W=N.activeFrame;W.selectedLayerIndices=new Set([W.activeLayerIndex])}function k(N,W){const M=s.project;if(W.ctrlKey||W.metaKey)M.selectedFrameIndices.has(N)&&M.selectedFrameIndices.size>1?M.selectedFrameIndices.delete(N):M.selectedFrameIndices.add(N);else if(W.shiftKey){const X=Math.min(M.activeFrameIndex,N),Y=Math.max(M.activeFrameIndex,N),ie=new Set;for(let q=X;q<=Y;q++)ie.add(q);M.selectedFrameIndices=ie}else M.selectedFrameIndices=new Set([N]);M.activeFrameIndex=N}function A(N,W){const M=s.project.activeFrame;if(W.ctrlKey||W.metaKey)M.selectedLayerIndices.has(N)&&M.selectedLayerIndices.size>1?M.selectedLayerIndices.delete(N):M.selectedLayerIndices.add(N);else if(W.shiftKey){const X=Math.min(M.activeLayerIndex,N),Y=Math.max(M.activeLayerIndex,N),ie=new Set;for(let q=X;q<=Y;q++)ie.add(q);M.selectedLayerIndices=ie}else M.selectedLayerIndices=new Set([N]);M.activeLayerIndex=N}function C(N,W){N.preventDefault();const M=s.project;M.selectedFrameIndices.has(W)||(M.selectedFrameIndices=new Set([W]),M.activeFrameIndex=W);const X=M.selectedFrameIndices.size>1;s.studio.contextMenu={x:N.clientX,y:N.clientY,items:[{label:X?_("workspace:hud.context_menu.duplicate_frames",{replace:{count:M.selectedFrameIndices.size}}):_("workspace:hud.actions.duplicate"),icon:"üìã",action:()=>{K.project.duplicateFrame(W)}},...X?[{label:_("actions:merge_frames"),icon:"üçµ",action:()=>K.project.mergeFrames()}]:[],{label:_("workspace:hud.context_menu.add_flavor_tag"),icon:"üè∑Ô∏è",action:()=>{const Y=prompt("Tag Name:","New Sequence");if(Y){const ie=Array.from(M.selectedFrameIndices).sort((q,le)=>q-le);K.project.addTag(Y,ie[0],ie[ie.length-1])}}},{label:X?_("workspace:hud.context_menu.delete_frames",{replace:{count:M.selectedFrameIndices.size}}):_("actions:delete_frame"),icon:"üóëÔ∏è",danger:!0,disabled:M.frames.length<=M.selectedFrameIndices.size,action:()=>{Array.from(M.selectedFrameIndices).sort((ie,q)=>ie-q).reverse().forEach(ie=>K.project.removeFrame(ie)),M.selectedFrameIndices=new Set([M.activeFrameIndex])}}]}}function T(N,W){const M=s.project.activeFrame;N.preventDefault(),M.selectedLayerIndices.has(W)||(M.selectedLayerIndices=new Set([W]),M.activeLayerIndex=W);const X=M.selectedLayerIndices.size>1,Y=M.layers[W];s.studio.contextMenu={x:N.clientX,y:N.clientY,items:[{label:X?_("workspace:hud.context_menu.group_selected"):_("workspace:hud.context_menu.group"),icon:"üìÅ",action:()=>{const ie=K.project.addGroup();X?Array.from(M.selectedLayerIndices).forEach(le=>{const ye=M.layers[le];ye!==ie&&(ye.parentId=ie.id)}):Y.parentId=ie.id}},{label:X?_("workspace:hud.context_menu.duplicate_layers",{replace:{count:M.selectedLayerIndices.size}}):_("workspace:hud.actions.duplicate"),icon:"üìã",disabled:X,action:()=>K.project.duplicateLayer(W)},{label:X?_("actions:merge_selected_layers"):_("actions:merge_layers"),icon:"üé®",disabled:!X&&W===0,action:()=>{X?K.project.mergeSelectedLayers():K.project.mergeLayerDown()}},{label:X?_("workspace:hud.context_menu.show_infusion"):Y.isVisible?_("workspace:hud.context_menu.hide_infusion"):_("workspace:hud.context_menu.show_infusion"),icon:Y.isVisible?"üï∂Ô∏è":"üëÅÔ∏è",action:()=>{const ie=Array.from(M.selectedLayerIndices),q=!Y.isVisible;ie.forEach(le=>M.layers[le].isVisible=q),s.canvas.incrementVersion()}},{label:X?_("workspace:hud.context_menu.lock_infusion"):Y.isLocked?_("workspace:hud.context_menu.unlock_infusion"):_("workspace:hud.context_menu.lock_infusion"),icon:Y.isLocked?"üîì":"üîí",action:()=>{Array.from(M.selectedLayerIndices).forEach(q=>K.project.toggleLock(q))}},{label:_("actions:delete_layer"),icon:"üóëÔ∏è",danger:!0,disabled:M.layers.length<=M.selectedLayerIndices.size,action:()=>{Array.from(M.selectedLayerIndices).sort((q,le)=>le-q).forEach(q=>K.project.removeLayer(q)),M.selectedLayerIndices=new Set([M.activeLayerIndex])}}]}}const L=[{id:"frames",label:"workspace:hud.project_panel.frames"},{id:"layers",label:"workspace:hud.project_panel.layers"}];var I=pi(),$=i(I);ka($,{get tabs(){return L},ariaLabel:"ui:labels.project_tabs",onchange:()=>{rt.playPaperFlip()},get activeTab(){return s.studio.projectActiveTab},set activeTab(N){s.studio.projectActiveTab=N}});var j=o($,2),R=i(j);{var F=N=>{var W=li();_e(W,21,()=>s.project.frames,Le,(M,X,Y)=>{var ie=ni(),q=ne(ie);{let Se=H(()=>s.project.selectedFrameIndices.has(Y)),Q=H(()=>Y===s.project.activeFrameIndex),Ce=H(()=>t(l)===Y),we=H(()=>t(n)===Y&&t(a)!==Y),me=H(()=>t(a)===Y);ti(q,{get frame(){return t(X)},index:Y,get isSelected(){return t(Se)},get isActive(){return t(Q)},get isEditing(){return t(Ce)},get isDropTarget(){return t(we)},get isDragged(){return t(me)},get activePropertiesType(){return t(v)},get activePropertiesIndex(){return t(d)},onSelect:k,onToggleProperties:(Ie,Ne)=>p("frame",Ie,Ne),onStartRename:x,onCommitRename:b,onCancelRename:()=>B(l,null),onDragStart:h,onDragOver:g,onDrop:y,onDragEnd:w,oncontextmenu:Ie=>C(Ie,Y),get tempName(){return t(c)},set tempName(Ie){B(c,Ie,!0)}})}var le=o(q,2);{var ye=Se=>{ca(Se,{get target(){return t(X)}})};O(le,Se=>{t(v)==="frame"&&t(d)===Y&&Se(ye)})}f(M,ie)}),r(W),fe(3,W,()=>be,()=>({duration:150})),f(N,W)},ee=N=>{var W=di();_e(W,21,()=>s.project.activeFrame.layers,Le,(M,X,Y)=>{const ie=H(()=>t(X).parentId?s.project.activeFrame.layers.find(Se=>Se.id===t(X).parentId):null);var q=Te(),le=ne(q);{var ye=Se=>{var Q=ci(),Ce=ne(Q);{let Ie=H(()=>s.project.activeFrame.selectedLayerIndices.has(Y)),Ne=H(()=>Y===s.project.activeFrame.activeLayerIndex),et=H(()=>t(l)===Y),it=H(()=>t(n)===Y&&t(a)!==Y),st=H(()=>t(a)===Y);oi(Ce,{get layer(){return t(X)},index:Y,get isSelected(){return t(Ie)},get isActive(){return t(Ne)},get isEditing(){return t(et)},get isDropTarget(){return t(it)},get isDragged(){return t(st)},get activePropertiesType(){return t(v)},get activePropertiesIndex(){return t(d)},onSelect:A,onToggleProperties:(Qe,ut)=>p("layer",Qe,ut),onStartRename:x,onCommitRename:b,onCancelRename:()=>B(l,null),onDragStart:h,onDragOver:g,onDrop:y,onDragEnd:w,oncontextmenu:Qe=>T(Qe,Y),get tempName(){return t(c)},set tempName(Qe){B(c,Qe,!0)}})}var we=o(Ce,2);{var me=Ie=>{ca(Ie,{get target(){return t(X)}})};O(we,Ie=>{t(v)==="layer"&&t(d)===Y&&Ie(me)})}f(Se,Q)};O(le,Se=>{(!t(ie)||!t(ie).isCollapsed)&&Se(ye)})}f(M,q)}),r(W),fe(3,W,()=>be,()=>({duration:150})),f(N,W)};O(R,N=>{s.studio.projectActiveTab==="frames"?N(F):N(ee,!1)})}r(j);var J=o(j,2),D=i(J),G=i(D);{let N=H(()=>s.studio.projectActiveTab==="frames"?"actions:new_frame":"actions:new_layer");xe(G,{variant:"ghost",size:"sm",onclick:()=>{s.studio.projectActiveTab==="frames"?K.project.addFrame():K.project.addLayer()},get ariaLabel(){return t(N)},class:"!p-0 text-[9px] font-bold tracking-[0.1em] text-text-main/40 uppercase hover:text-text-main/80",children:(W,M)=>{var X=vi(),Y=o(ne(X));P(ie=>E(Y,` ${ie??""}`),[()=>s.studio.projectActiveTab==="frames"?_("actions:new_frame"):_("actions:new_layer")]),f(W,X)},$$slots:{default:!0}})}var U=o(G,2);{var Z=N=>{xe(N,{variant:"ghost",size:"sm",onclick:()=>K.project.addGroup(),ariaLabel:"actions:new_layer_group",class:"!p-0 text-[9px] font-bold tracking-[0.1em] text-text-main/40 uppercase hover:text-text-main/80",children:(W,M)=>{var X=ui(),Y=o(ne(X));P(ie=>E(Y,` ${ie??""}`),[()=>_("actions:new_layer_group")]),f(W,X)},$$slots:{default:!0}})};O(U,N=>{s.studio.projectActiveTab==="layers"&&N(Z)})}r(D);var de=o(D,2),V=i(de,!0);r(de),r(J),r(I),P(()=>E(V,s.studio.projectActiveTab==="frames"?s.project.frames.length:s.project.activeFrame.layers.length)),te("click",j,m),te("keydown",j,N=>{N.key==="Escape"&&m()}),f(u,I),re()}Ae(["click","keydown"]);var xi=S('<div class="minimap-container border-b border-text-main/10 bg-text-main/5 p-3 transition-all duration-300 svelte-1kivg02"><div class="relative flex items-center justify-center overflow-hidden rounded border border-text-main/5 bg-sidebar-bg/20 p-2 shadow-inner"><canvas class="h-auto w-full max-w-[180px] shadow-sm" style="image-rendering: pixelated;"></canvas> <div class="pointer-events-none absolute inset-0 ring-1 ring-ui-accent ring-inset" style="opacity: 0.4;"></div></div></div>');function gi(u,e){ae(e,!0);let a=ce(null);He(()=>{s.canvas.version;const v=t(a)?.getContext("2d");if(!v||!t(a))return;const{width:d,height:p}=s.canvas,x=s.canvas.compositePixels,b=v.createImageData(d,p);new Uint32Array(b.data.buffer).set(x),v.putImageData(b,0,0)});var n=xi(),l=i(n),c=i(l);gt(c,v=>B(a,v),()=>t(a)),ge(2),r(l),r(n),P(()=>{z(c,"width",s.canvas.width),z(c,"height",s.canvas.height)}),f(u,n),re()}var hi=S('<span class="text-sm"> </span>'),mi=S('<div class="absolute top-0 -right-12 z-50 flex flex-col items-center gap-1 rounded-md bg-canvas-bg p-1 shadow-md ring-1 ring-text-main/10"><button class="flex h-4 w-4 items-center justify-center text-[10px] hover:text-ui-accent">+</button> <span class="font-tiny5 text-[8px] text-ui-accent"> </span> <button class="flex h-4 w-4 items-center justify-center text-[10px] hover:text-ui-accent">-</button> <div class="my-1 h-px w-2 bg-text-main/10"></div> <div class="flex flex-col items-center gap-0.5"><button class="text-[8px] hover:text-ui-accent">‚ñ¥</button> <span class="text-[7px] font-bold text-ui-accent/60"> </span> <button class="text-[8px] hover:text-ui-accent">‚ñæ</button></div></div>'),bi=S('<div class="relative"><!> <!></div>'),_i=S('<div class="flex flex-col gap-1.5"></div>'),Ai=S('<span class="text-sm"> </span>'),yi=S('<span class="text-sm"> </span>'),wi=S('<div class="absolute -top-1 -right-1 text-[8px]">üîí</div>'),ki=S('<span class="text-[10px]"> </span> <!>',1),Ei=S('<div class="flex flex-col gap-1.5"></div> <div class="h-px w-4 bg-text-main/10"></div> <div class="flex flex-col gap-1.5"></div> <div class="h-px w-4 bg-text-main/10"></div> <div class="flex flex-col gap-1.5"></div>',1),Li=S('<div class="toolbar custom-scrollbar flex h-full flex-col items-center gap-4 overflow-y-auto py-4 svelte-g5agka"><!></div>');function Ea(u,e){ae(e,!0);const a=s.studio;let n=se(e,"side",3,"left");function l(y){rt.playCeramicSlide(),Xe.handleIntent(y)}const c=[{id:"BRUSH",icon:"üñåÔ∏è",intent:"TOOL_BRUSH",label:"tool_brush"},{id:"ERASER",icon:"üßπ",intent:"TOOL_ERASER",label:"tool_eraser"},{id:"RECT_SELECT",icon:"‚ú®",intent:"TOOL_RECT_SELECT",label:"tool_rect_select"},{id:"LASSO_SELECT",icon:"‚û∞",intent:"TOOL_LASSO_SELECT",label:"tool_lasso_select"},{id:"POLY_SELECT",icon:"üìê",intent:"TOOL_POLY_SELECT",label:"tool_poly_select"},{id:"RECTANGLE",icon:"üì¶",intent:"TOOL_RECTANGLE",label:"tool_rectangle"},{id:"ELLIPSE",icon:"‚≠ï",intent:"TOOL_ELLIPSE",label:"tool_ellipse"},{id:"POLYGON",icon:"‚≠ê",intent:"TOOL_POLYGON",label:"tool_polygon"},{id:"HAND",icon:"ü§ö",intent:"TOGGLE_HAND_TOOL",label:"toggle_hand_tool"}],v=[{id:"lighten",icon:"‚òÄÔ∏è",intent:"SHADE_LIGHTEN",active:()=>a.isShadingLighten,label:"shade_lighten"},{id:"darken",icon:"üåô",intent:"SHADE_DARKEN",active:()=>a.isShadingDarken,label:"shade_darken"},{id:"dither",icon:"üèÅ",intent:"SHADE_DITHER",active:()=>a.isShadingDither,label:"shade_dither"}],d=[{id:"symmetry",icon:"ü™û",intent:"CYCLE_SYMMETRY",active:()=>a.symmetryMode!=="OFF",label:"cycle_symmetry"},{id:"tiling",icon:"‚àû",intent:"TOGGLE_TILING",active:()=>a.isTilingEnabled,label:"toggle_tiling"},{id:"perfect",icon:"‚ú®",intent:"TOGGLE_PIXEL_PERFECT",active:()=>a.isPixelPerfect,label:"toggle_pixel_perfect"},{id:"stencil",icon:"üé®",intent:"TOGGLE_PATTERN_BRUSH",active:()=>a.isPatternBrushActive,label:"toggle_pattern_brush",disabled:()=>!s.project.clipboard}],p=[{id:"alpha",icon:"A",intent:"TOGGLE_ALPHA_LOCK",active:()=>a.isAlphaLocked,label:"toggle_alpha_lock"},{id:"color",icon:"C",intent:"TOGGLE_COLOR_LOCK",active:()=>a.isColorLocked,label:"toggle_color_lock"}];var x=Li(),b=i(x);{var h=y=>{var w=_i();_e(w,21,()=>c,Le,(m,k)=>{var A=bi(),C=i(A);{let I=H(()=>a.activeTool===t(k).id),$=H(()=>`actions:${t(k).label}`);xe(C,{variant:"tool",get isActive(){return t(I)},get ariaLabel(){return t($)},onclick:()=>l(t(k).intent),class:"h-8 w-8 !p-0",children:(j,R)=>{var F=hi(),ee=i(F,!0);r(F),P(()=>E(ee,t(k).icon)),f(j,F)},$$slots:{default:!0}})}var T=o(C,2);{var L=I=>{var $=mi(),j=i($),R=o(j,2),F=i(R,!0);r(R);var ee=o(R,2),J=o(ee,4),D=i(J),G=o(D,2),U=i(G);r(G);var Z=o(G,2);r(J),r($),P(()=>{E(F,a.polygonSides),E(U,`${a.polygonIndentation??""}%`)}),te("click",j,()=>Xe.handleIntent("POLY_SIDES_INC")),te("click",ee,()=>Xe.handleIntent("POLY_SIDES_DEC")),te("click",D,()=>Xe.handleIntent("POLY_INDENT_INC")),te("click",Z,()=>Xe.handleIntent("POLY_INDENT_DEC")),fe(3,$,()=>be),f(I,$)};O(T,I=>{t(k).id==="POLYGON"&&a.activeTool==="POLYGON"&&I(L)})}r(A),f(m,A)}),r(w),f(y,w)},g=y=>{var w=Ei(),m=ne(w);_e(m,21,()=>v,Le,(C,T)=>{{let L=H(()=>t(T).active()),I=H(()=>`actions:${t(T).label}`);xe(C,{variant:"tool",get isActive(){return t(L)},get ariaLabel(){return t(I)},onclick:()=>Xe.handleIntent(t(T).intent),class:"h-8 w-8 !p-0",children:($,j)=>{var R=Ai(),F=i(R,!0);r(R),P(()=>E(F,t(T).icon)),f($,R)},$$slots:{default:!0}})}}),r(m);var k=o(m,4);_e(k,21,()=>d,Le,(C,T)=>{{let L=H(()=>t(T).active()),I=H(()=>t(T).disabled?.()),$=H(()=>`actions:${t(T).label}`);xe(C,{variant:"tool",get isActive(){return t(L)},get disabled(){return t(I)},get ariaLabel(){return t($)},onclick:()=>!t(T).disabled?.()&&Xe.handleIntent(t(T).intent),class:"h-8 w-8 !p-0",children:(j,R)=>{var F=yi(),ee=i(F,!0);r(F),P(()=>E(ee,t(T).icon)),f(j,F)},$$slots:{default:!0}})}}),r(k);var A=o(k,4);_e(A,21,()=>p,Le,(C,T)=>{{let L=H(()=>t(T).active()),I=H(()=>`actions:${t(T).label}`);xe(C,{variant:"tool",get isActive(){return t(L)},get ariaLabel(){return t(I)},onclick:()=>Xe.handleIntent(t(T).intent),class:"h-8 w-8 !p-0 font-bold",children:($,j)=>{var R=ki(),F=ne(R),ee=i(F,!0);r(F);var J=o(F,2);{var D=U=>{var Z=wi();fe(3,Z,()=>Lt),f(U,Z)},G=H(()=>t(T).active());O(J,U=>{t(G)&&U(D)})}P(()=>E(ee,t(T).icon)),f($,R)},$$slots:{default:!0}})}}),r(A),f(y,w)};O(b,y=>{n()==="left"?y(h):y(g,!1)})}r(x),f(u,x),re()}Ae(["click"]);var Si=S('<label class="px-1 text-[10px] font-bold tracking-widest text-text-main/70 uppercase"> </label>'),Ci=S(`<div><!> <input class="
            rounded-sm border-2 border-ui-structural bg-canvas-bg px-2 py-1
            text-[10px] text-text-main placeholder-text-main/30
            shadow-[2px_2px_0px_var(--color-ui-structural)]
            transition-all focus:ring-2 focus:ring-ui-accent focus:ring-offset-1
            focus:outline-none disabled:cursor-not-allowed disabled:opacity-50
        "/></div>`);function Ue(u,e){ae(e,!0);let a=se(e,"value",15),n=se(e,"placeholder",3,""),l=se(e,"type",3,"text"),c=se(e,"disabled",3,!1),v=se(e,"readonly",3,!1),d=se(e,"class",3,"");var p=Ci(),x=i(p);{var b=g=>{var y=Si(),w=i(y,!0);r(y),P(m=>{z(y,"for",e.id||e.label),E(w,m)},[()=>_(e.label)]),f(g,y)};O(x,g=>{e.label&&g(b)})}var h=o(x,2);kt(h),r(p),P((g,y)=>{oe(p,1,`flex flex-col gap-1.5 ${d()??""}`),z(h,"id",e.id),z(h,"type",l()),h.disabled=c(),h.readOnly=v(),z(h,"min",e.min),z(h,"max",e.max),z(h,"step",e.step),z(h,"placeholder",g),z(h,"aria-label",y)},[()=>_(n()),()=>_(e.ariaLabel)]),te("change",h,function(...g){e.onchange?.apply(this,g)}),te("input",h,function(...g){e.oninput?.apply(this,g)}),Oe("blur",h,function(...g){e.onblur?.apply(this,g)}),te("keydown",h,function(...g){e.onkeydown?.apply(this,g)}),Ot(h,a),f(u,p),re()}Ae(["change","input","keydown"]);var mt=Et(()=>s),Ti=S('<!> <div class="flex items-center gap-3 border-b border-text-main/10 bg-text-main/5 px-4 py-3" role="group" aria-label="Canvas Zoom"><span class="font-serif text-[8px] font-bold text-text-main/40 uppercase"> </span> <div class="flex flex-1 items-center gap-2"><!> <!></div></div>',1),Ii=S('<aside class="side-panel-left flex h-full w-full bg-canvas-bg/50"><div class="flex flex-1 flex-col overflow-hidden"><!> <div class="custom-scrollbar flex-1 overflow-y-auto border-r border-text-main/5"><!></div></div> <div class="flex h-full flex-col bg-ui-structural/[0.05] px-2 shadow-sm"><!></div></aside>');function Pi(u,e){ae(e,!1),je();var a=Ii(),n=i(a),l=i(n);{var c=b=>{var h=Ti(),g=ne(h);gi(g,{});var y=o(g,2),w=i(y),m=i(w,!0);r(w);var k=o(w,2),A=i(k);nt(A,{min:.1,max:10,step:.1,ariaLabel:"workspace:stats.zoom_level",class:"flex-1",get value(){return mt().studio.zoomLevel},set value(T){mt(mt().studio.zoomLevel=T)},$$legacy:!0});var C=o(A,2);Ue(C,{type:"number",min:.1,max:10,step:.1,ariaLabel:"workspace:stats.zoom_level",class:"!h-6 w-12 !border-none !bg-transparent !p-0 !text-center !text-[10px] !shadow-none",get value(){return mt().studio.zoomLevel},set value(T){mt(mt().studio.zoomLevel=T)},$$legacy:!0}),r(k),r(y),P(T=>E(m,T),[()=>_("workspace:stats.zoom_label")]),f(b,h)};O(l,b=>{mt().studio.showMinimap&&b(c)})}var v=o(l,2),d=i(v);fi(d,{}),r(v),r(n);var p=o(n,2),x=i(p);Ea(x,{side:"left"}),r(p),r(a),f(u,a),re()}var ji=S('<button class="group editor-checker-small relative h-5 w-5 shrink-0 rounded border border-text-main/10 shadow-sm transition-all hover:scale-110 active:scale-95"><div class="absolute inset-0 flex items-center justify-center opacity-0 transition-opacity group-hover:opacity-100"><span class="text-[8px]">üìç</span></div></button>'),$i=S('<div class="flex h-5 w-5 items-center justify-center rounded border border-dashed border-text-main/10"><span class="text-[8px] opacity-20">üé®</span></div>'),Ri=S('<div class="custom-scrollbar flex max-h-[120px] flex-row flex-wrap gap-1.5 overflow-y-auto px-1"></div>');function Mi(u,e){ae(e,!0);var a=Ri();_e(a,20,()=>e.colors,n=>n,(n,l)=>{var c=ji();P(()=>{pe(c,`background-color: ${l??""};`),z(c,"title",l)}),te("click",c,()=>K.color.setColor(l)),fe(3,c,()=>wa,()=>({duration:200})),f(n,c)},n=>{var l=$i();f(n,l)}),r(a),f(u,a),re()}Ae(["click"]);var Oi=S('<div class="editor-panel flex w-full flex-col gap-4 border-none bg-canvas-bg p-3 shadow-sm"><div class="flex flex-col items-center gap-2 py-2"><span class="font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </span> <div class="editor-checker-small h-10 w-10 rounded border border-text-main/10 shadow-inner transition-colors"></div> <div class="flex items-center gap-2"><span class="font-mono text-[9px] font-bold tracking-tight text-text-main/40 uppercase"> </span> <button class="flex h-4 w-4 items-center justify-center rounded bg-ui-accent/10 text-[8px] text-ui-accent transition-all hover:bg-ui-accent hover:text-canvas-bg">Ôºã</button></div></div> <div class="h-px w-full bg-text-main/5"></div> <div class="flex flex-col gap-2"><span class="text-center font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </span> <!></div></div>');function Di(u,e){ae(e,!1),je();var a=Oi(),n=i(a),l=i(n),c=i(l,!0);r(l);var v=o(l,2),d=o(v,2),p=i(d),x=i(p,!0);r(p);var b=o(p,2);r(d),r(n);var h=o(n,4),g=i(h),y=i(g,!0);r(g);var w=o(g,2);Mi(w,{get colors(){return s.usedColors}}),r(h),r(a),P((m,k,A)=>{E(c,m),pe(v,`background-color: ${s.paletteState.activeColor??""};`),E(x,s.paletteState.activeColor),z(b,"title",k),E(y,A)},[()=>_("workspace:hud.active_color"),()=>_("workspace:hud.actions.add_color"),()=>_("workspace:hud.recent_colors")]),te("click",b,()=>s.paletteState.addSwatch(s.paletteState.activeColor)),f(u,a),re()}Ae(["click"]);var zi=S('<div class="editor-panel w-full border-none bg-sidebar-bg/50 p-3 shadow-sm" role="status"><div class="flex flex-col gap-3"><div class="flex flex-col"><span class="font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </span> <span class="font-mono text-[11px] font-bold text-text-main tabular-nums"> </span></div> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <div class="flex flex-col"><span class="font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </span> <span class="font-mono text-[11px] font-bold text-text-main tabular-nums"> </span></div></div></div>');function Fi(u,e){ae(e,!1),je();var a=zi(),n=i(a),l=i(n),c=i(l),v=i(c,!0);r(c);var d=o(c,2),p=i(d);r(d),r(l);var x=o(l,4),b=i(x),h=i(b,!0);r(b);var g=o(b,2),y=i(g);r(g),r(x),r(n),r(a),P((w,m)=>{E(v,w),E(p,`${s.displayCoords.x??""}, ${s.displayCoords.y??""}`),E(h,m),E(y,`${s.canvas.width??""}√ó${s.canvas.height??""}`)},[()=>_("workspace:stats.cursor_focus"),()=>_("workspace:stats.canvas_size")]),f(u,a),re()}var ot=Et(()=>s),Ni=S('<button role="radio"></button>'),Bi=S('<div class="editor-panel flex w-full flex-col gap-3 border-none bg-sidebar-bg/30 p-3 shadow-sm" role="region" aria-label="Natural Pigments"><span class="text-center font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </span> <div class="grid grid-cols-4 gap-2" role="radiogroup"><!> <button class="flex h-8 w-8 items-center justify-center rounded border border-dashed border-text-main/20 bg-text-main/5 transition-all hover:scale-110 hover:border-ui-accent/40 hover:bg-ui-highlight/20"><span class="text-xs opacity-40" aria-hidden="true">üè∫</span></button> <button class="flex h-8 w-8 items-center justify-center rounded border border-dashed border-text-main/20 bg-text-main/5 transition-all hover:scale-110 hover:border-ui-accent/40 hover:bg-ui-highlight/20"><span class="text-xs opacity-40" aria-hidden="true">üé®</span></button></div></div>');function Gi(u,e){ae(e,!1),je();var a=Bi(),n=i(a),l=i(n,!0);r(n);var c=o(n,2),v=i(c);_e(v,1,()=>ot().palette,Le,(x,b,h)=>{var g=Ni();P((y,w)=>{oe(g,1,`editor-checker-small h-8 w-8 rounded transition-all ${ot().activeColor===t(b)?"is-active-pigment z-10 scale-110 border-2 border-ui-accent shadow-md":"border border-text-main/5 opacity-80 hover:scale-105 hover:opacity-100"}`),pe(g,`background-color: ${t(b)??""};`),z(g,"aria-label",y),z(g,"title",w),z(g,"aria-checked",ot().activeColor===t(b))},[()=>_(`actions:select_color_${(h+1)%10}`),()=>_(`actions:select_color_${(h+1)%10}`)+` (${(h+1)%10})`]),te("click",g,()=>Xe.handleIntent(`SELECT_COLOR_${(h+1)%10}`)),te("contextmenu",g,y=>{y.preventDefault(),ot(ot().studio.contextMenu={x:y.clientX,y:y.clientY,items:[{label:_("workspace:hud.context_menu.delete_color"),icon:"üóëÔ∏è",danger:!0,disabled:ot().palette.length<=1,action:()=>ot().paletteState.removeSwatch(h)}]})}),f(x,g)});var d=o(v,2),p=o(d,2);r(c),r(a),P((x,b,h,g,y)=>{E(l,x),z(d,"title",b),z(d,"aria-label",h),z(p,"title",g),z(p,"aria-label",y)},[()=>_("shortcuts:groups.colors"),()=>_("tools:color_picker.title"),()=>_("tools:color_picker.title"),()=>_("tools:palette_library.title"),()=>_("tools:palette_library.title")]),te("click",d,()=>ot(ot().showColorPicker=!0)),te("click",p,()=>ot(ot().studio.showPaletteLibrary=!0)),f(u,a),re()}Ae(["click","contextmenu"]);var Hi=S('<span class="text-[10px]">‚ñ†</span>'),Ui=S('<span class="text-[10px]">‚óè</span>'),Vi=S('<div class="flex flex-col gap-2"><div class="flex items-center justify-between"><span class="font-serif text-[10px] font-bold text-text-main/40 uppercase"> </span> <div class="flex items-center gap-1"><!> <span class="font-tiny5 text-[8px] text-text-main/30"> </span></div></div> <!></div>'),Yi=S('<div class="editor-panel flex w-full flex-col gap-4 border-none bg-canvas-bg p-3 shadow-sm"><div class="flex items-center justify-between"><span class="font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </span> <div class="flex items-center gap-1.5"><!> <!></div></div> <div class="flex flex-col gap-2"><div class="flex items-center justify-between"><span class="font-serif text-[10px] font-bold text-text-main/40 uppercase"> </span> <div class="flex items-center gap-1"><!> <span class="font-tiny5 text-[8px] text-text-main/30"> </span></div></div> <!></div> <div class="h-px w-full bg-text-main/5"></div> <div class="flex items-center justify-between"><div class="flex flex-col"><span class="font-serif text-[10px] font-bold text-text-main/40 uppercase"> </span> <span class="font-serif text-[8px] text-text-main/30 italic"> </span></div> <!></div> <!></div>');function Ki(u,e){ae(e,!1);const a=ga(s.studio);je();var n=Yi(),l=i(n),c=i(l),v=i(c,!0);r(c);var d=o(c,2),p=i(d);{let D=bt(()=>t(a).brushShape==="SQUARE");xe(p,{variant:"tool",get isActive(){return t(D)},onclick:()=>Xe.handleIntent("TOGGLE_BRUSH_SHAPE"),ariaLabel:"tools:brush_settings.shape_square",class:"h-6 w-6 !p-0",children:(G,U)=>{var Z=Hi();f(G,Z)},$$slots:{default:!0}})}var x=o(p,2);{let D=bt(()=>t(a).brushShape==="CIRCLE");xe(x,{variant:"tool",get isActive(){return t(D)},onclick:()=>Xe.handleIntent("TOGGLE_BRUSH_SHAPE"),ariaLabel:"tools:brush_settings.shape_circle",class:"h-6 w-6 !p-0",children:(G,U)=>{var Z=Ui();f(G,Z)},$$slots:{default:!0}})}r(d),r(l);var b=o(l,2),h=i(b),g=i(h),y=i(g,!0);r(g);var w=o(g,2),m=i(w);Ue(m,{type:"number",ariaLabel:"tools:brush_settings.size_label",class:"w-12",get value(){return t(a).brushSize},set value(D){at(a,t(a).brushSize=D)},$$legacy:!0});var k=o(m,2),A=i(k,!0);r(k),r(w),r(h);var C=o(h,2);nt(C,{min:1,max:100,ariaLabel:"tools:brush_settings.size_label",get value(){return t(a).brushSize},set value(D){at(a,t(a).brushSize=D)},$$legacy:!0}),r(b);var T=o(b,4),L=i(T),I=i(L),$=i(I,!0);r(I);var j=o(I,2),R=i(j,!0);r(j),r(L);var F=o(L,2);Kt(F,{ariaLabel:"tools:brush_settings.dither_label",get checked(){return t(a).isDitherBlendActive},set checked(D){at(a,t(a).isDitherBlendActive=D)},$$legacy:!0}),r(T);var ee=o(T,2);{var J=D=>{var G=Vi(),U=i(G),Z=i(U),de=i(Z,!0);r(Z);var V=o(Z,2),N=i(V);Ue(N,{type:"number",ariaLabel:"tools:brush_settings.hardness_label",class:"w-12",get value(){return t(a).brushHardness},set value(Y){at(a,t(a).brushHardness=Y)},$$legacy:!0});var W=o(N,2),M=i(W,!0);r(W),r(V),r(U);var X=o(U,2);nt(X,{min:0,max:100,ariaLabel:"tools:brush_settings.hardness_label",get value(){return t(a).brushHardness},set value(Y){at(a,t(a).brushHardness=Y)},$$legacy:!0}),r(G),P((Y,ie)=>{E(de,Y),E(M,ie)},[()=>_("tools:brush_settings.hardness_label"),()=>_("ui:units.percentage")]),fe(3,G,()=>be,()=>({duration:150})),f(D,G)};O(ee,D=>{t(a).isDitherBlendActive&&D(J)})}r(n),P((D,G,U,Z,de)=>{E(v,D),E(y,G),E(A,U),E($,Z),E(R,de)},[()=>_("tools:brush_settings.title"),()=>_("tools:brush_settings.size_label"),()=>_("ui:units.pixels"),()=>_("tools:brush_settings.dither_label"),()=>_("tools:brush_settings.dither_desc")]),f(u,n),re()}var Qi=S('<aside class="side-panel-right flex h-full w-full bg-canvas-bg/50"><div class="bg-hud-shadow/[0.02] flex h-full flex-col border-r border-text-main/5 px-2"><!></div> <div class="custom-scrollbar flex flex-1 flex-col gap-4 overflow-y-auto p-3"><div class="flex flex-col gap-3"><!> <!> <!></div> <div class="flex-1"></div> <!></div></aside>');function qi(u){var e=Qi(),a=i(e),n=i(a);Ea(n,{side:"right"}),r(a);var l=o(a,2),c=i(l),v=i(c);Ki(v,{});var d=o(v,2);Di(d,{});var p=o(d,2);Gi(p,{}),r(c);var x=o(c,4);Fi(x,{}),r(l),r(e),f(u,e)}var Wi=S('<span class="text-xs" aria-hidden="true"> </span>'),Xi=S('<span class="ml-1 border-l border-text-main/20 pl-2 font-mono text-[9px] tracking-tighter not-italic"> </span>'),Zi=S("<div><!> <span> </span> <!></div>"),Ji=S('<div class="text-[8px] font-bold tracking-[0.2em] text-text-main/20 uppercase"> </div>'),es=S('<div class="flex items-center gap-4 transition-opacity duration-1000" role="status" aria-live="polite"><div class="flex w-[180px] items-center"><!></div> <!></div>');function ts(u,e){ae(e,!1),je();var a=es(),n=i(a),l=i(n);cr(l,()=>Je.current.type,d=>{var p=Zi(),x=i(p);{var b=m=>{var k=Wi(),A=i(k,!0);r(k),P(()=>E(A,Je.current.icon)),f(m,k)};O(x,m=>{Je.current.icon&&m(b)})}var h=o(x,2),g=i(h,!0);r(h);var y=o(h,2);{var w=m=>{var k=Xi(),A=i(k);r(k),P(()=>E(A,`v${s.version??""}`)),f(m,k)};O(y,m=>{Je.current.type==="READY"&&m(w)})}r(p),P(()=>{oe(p,1,`status-tag flex items-center gap-2 ${Je.current.isPulse?"animate-pulse":""}`),pe(p,`
					border-color: color-mix(in srgb, ${Je.current.color??""} 20%, transparent);
					background-color: color-mix(in srgb, ${Je.current.color??""} 10%, transparent);
					color: ${Je.current.color??""};
				`),oe(h,1,or(Je.current.type==="READY"?"font-serif italic opacity-60":"font-bold")),E(g,Je.current.label)}),f(d,p)}),r(n);var c=o(n,2);{var v=d=>{const p=bt(()=>s.project.lastSaved.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}));var x=Ji(),b=i(x,!0);r(x),P((h,g)=>{z(x,"aria-label",h),E(b,g)},[()=>_("workspace:project.saved",{replace:{time:t(p)}}),()=>_("workspace:project.saved",{replace:{time:t(p)}})]),f(d,x)};O(c,d=>{s.project.lastSaved&&d(v)})}r(a),f(u,a),re()}var as=S("<span><!></span>");function Fe(u,e){let a=se(e,"variant",3,"secondary"),n=se(e,"size",3,"md"),l=se(e,"class",3,"");const c={primary:"bg-ui-accent text-white border border-ui-structural shadow-[2px_2px_0px_var(--color-ui-structural)]",secondary:"bg-canvas-bg text-text-main border border-ui-structural shadow-[2px_2px_0px_var(--color-ui-structural)]",accent:"bg-ui-highlight text-text-main border border-ui-structural shadow-[2px_2px_0px_var(--color-ui-structural)]",danger:"bg-ui-danger text-white border border-ui-structural shadow-[2px_2px_0px_var(--color-ui-structural)]",ghost:"bg-transparent text-text-main border border-ui-structural"},v={sm:"px-1.5 py-0.5 text-[8px] tracking-widest",md:"px-2 py-0.5 text-[10px] tracking-wider",lg:"px-3 py-1 text-[12px] tracking-normal"};var d=as(),p=i(d);{var x=b=>{var h=Te(),g=ne(h);Me(g,()=>e.children),f(b,h)};O(p,b=>{e.children&&b(x)})}r(d),P(()=>oe(d,1,`
        inline-flex flex-nowrap items-center justify-center rounded-sm font-bold
        whitespace-nowrap uppercase select-none
        ${c[a()]??""}
        ${v[n()]??""}
        ${l()??""}
    `)),f(u,d)}var rs=S('<span class="font-mono text-[9px] text-text-main/40 italic"> </span>'),is=S('<div class="flex items-center gap-2"><span class="font-serif text-[8px] font-black tracking-widest text-text-main/50 uppercase italic"> </span> <div class="flex min-w-[80px] gap-1.5"><!></div></div>');function ss(u,e){ae(e,!1),je();var a=is(),n=i(a),l=i(n);r(n);var c=o(n,2),v=i(c);{var d=x=>{var b=Te(),h=ne(b);_e(h,1,()=>Ve.activeKeys,Le,(g,y)=>{Fe(g,{variant:"secondary",size:"sm",children:(w,m)=>{ge();var k=ve();P(()=>E(k,t(y)===" "?"Space":t(y))),f(w,k)},$$slots:{default:!0}})}),f(x,b)},p=x=>{var b=rs(),h=i(b,!0);r(b),P(g=>E(h,g),[()=>_("timeline:waiting")]),f(x,b)};O(v,x=>{Ve.activeKeys.length>0?x(d):x(p,!1)})}r(c),r(a),P(x=>E(l,`${x??""}:`),[()=>_("timeline:rhythm")]),f(u,a),re()}var os=S('<div class="flex items-center gap-2"><span class="font-serif text-[8px] font-black tracking-widest text-text-main/50 uppercase italic"> </span> <!></div>');function ns(u,e){ae(e,!1),je();var a=os(),n=i(a),l=i(n);r(n);var c=o(n,2);Fe(c,{variant:"primary",size:"sm",children:(v,d)=>{ge();var p=ve();P(()=>E(p,Je.current.label)),f(v,p)},$$slots:{default:!0}}),r(a),P(v=>E(l,`${v??""}:`),[()=>_("timeline:mode")]),f(u,a),re()}var ls=S('<div role="tooltip"> <div></div></div>'),cs=S("<div><!> <!></div>");function Ge(u,e){ae(e,!0);let a=se(e,"position",3,"top"),n=se(e,"class",3,""),l=ce(!1);const c={top:"bottom-full left-1/2 -translate-x-1/2 mb-2",bottom:"top-full left-1/2 -translate-x-1/2 mt-2",left:"right-full top-1/2 -translate-y-1/2 mr-2",right:"left-full top-1/2 -translate-y-1/2 ml-2"},v={top:"top-full left-1/2 -translate-x-1/2 border-t-ui-structural border-x-transparent border-b-transparent",bottom:"bottom-full left-1/2 -translate-x-1/2 border-b-ui-structural border-x-transparent border-t-transparent",left:"left-full top-1/2 -translate-y-1/2 border-l-ui-structural border-y-transparent border-r-transparent",right:"right-full top-1/2 -translate-y-1/2 border-r-ui-structural border-y-transparent border-l-transparent"};var d=cs(),p=i(d);{var x=g=>{var y=Te(),w=ne(y);Me(w,()=>e.children),f(g,y)};O(p,g=>{e.children&&g(x)})}var b=o(p,2);{var h=g=>{var y=ls(),w=i(y),m=o(w);r(y),P(k=>{oe(y,1,`
                pointer-events-none absolute z-[5000] rounded-sm bg-ui-structural
                px-3 py-1.5 text-[10px] font-bold tracking-wider whitespace-nowrap
                text-canvas-bg uppercase shadow-xl
                ${c[a()]??""}
            `),E(w,`${k??""} `),oe(m,1,`absolute border-[6px] ${v[a()]??""}`)},[()=>_(e.text)]),f(g,y)};O(b,g=>{t(l)&&e.text&&g(h)})}r(d),P(()=>oe(d,1,`relative inline-block ${n()??""}`)),Oe("mouseenter",d,()=>B(l,!0)),Oe("mouseleave",d,()=>B(l,!1)),te("focusin",d,()=>B(l,!0)),te("focusout",d,()=>B(l,!1)),f(u,d),re()}Ae(["focusin","focusout"]);var ds=S('<div class="flex items-center gap-1.5"><span aria-hidden="true">üéê</span> <span class="font-serif text-[8px] font-black tracking-widest text-text-main/50 uppercase italic"><!></span></div>');function vs(u,e){ae(e,!1),je(),Ge(u,{text:"timeline:audio_status.title",children:(a,n)=>{var l=ds(),c=i(l),v=o(c,2),d=i(v);{var p=h=>{var g=ve();P(y=>E(g,y),[()=>_("timeline:audio_status.silent")]),f(h,g)},x=h=>{var g=ve();P(y=>E(g,y),[()=>_("timeline:audio_status.brewing")]),f(h,g)},b=h=>{var g=ve();P(y=>E(g,y),[()=>_("timeline:audio_status.resonant")]),f(h,g)};O(d,h=>{s.usageMinutes<30?h(p):s.usageMinutes<60?h(x,1):h(b,!1)})}r(v),r(l),P(()=>oe(c,1,`text-[9px] ${s.usageMinutes>=30?"animate-pulse":"opacity-40 grayscale"}`)),f(a,l)},$$slots:{default:!0}}),re()}var us=S('<div class="flex items-center gap-1.5"><span class="text-[9px] opacity-40" aria-hidden="true">‚è≥</span> <span class="font-mono text-[9px] font-bold text-text-main/80 tabular-nums"> </span></div>');function ps(u,e){ae(e,!1),je();var a=us(),n=o(i(a),2),l=i(n,!0);r(n),r(a),P(c=>{z(a,"title",c),E(l,s.studio.sessionTimeLabel)},[()=>_("timeline:duration")]),f(u,a),re()}var At=Et(()=>s),fs=S('<span aria-hidden="true">üåÄ</span> <span class="text-[8px]"> </span>',1),xs=S('<div class="flex items-center gap-3"><div class="flex items-center gap-1.5"><span class="text-[9px] opacity-40" aria-hidden="true">‚ú®</span> <span class="font-serif text-[8px] font-black tracking-widest text-text-main/60 uppercase italic"> </span></div> <!></div>');function gs(u,e){ae(e,!1),je();var a=xs(),n=i(a),l=o(i(n),2),c=i(l,!0);r(l),r(n);var v=o(n,2);{var d=p=>{xe(p,{variant:"primary",size:"sm",onclick:()=>At(At().studio.showPourBasin=!0),ariaLabel:"export:propagation.title",class:"!px-2 !py-0.5",children:(x,b)=>{var h=fs(),g=o(ne(h),2),y=i(g,!0);r(g),P(w=>E(y,w),[()=>_("export:propagation.title")]),f(x,h)},$$slots:{default:!0}})};O(v,p=>{At().selection.isActive&&At().project.frames.length>1&&p(d)})}r(a),P(p=>E(c,p),[()=>_(At().selection.maskCount>1?"timeline:pixel_count_plural":"timeline:pixel_count",{replace:{count:At().selection.maskCount}})]),f(u,a),re()}var hs=S('<div class="flex items-center gap-1.5"><span class="text-[10px]" aria-hidden="true">üì¶</span> <!></div> <div class="h-3 w-px bg-text-main/20" aria-hidden="true"></div>',1),ms=S('<div class="flex items-center gap-3 text-text-main/40" role="status"><!> <div class="flex gap-3 font-mono text-[9px] font-bold tracking-tight text-text-main/60 uppercase"><span> </span> <span> </span> <span> </span></div> <div class="h-3 w-px bg-text-main/20" aria-hidden="true"></div> <!></div>');function bs(u,e){ae(e,!1),je();var a=ms(),n=i(a);{var l=y=>{var w=hs(),m=ne(w),k=o(i(m),2);Fe(k,{variant:"primary",size:"sm",class:"!bg-ui-accent/10 !text-ui-accent/80",children:(A,C)=>{ge();var T=ve();P(L=>E(T,L),[()=>_("workspace:project.saved",{replace:{time:s.project.lastSaved.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}})]),f(A,T)},$$slots:{default:!0}}),r(m),ge(2),fe(3,m,()=>be),f(y,w)};O(n,y=>{s.project.lastSaved&&y(l)})}var c=o(n,2),v=i(c),d=i(v);r(v);var p=o(v,2),x=i(p);r(p);var b=o(p,2),h=i(b);r(b),r(c);var g=o(c,4);Fe(g,{variant:"secondary",size:"sm",children:(y,w)=>{ge();var m=ve();P(k=>E(m,k),[()=>_("workspace:stats.technical_details")]),f(y,m)},$$slots:{default:!0}}),r(a),P((y,w,m,k)=>{E(d,`${y??""}: ${s.cursor.pos.x??""},${s.cursor.pos.y??""}`),E(x,`${w??""}: ${s.canvas.width??""}x${s.canvas.height??""}`),E(h,`${m??""}: ${k??""}%`)},[()=>_("workspace:stats.pos_label"),()=>_("workspace:stats.size_label"),()=>_("workspace:stats.zoom_label"),()=>Math.round(s.studio.zoomLevel*100)]),f(u,a),re()}var _s=S('<div class="flex items-center gap-1"><span class="text-[8px] uppercase opacity-40"> </span> <span class="font-bold text-ui-accent"> </span> <span class="opacity-40"> </span></div>'),As=S(" <!>",1),ys=S("<div><!></div>"),ws=S("<span>üîíA</span>"),ks=S("<span>üîíC</span>"),Es=S('<div class="flex items-center gap-1 text-ui-accent"><!> <!></div>'),Ls=S("<div><!></div>"),Ss=S("<div><!></div>"),Cs=S("<div><!></div>"),Ts=S('<div class="animate-pulse"><!></div>'),Is=S("<div><!></div>"),Ps=S("<div><!></div>"),js=S("<div><!></div>"),$s=S("<div><!></div>"),Rs=S("<div><!></div>"),Ms=S("<div><!></div>"),Os=S("<div><!></div>"),Ds=S("<div><!></div>"),zs=S('<div class="flex items-center gap-3 font-serif text-[10px] tracking-wide text-text-main/60"><!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!></div>');function Fs(u,e){ae(e,!1);const a=s.studio;je();var n=zs(),l=i(n);Ge(l,{text:"actions:brush_size_inc",children:(V,N)=>{var W=_s(),M=i(W),X=i(M,!0);r(M);var Y=o(M,2),ie=i(Y);r(Y);var q=o(Y,2),le=i(q,!0);r(q),r(W),P(ye=>{E(X,ye),E(ie,`${a.brushSize??""}px`),E(le,a.brushShape==="SQUARE"?"‚ñ†":"‚óè")},[()=>_("shortcuts:groups.etching")]),f(V,W)},$$slots:{default:!0}});var c=o(l,2);{var v=V=>{Ge(V,{text:"actions:cycle_symmetry",children:(N,W)=>{var M=ys(),X=i(M);Fe(X,{variant:"primary",size:"sm",children:(Y,ie)=>{ge();var q=As(),le=ne(q),ye=o(le);{var Se=we=>{var me=ve("‚Äî");f(we,me)},Q=we=>{var me=ve("|");f(we,me)},Ce=we=>{var me=ve("+");f(we,me)};O(ye,we=>{a.symmetryMode==="HORIZONTAL"?we(Se):a.symmetryMode==="VERTICAL"?we(Q,1):we(Ce,!1)})}P(we=>E(le,`${we??""}: `),[()=>_("actions:cycle_symmetry")]),f(Y,q)},$$slots:{default:!0}}),r(M),fe(3,M,()=>be),f(N,M)},$$slots:{default:!0}})};O(c,V=>{a.symmetryMode!=="OFF"&&V(v)})}var d=o(c,2);{var p=V=>{var N=Es(),W=i(N);{var M=ie=>{Ge(ie,{text:"actions:toggle_alpha_lock",children:(q,le)=>{var ye=ws();f(q,ye)},$$slots:{default:!0}})};O(W,ie=>{a.isAlphaLocked&&ie(M)})}var X=o(W,2);{var Y=ie=>{Ge(ie,{text:"actions:toggle_color_lock",children:(q,le)=>{var ye=ks();f(q,ye)},$$slots:{default:!0}})};O(X,ie=>{a.isColorLocked&&ie(Y)})}r(N),fe(3,N,()=>be),f(V,N)};O(d,V=>{(a.isAlphaLocked||a.isColorLocked)&&V(p)})}var x=o(d,2);{var b=V=>{Ge(V,{text:"actions:toggle_tiling",children:(N,W)=>{var M=Ls(),X=i(M);Fe(X,{variant:"primary",size:"sm",children:(Y,ie)=>{ge();var q=ve("‚àû");f(Y,q)},$$slots:{default:!0}}),r(M),fe(3,M,()=>be),f(N,M)},$$slots:{default:!0}})};O(x,V=>{a.isTilingEnabled&&V(b)})}var h=o(x,2);{var g=V=>{Ge(V,{text:"actions:toggle_airbrush",children:(N,W)=>{var M=Ss(),X=i(M);Fe(X,{variant:"primary",size:"sm",children:(Y,ie)=>{ge();var q=ve();P(le=>E(q,`‚òÅÔ∏è ${le??""}`),[()=>_("tools:status.mist")]),f(Y,q)},$$slots:{default:!0}}),r(M),fe(3,M,()=>be),f(N,M)},$$slots:{default:!0}})};O(h,V=>{a.isAirbrushActive&&V(g)})}var y=o(h,2);{var w=V=>{Ge(V,{text:"actions:toggle_pixel_perfect",children:(N,W)=>{var M=Cs(),X=i(M);Fe(X,{variant:"accent",size:"sm",children:(Y,ie)=>{ge();var q=ve();P(le=>E(q,`‚ú® ${le??""}`),[()=>_("tools:status.pure")]),f(Y,q)},$$slots:{default:!0}}),r(M),fe(3,M,()=>be),f(N,M)},$$slots:{default:!0}})};O(y,V=>{a.isPixelPerfect&&V(w)})}var m=o(y,2);{var k=V=>{Ge(V,{text:"actions:tool_transform",children:(N,W)=>{var M=Ts(),X=i(M);Fe(X,{variant:"primary",size:"sm",children:(Y,ie)=>{ge();var q=ve();P(le=>E(q,`üß∫ ${le??""}`),[()=>_("tools:status.moving")]),f(Y,q)},$$slots:{default:!0}}),r(M),fe(3,M,()=>be),f(N,M)},$$slots:{default:!0}})};O(m,V=>{a.isTransforming&&V(k)})}var A=o(m,2);{var C=V=>{Ge(V,{text:"actions:toggle_pattern_brush",children:(N,W)=>{var M=Is(),X=i(M);Fe(X,{variant:"primary",size:"sm",children:(Y,ie)=>{ge();var q=ve();P(le=>E(q,`üé® ${le??""}`),[()=>_("tools:status.stencil")]),f(Y,q)},$$slots:{default:!0}}),r(M),fe(3,M,()=>be),f(N,M)},$$slots:{default:!0}})};O(A,V=>{a.isPatternBrushActive&&V(C)})}var T=o(A,2);{var L=V=>{Ge(V,{text:"actions:toggle_dither_blend",children:(N,W)=>{var M=Ps(),X=i(M);Fe(X,{variant:"primary",size:"sm",children:(Y,ie)=>{ge();var q=ve();P(le=>E(q,`üåø ${le??""} (${a.brushHardness??""}%)`),[()=>_("tools:status.dither")]),f(Y,q)},$$slots:{default:!0}}),r(M),fe(3,M,()=>be),f(N,M)},$$slots:{default:!0}})};O(T,V=>{a.isDitherBlendActive&&V(L)})}var I=o(T,2);{var $=V=>{Ge(V,{text:"actions:tool_rectangle",children:(N,W)=>{var M=js(),X=i(M);Fe(X,{variant:"primary",size:"sm",children:(Y,ie)=>{ge();var q=ve();P(le=>E(q,`üì¶ ${le??""}`),[()=>_("tools:status.box")]),f(Y,q)},$$slots:{default:!0}}),r(M),fe(3,M,()=>be),f(N,M)},$$slots:{default:!0}})};O(I,V=>{a.activeTool==="RECTANGLE"&&V($)})}var j=o(I,2);{var R=V=>{Ge(V,{text:"actions:tool_ellipse",children:(N,W)=>{var M=$s(),X=i(M);Fe(X,{variant:"primary",size:"sm",children:(Y,ie)=>{ge();var q=ve();P(le=>E(q,`‚≠ï ${le??""}`),[()=>_("tools:status.round")]),f(Y,q)},$$slots:{default:!0}}),r(M),fe(3,M,()=>be),f(N,M)},$$slots:{default:!0}})};O(j,V=>{a.activeTool==="ELLIPSE"&&V(R)})}var F=o(j,2);{var ee=V=>{Ge(V,{text:"actions:tool_polygon",children:(N,W)=>{var M=Rs(),X=i(M);Fe(X,{variant:"primary",size:"sm",children:(Y,ie)=>{ge();var q=ve();P(le=>E(q,`‚≠ê ${le??""} (${a.polygonSides??""})`),[()=>_("tools:status.poly")]),f(Y,q)},$$slots:{default:!0}}),r(M),fe(3,M,()=>be),f(N,M)},$$slots:{default:!0}})};O(F,V=>{a.activeTool==="POLYGON"&&V(ee)})}var J=o(F,2);{var D=V=>{Ge(V,{text:"actions:toggle_shade_lighten",children:(N,W)=>{var M=Ms(),X=i(M);Fe(X,{variant:"primary",size:"sm",children:(Y,ie)=>{ge();var q=ve();P(le=>E(q,`‚òÄÔ∏è ${le??""}`),[()=>_("tools:status.light")]),f(Y,q)},$$slots:{default:!0}}),r(M),fe(3,M,()=>be),f(N,M)},$$slots:{default:!0}})};O(J,V=>{a.isShadingLighten&&V(D)})}var G=o(J,2);{var U=V=>{Ge(V,{text:"actions:toggle_shade_darken",children:(N,W)=>{var M=Os(),X=i(M);Fe(X,{variant:"primary",size:"sm",children:(Y,ie)=>{ge();var q=ve();P(le=>E(q,`üåô ${le??""}`),[()=>_("tools:status.dark")]),f(Y,q)},$$slots:{default:!0}}),r(M),fe(3,M,()=>be),f(N,M)},$$slots:{default:!0}})};O(G,V=>{a.isShadingDarken&&V(U)})}var Z=o(G,2);{var de=V=>{Ge(V,{text:"actions:toggle_shade_dither",children:(N,W)=>{var M=Ds(),X=i(M);Fe(X,{variant:"primary",size:"sm",children:(Y,ie)=>{ge();var q=ve();P(le=>E(q,`üèÅ ${le??""}`),[()=>_("tools:status.dither")]),f(Y,q)},$$slots:{default:!0}}),r(M),fe(3,M,()=>be),f(N,M)},$$slots:{default:!0}})};O(Z,V=>{a.isShadingDither&&V(de)})}r(n),f(u,n),re()}var Ns=S('<div class="flex flex-1 items-center justify-between px-3 opacity-80 transition-opacity hover:opacity-100"><div class="flex items-center gap-4"><!> <div class="h-3 w-px bg-text-main/20"></div> <!> <div class="h-3 w-px bg-text-main/20"></div> <div class="flex items-center gap-3"><!> <div class="h-3 w-px bg-text-main/20"></div> <!> <!> <div class="h-3 w-px bg-text-main/20"></div> <!></div></div> <!></div>');function Bs(u){var e=Ns(),a=i(e),n=i(a);ss(n,{});var l=o(n,4);ns(l,{});var c=o(l,4),v=i(c);Fs(v,{});var d=o(v,4);ps(d,{});var p=o(d,2);vs(p,{});var x=o(p,4);gs(x,{}),r(c),r(a);var b=o(a,2);bs(b,{}),r(e),f(u,e)}var Ze=Et(()=>s),Gs=S('<span class="text-xs" aria-hidden="true"> </span> <span class="font-tiny5 tracking-widest uppercase"> </span>',1),Hs=S('<span class="text-xs" aria-hidden="true">üëª</span>'),Us=S('<div class="flex min-w-0 items-center gap-4 border-r border-text-main/5 pr-4" role="toolbar" aria-label="Timeline Controls"><!> <div class="flex items-center gap-2 rounded-lg bg-text-main/5 px-2 py-1 ring-1 ring-text-main/10"><span class="font-serif text-[8px] font-bold text-text-main/40 uppercase"> </span> <!> <span class="font-tiny5 text-[8px] text-text-main/30"> </span></div> <!> <div class="flex items-center gap-3 border-l border-text-main/10 pl-4"><span class="font-serif text-[8px] font-bold text-text-main/40 uppercase"> </span> <!></div></div>');function Vs(u,e){ae(e,!1),je();var a=Us(),n=i(a);{let m=bt(()=>Ze().project.isPlaying?"primary":"secondary");xe(n,{get variant(){return t(m)},onclick:()=>ma.togglePlayback(),ariaLabel:"actions:play_pause",class:"!px-4 !py-1.5 text-xs",children:(k,A)=>{var C=Gs(),T=ne(C),L=i(T,!0);r(T);var I=o(T,2),$=i(I,!0);r(I),P(j=>{E(L,Ze().project.isPlaying?"‚èπ":"‚ñ∂"),E($,j)},[()=>Ze().project.isPlaying?_("ui:labels.off"):_("ui:labels.on")]),f(k,C)},$$slots:{default:!0}})}var l=o(n,2),c=i(l),v=i(c,!0);r(c);var d=o(c,2);Ue(d,{type:"number",min:1,max:60,ariaLabel:"workspace:settings.fps_label",class:"!h-6 w-12 !border-none !bg-transparent !p-0 !text-center !text-[10px] !shadow-none",get value(){return Ze().project.fps},set value(m){Ze(Ze().project.fps=m)},$$legacy:!0});var p=o(d,2),x=i(p,!0);r(p),r(l);var b=o(l,2);xe(b,{variant:"tool",get isActive(){return Ze().studio.showGhostLayers},onclick:()=>Ze(Ze().studio.showGhostLayers=!Ze().studio.showGhostLayers),ariaLabel:"actions:toggle_ghost_layers",class:"!h-8 !px-3",children:(m,k)=>{var A=Hs();f(m,A)},$$slots:{default:!0}});var h=o(b,2),g=i(h),y=i(g,!0);r(g);var w=o(g,2);nt(w,{min:.5,max:4,step:.1,ariaLabel:"ui:labels.timeline_zoom",class:"w-64",get value(){return Ze().studio.timelineZoom},set value(m){Ze(Ze().studio.timelineZoom=m)},$$legacy:!0}),r(h),r(a),P((m,k,A)=>{E(v,m),E(x,k),E(y,A)},[()=>_("workspace:settings.fps_label"),()=>_("ui:units.fps"),()=>_("ui:labels.timeline_zoom")]),f(u,a),re()}var Ys=S('<div class="group absolute top-0 flex h-4 items-center justify-center rounded-t border-x border-t border-text-main/10 px-2 transition-all hover:h-5"><span class="truncate font-serif text-[8px] font-black text-text-main/60 uppercase"> </span> <button class="ml-1 hidden h-3 w-3 items-center justify-center rounded-full bg-text-main/10 text-[6px] group-hover:flex hover:bg-ui-accent hover:text-white">‚úï</button></div>');function Ks(u,e){ae(e,!0);const a=32;let n=H(()=>e.tag.from*a),l=H(()=>(e.tag.to-e.tag.from+1)*a);function c(){K.project.removeTag(e.tag.id)}var v=Ys(),d=i(v),p=i(d,!0);r(d);var x=o(d,2);r(v),P(()=>{pe(v,`left: ${t(n)??""}px; width: ${t(l)??""}px; background-color: ${e.tag.color??""}44; border-top-color: ${e.tag.color??""};`),z(v,"title",e.tag.name),E(p,e.tag.name)}),te("click",x,c),f(u,v),re()}Ae(["click"]);var Qs=S("<span> </span>"),qs=S('<span class="mt-0.5 font-mono text-[7px] leading-none font-bold text-text-main/20"> </span>'),Ws=S("<div><div></div> <!></div>"),Xs=S('<div class="flex h-6 shrink-0 border-b border-text-main/5 bg-canvas-bg/95"><div class="z-40 flex w-32 shrink-0 items-center border-r border-text-main/10 bg-canvas-bg px-2 font-serif text-[8px] font-black tracking-widest text-text-main/30 uppercase"> </div> <div class="relative flex-1 overflow-hidden" role="presentation"><div class="absolute inset-0 flex items-center"></div></div></div>');function Zs(u,e){ae(e,!0);var a=Xs(),n=i(a),l=i(n,!0);r(n);var c=o(n,2),v=i(c);_e(v,21,()=>e.rulerMarks,Le,(d,p)=>{var x=Ws(),b=i(x),h=o(b,2);{var g=w=>{var m=Qs(),k=i(m,!0);r(m),P(()=>{oe(m,1,`font-mono text-[7px] font-black ${t(p).isMajor&&!t(p).isFuture?"text-ui-accent":"text-text-main/40"} mt-0.5 leading-none`),E(k,t(p).label)}),f(w,m)},y=w=>{var m=qs(),k=i(m,!0);r(m),P(()=>E(k,t(p).index+1)),f(w,m)};O(h,w=>{t(p).label?w(g):t(p).index%5===0&&w(y,1)})}r(x),P(()=>{oe(x,1,`absolute flex flex-col items-center transition-opacity duration-300 ${t(p).isFuture?"opacity-20":"opacity-100"}`),pe(x,`left: ${t(p).index*e.currentFrameWidth}px; width: ${e.currentFrameWidth??""}px;`),oe(b,1,`w-px bg-text-main/20 ${t(p).isMajor?"h-2":"h-1"}`)}),f(d,x)}),r(v),r(c),r(a),P(d=>{E(l,d),pe(v,`width: ${e.maxRulerWidth??""}px; min-width: 100%; transform: translateX(-${e.scrollLeft??""}px);`)},[()=>_("workspace:hud.project_panel.layers")]),te("click",c,function(...d){e.onScrub?.apply(this,d)}),f(u,a),re()}Ae(["click"]);var Js=S('<button><span class="truncate font-serif text-[9px] font-bold uppercase"> </span></button>'),eo=S('<div class="sticky left-0 z-30 flex w-32 shrink-0 flex-col border-r border-text-main/10 bg-canvas-bg/95 shadow-sm"></div>');function to(u,e){ae(e,!0);var a=eo();_e(a,21,()=>s.project.activeFrame.layers,Le,(n,l,c)=>{var v=Js(),d=i(v),p=i(d,!0);r(d),r(v),P(()=>{oe(v,1,`flex h-6 w-full items-center px-2 text-left transition-colors ${c===e.activeLayerIndex?"bg-ui-accent/5 text-ui-accent":"text-text-main/60 hover:bg-text-main/5"}`),E(p,t(l).name)}),te("click",v,()=>e.onSelect(c)),f(n,v)}),r(a),f(u,a),re()}Ae(["click"]);var ao=S('<div style="width: var(--frame-width);"><div></div></div>');function ro(u,e){ae(e,!0);let a=H(()=>e.layer?.hasContent||!1);var n=ao(),l=i(n);r(n),P(()=>{oe(n,1,`flex h-6 items-center justify-center border-r border-text-main/5 transition-colors ${e.isActive?"bg-ui-accent/10":"hover:bg-text-main/5"}`),oe(l,1,`h-2 w-2 rounded-full transition-all ${t(a)?"scale-110 bg-ui-accent shadow-sm":"border border-text-main/20 bg-transparent opacity-30"} ${e.isActive?"ring-4 ring-ui-accent/20":""}`)}),te("click",n,function(...c){e.onclick?.apply(this,c)}),f(u,n),re()}Ae(["click"]);var io=S('<div class="flex h-6 border-b border-text-main/5"></div>'),so=S('<div class="relative flex flex-1 flex-col"><!> <div class="pointer-events-none absolute top-0 bottom-0 z-20 w-px bg-ui-accent transition-all duration-75 ease-linear"><div class="absolute -top-0.5 -left-1 h-2 w-2 rotate-45 rounded-sm bg-ui-accent shadow-sm"></div></div></div>');function oo(u,e){ae(e,!0);var a=so(),n=i(a);_e(n,17,()=>s.project.activeFrame.layers,Le,(c,v,d)=>{var p=io();_e(p,21,()=>s.project.frames,Le,(x,b,h)=>{{let g=H(()=>h===s.project.activeFrameIndex&&d===s.project.activeFrame.activeLayerIndex);ro(x,{get layer(){return t(b).layers[d]},frameIndex:h,get isActive(){return t(g)},onclick:()=>e.onSelectCell(h,d)})}}),r(p),f(c,p)});var l=o(n,2);r(a),P(()=>pe(l,`left: ${e.playheadOffset??""}px;`)),f(u,a),re()}var no=S('<div class="h-4 shrink-0 overflow-hidden bg-text-main/5"><div class="relative h-full"></div></div>'),lo=S('<div class="relative flex min-h-0 flex-1 flex-col overflow-hidden rounded border border-text-main/10 bg-sidebar-bg/30 shadow-inner"><!> <!> <div class="custom-scrollbar min-h-0 flex-1 overflow-auto svelte-1duzj14" role="grid" aria-label="The Drop Matrix"><div class="relative flex"><!> <!></div></div></div>');function co(u,e){ae(e,!0);let a=ce(void 0),n=ce(0);const l=32;let c=H(()=>l*s.studio.timelineZoom);function v(I){const $=I.target;B(n,$.scrollLeft,!0)}function d(I,$){s.project.activeFrameIndex=I,s.project.activeFrame.activeLayerIndex=$}let p=H(()=>s.project.activeFrameIndex*t(c)+t(c)/2);He(()=>{if(t(a)&&s.project.isPlaying){const I=t(a).clientWidth/2;t(p)>I&&(t(a).scrollLeft=t(p)-I)}});let x=H(()=>s.project.frames.length*t(c)+400),b=H(()=>{const I=[],$=s.project.fps,j=s.studio.timelineZoom,R=s.project.frames.length;let F=1;j>3?F=.1:j>2?F=.2:j>1.2&&(F=.5);const ee=Math.max(1,Math.round($*F)),J=Math.ceil(t(x)/t(c));for(let D=0;D<J;D++){const G=D%ee===0,U=D%$===0,Z=D%5===0,de=D>=R;if(G){const V=D/$,N=V%1===0?`${V}s`:`${V.toFixed(1)}s`;I.push({index:D,isMajor:U,label:N,isFuture:de})}else Z&&I.push({index:D,isMajor:!1,isFuture:de})}return I});function h(I){const $=I.currentTarget.getBoundingClientRect(),j=I.clientX-$.left+t(n),R=Math.floor(j/t(c));R>=0&&R<s.project.frames.length&&(s.project.activeFrameIndex=R)}function g(I){if(I.ctrlKey){I.preventDefault();const $=I.deltaY>0?-.1:.1;s.studio.timelineZoom=Math.max(.5,Math.min(4,s.studio.timelineZoom+$))}}var y=lo(),w=i(y);{var m=I=>{var $=no(),j=i($);_e(j,21,()=>s.project.tags,R=>R.id,(R,F)=>{Ks(R,{get tag(){return t(F)}})}),r(j),r($),P(()=>pe(j,`width: ${t(x)??""}px; margin-left: 128px; transform: translateX(-${t(n)??""}px);`)),f(I,$)};O(w,I=>{s.project.tags.length>0&&I(m)})}var k=o(w,2);Zs(k,{get rulerMarks(){return t(b)},get maxRulerWidth(){return t(x)},get currentFrameWidth(){return t(c)},get scrollLeft(){return t(n)},onScrub:h});var A=o(k,2),C=i(A),T=i(C);to(T,{get activeLayerIndex(){return s.project.activeFrame.activeLayerIndex},onSelect:I=>s.project.activeFrame.activeLayerIndex=I});var L=o(T,2);oo(L,{get playheadOffset(){return t(p)},onSelectCell:d}),r(C),r(A),gt(A,I=>B(a,I),()=>t(a)),r(y),P(()=>pe(C,`width: ${t(x)+128}px; min-height: 100%; --frame-width: ${t(c)??""}px;`)),Oe("scroll",A,v),Oe("wheel",A,g),f(u,y),re()}var vo=S('<span class="text-[10px] opacity-40"> </span>'),uo=S('<span class="text-[10px] opacity-40"> </span>'),po=S('<div role="region" aria-label="Timeline"><div class="flex items-center justify-between border-b border-text-main/5 pb-1"><div class="flex min-w-0 flex-1 items-center gap-6"><div class="flex shrink-0 items-center gap-2"><span class="text-[10px] opacity-30" aria-hidden="true">üåÄ</span> <span class="font-tiny5 text-[9px] tracking-[0.2em] text-text-main/40 uppercase"> </span></div> <!></div> <div class="flex items-center gap-4"><div class="mr-4 flex flex-col items-end"><span class="font-serif text-[7px] font-black tracking-widest text-text-main/20 uppercase"> </span> <span class="font-mono text-[9px] font-bold text-ui-accent/40"> </span></div> <div class="flex items-center gap-1 border-l border-text-main/10 pl-4"><!> <!></div></div></div> <div><!></div></div>');function fo(u,e){ae(e,!0);let a=H(()=>s.studio.isTimelineMinimized?"h-12":s.studio.isTimelineMaximized?"h-[75vh]":"h-40");function n(){s.studio.isTimelineMinimized=!s.studio.isTimelineMinimized,s.studio.isTimelineMinimized&&(s.studio.isTimelineMaximized=!1)}function l(){s.studio.isTimelineMaximized=!s.studio.isTimelineMaximized,s.studio.isTimelineMaximized&&(s.studio.isTimelineMinimized=!1)}var c=po(),v=i(c),d=i(v),p=i(d),x=o(i(p),2),b=i(x,!0);r(x),r(p);var h=o(p,2);Vs(h,{}),r(d);var g=o(d,2),y=i(g),w=i(y),m=i(w,!0);r(w);var k=o(w,2),A=i(k,!0);r(k),r(y);var C=o(y,2),T=i(C);{let j=H(()=>s.studio.isTimelineMinimized?"ui:labels.confirm":"ui:labels.minimize");xe(T,{variant:"ghost",size:"sm",onclick:n,get ariaLabel(){return t(j)},class:"h-5 w-5 !p-0",children:(R,F)=>{var ee=vo(),J=i(ee,!0);r(ee),P(()=>E(J,s.studio.isTimelineMinimized?"üîº":"üîΩ")),f(R,ee)},$$slots:{default:!0}})}var L=o(T,2);{let j=H(()=>s.studio.isTimelineMaximized?"ui:labels.confirm":"ui:labels.maximize");xe(L,{variant:"ghost",size:"sm",onclick:l,get ariaLabel(){return t(j)},class:"h-5 w-5 !p-0",children:(R,F)=>{var ee=uo(),J=i(ee,!0);r(ee),P(()=>E(J,s.studio.isTimelineMaximized?"üóó":"‚è´")),f(R,ee)},$$slots:{default:!0}})}r(C),r(g),r(v);var I=o(v,2),$=i(I);co($,{}),r(I),r(c),P((j,R,F)=>{oe(c,1,`flex ${t(a)??""} w-full flex-col gap-1 overflow-hidden bg-transparent px-4 py-2 transition-all duration-300 ease-in-out`),E(b,j),E(m,R),E(A,F),oe(I,1,`flex min-h-0 flex-1 flex-col overflow-hidden ${s.studio.isTimelineMinimized?"pointer-events-none opacity-0":"opacity-100"} transition-opacity duration-300`)},[()=>_("timeline:title"),()=>_("timeline:track"),()=>_("timeline:frame_count",{replace:{count:s.project.frames.length}})]),f(u,c),re()}var xo=S('<footer class="hud-panel flex w-full flex-col border-t border-text-main/10 bg-canvas-bg p-1 svelte-4mqt4m"><!> <div class="flex h-7 w-full items-center justify-between px-4"><div class="flex items-center gap-4"><!></div> <!></div></footer>');function go(u){var e=xo(),a=i(e);fo(a,{});var n=o(a,2),l=i(n),c=i(l);ts(c,{}),r(l);var v=o(l,2);Bs(v),r(n),r(e),f(u,e)}var ho=S('<div class="absolute top-0 bottom-0 left-1/2 z-30 w-px -translate-x-1/2 border-l border-dashed border-ui-accent/50 shadow-sm"></div>'),mo=S('<div class="absolute top-1/2 right-0 left-0 z-30 h-px -translate-y-1/2 border-t border-dashed border-ui-accent/50 shadow-sm"></div>'),bo=S('<div class="absolute top-0 bottom-0 w-px -translate-x-1/2 bg-text-main/20"></div>'),_o=S('<div class="absolute right-0 left-0 h-px -translate-y-1/2 bg-text-main/20"></div>'),Ao=S('<div class="pointer-events-none absolute inset-0 z-20 overflow-hidden"><div class="absolute top-0 bottom-0 left-1/2 w-px -translate-x-1/2 bg-text-main/40"></div> <div class="absolute top-1/2 right-0 left-0 h-px -translate-y-1/2 bg-text-main/40"></div> <!> <!> <!> <!></div>');function yo(u,e){ae(e,!1);const a=s.studio;je();var n=Ao(),l=o(i(n),4);{var c=b=>{var h=ho();fe(3,h,()=>be),f(b,h)};O(l,b=>{(a.symmetryMode==="HORIZONTAL"||a.symmetryMode==="QUADRANT")&&b(c)})}var v=o(l,2);{var d=b=>{var h=mo();fe(3,h,()=>be),f(b,h)};O(v,b=>{(a.symmetryMode==="VERTICAL"||a.symmetryMode==="QUADRANT")&&b(d)})}var p=o(v,2);_e(p,0,()=>[-24,-16,-8,8,16,24],Le,(b,h)=>{const g=bt(()=>Gt.getGuidePosition(h,s.canvas.width));var y=Te(),w=ne(y);{var m=k=>{var A=bo();P(()=>pe(A,`left: ${t(g)??""}%`)),f(k,A)};O(w,k=>{t(g)>0&&t(g)<100&&k(m)})}f(b,y)});var x=o(p,2);_e(x,0,()=>[-24,-16,-8,8,16,24],Le,(b,h)=>{const g=bt(()=>Gt.getGuidePosition(h,s.canvas.height));var y=Te(),w=ne(y);{var m=k=>{var A=_o();P(()=>pe(A,`top: ${t(g)??""}%`)),f(k,A)};O(w,k=>{t(g)>0&&t(g)<100&&k(m)})}f(b,y)}),r(n),f(u,n),re()}var wo=lt('<line stroke-dasharray="0.2, 0.2" class="marching-ants-svg svelte-jh22g1"></line>'),ko=lt('<line stroke="var(--color-ui-accent)" stroke-width="0.05" stroke-dasharray="0.1, 0.1"></line>'),Eo=lt('<circle r="0.2" fill="var(--color-ui-accent)"></circle><!>',1),Lo=lt('<svg class="pointer-events-none absolute inset-0 z-40 h-full w-full overflow-visible" style="grid-column: 1 / -1; grid-row: 1 / -1;" shape-rendering="crispEdges"><defs><pattern id="ants" width="1" height="1" patternUnits="userSpaceOnUse"><line x1="0" y1="0" x2="1" y2="0" stroke="var(--ants-color)" stroke-width="0.1" stroke-dasharray="0.2, 0.2"></line></pattern></defs><!><!></svg><svg class="pointer-events-none absolute inset-0 z-[39] h-full w-full overflow-visible" style="grid-column: 1 / -1; grid-row: 1 / -1;" shape-rendering="crispEdges"><path fill="var(--color-ui-accent)" fill-opacity="0.1"></path></svg>',1);function So(u,e){ae(e,!0);let a=H(()=>s.selection.getBoundaryEdges(s.canvas.width)),n=H(()=>s.selection.vertices),l=H(()=>Je.current.type==="SELECT"),c=H(()=>s.selection.maskCount>5e3?"":s.selection.getPoints(s.canvas.width).map(x=>`M${x.x},${x.y}h1v1h-1z`).join(" "));var v=Te(),d=ne(v);{var p=x=>{var b=Lo(),h=ne(b),g=o(i(h));_e(g,17,()=>t(a),Le,(A,C)=>{var T=wo();z(T,"stroke-width",.08),P(()=>{z(T,"x1",t(C).x1),z(T,"y1",t(C).y1),z(T,"x2",t(C).x2),z(T,"y2",t(C).y2),z(T,"stroke",t(l)?"var(--color-ui-accent)":"var(--color-ui-structural)")}),f(A,T)});var y=o(g);{var w=A=>{var C=Te(),T=ne(C);_e(T,17,()=>t(n),Le,(L,I,$)=>{const j=H(()=>t(n)[$+1]||t(n)[0]);var R=Eo(),F=ne(R),ee=o(F);{var J=D=>{var G=ko();P(()=>{z(G,"x1",t(I).x+.5),z(G,"y1",t(I).y+.5),z(G,"x2",t(j).x+.5),z(G,"y2",t(j).y+.5)}),f(D,G)};O(ee,D=>{t(n).length>1&&$<t(n).length-(t(n).length>=3?0:1)&&D(J)})}P(()=>{z(F,"cx",t(I).x+.5),z(F,"cy",t(I).y+.5)}),f(L,R)}),f(A,C)};O(y,A=>{t(n).length>0&&A(w)})}r(h);var m=o(h),k=i(m);r(m),P(()=>{z(h,"viewBox",`0 0 ${s.canvas.width??""} ${s.canvas.height??""}`),z(m,"viewBox",`0 0 ${s.canvas.width??""} ${s.canvas.height??""}`),z(k,"d",t(c))}),f(x,b)};O(d,x=>{s.selection.isActive&&x(p)})}f(u,v),re()}var Co=S('<div class="absolute flex items-center justify-center"><span class="font-mono text-[8px] font-bold text-text-main/40"> </span></div>'),To=S('<div class="pointer-events-none relative h-full w-full overflow-hidden bg-canvas-bg/80 backdrop-blur-sm" role="presentation"><div><div></div> <div></div> <!> <div class="absolute z-20 bg-ui-accent transition-all duration-75 ease-out"><div class="absolute top-1/2 left-1/2 rounded-sm bg-ui-accent px-1 py-0.5 shadow-sm"><span class="font-mono text-[9px] leading-none font-bold text-white"> </span></div></div></div></div>');function da(u,e){ae(e,!0);let a=se(e,"orientation",3,"horizontal"),n=H(()=>s.canvas.width),l=H(()=>s.canvas.height),c=H(()=>a()==="horizontal"?t(n):t(l)),v=H(()=>a()==="horizontal"?s.cursor.pos.x:s.cursor.pos.y),d=H(()=>{const I=s.studio.zoomLevel;return I<=.5?16:I<=1.5?8:I<=4?4:2}),p=H(()=>s.canvas.getFitDimension(a())),x=H(()=>s.studio.zoomLevel),b=H(()=>{const I=[];for(let $=0;$<t(c);$++){const j=Gt.toCartesianLabel($,t(c),a()==="vertical");(j%t(d)===0||$===0||$===t(c)-1)&&I.push({pos:$,label:j})}return I}),h=H(()=>{if(t(x)<=1)return a()==="horizontal"?"translate(-50%, 0)":"translate(0, -50%)";const I=(t(v)+.5)/t(c)*100;return a()==="horizontal"?`translate(-${I}%, 0)`:`translate(0, -${I}%)`});var g=To(),y=i(g),w=i(y),m=o(w,2),k=o(m,2);_e(k,17,()=>t(b),I=>I.pos,(I,$)=>{var j=Co(),R=i(j),F=i(R,!0);r(R),r(j),P(()=>{pe(j,`
					${a()==="horizontal"?"left":"top"}: ${t($).pos/t(c)*100}%;
					${a()==="horizontal"?"width":"height"}: ${100/t(c)}%;
					${a()==="horizontal"?"height":"width"}: 100%;
					${a()==="horizontal"?"padding-bottom: 4px;":"padding-right: 4px;"}
				`),pe(R,`transform: ${a()==="vertical"?"rotate(-90deg)":"none"};`),E(F,t($).label)}),f(I,j)});var A=o(k,2),C=i(A),T=i(C),L=i(T,!0);r(T),r(C),r(A),r(y),r(g),P(I=>{oe(y,1,`absolute flex ${a()==="vertical"?"flex-col":""}`),pe(y,`
			left: ${a()==="horizontal"?"50%":"0"};
			top: ${a()==="vertical"?"50%":"0"};
			transform: ${t(h)??""}; 
			${a()==="horizontal"?"width":"height"}: calc(${t(p)??""} * ${t(x)??""});
			${a()==="vertical"?"width":"height"}: 100%;
		`),oe(w,1,`absolute opacity-10 ${a()==="horizontal"?"right-0 bottom-0 left-0 h-1/2":"top-0 right-0 bottom-0 w-1/2"}`),pe(w,`
				background-image: linear-gradient(${a()==="horizontal"?"to right":"to bottom"}, 
					var(--color-text-main) 1px, transparent 1px);
				background-size: ${a()==="horizontal"?`calc(100% / ${t(c)}) 100%`:`100% calc(100% / ${t(c)})`};
			`),oe(m,1,`absolute opacity-20 ${a()==="horizontal"?"right-0 bottom-0 left-0 h-3/4":"top-0 right-0 bottom-0 w-3/4"}`),pe(m,`
				background-image: linear-gradient(${a()==="horizontal"?"to right":"to bottom"}, 
					var(--color-text-main) 1.5px, transparent 1.5px);
				background-size: ${a()==="horizontal"?`calc(100% / ${t(c)} * ${t(d)}) 100%`:`100% calc(100% / ${t(c)} * ${t(d)})`};
			`),pe(A,`
				${a()==="horizontal"?"left":"top"}: ${(t(v)+.5)/t(c)*100}%;
				${a()==="horizontal"?"width: 1px; top: 0; bottom: 0;":"height: 1px; left: 0; right: 0;"}
			`),pe(C,`transform: translate(-50%, -50%) ${a()==="vertical"?"rotate(-90deg)":""};`),E(L,I)},[()=>Gt.toCartesianLabel(t(v),t(c),a()==="vertical")]),f(u,g),re()}var Io=S('<div class="absolute -top-3 -right-3 flex items-center justify-center rounded-full border-2 border-canvas-bg bg-ui-accent p-1 text-[8px] font-bold text-white shadow-lg ring-1 ring-text-main/10"><!></div>'),Po=S('<div class="absolute inset-[-4px] z-0 animate-ping rounded-sm border-2 border-canvas-bg opacity-20"></div> <div class="absolute -top-10 left-1/2 z-[110] flex -translate-x-1/2 flex-col items-center"><div class="relative h-7 w-7 overflow-hidden rounded-xl rounded-br-none border-4 border-canvas-bg bg-canvas-bg shadow-xl ring-1 ring-text-main/10" style="transform: rotate(45deg);"><div class="h-full w-full -rotate-45"></div></div> <div class="-mt-0.5 h-2 w-0.5 rounded-xl bg-canvas-bg opacity-80 shadow-sm"></div></div>',1),jo=S('<div class="cursor-container absolute inset-0 svelte-1j5kr8v"><div class="cursor-bloom transition-transform duration-200 svelte-1j5kr8v"><div class="petal p-top svelte-1j5kr8v"></div> <div class="petal p-bottom svelte-1j5kr8v"></div> <div class="petal p-left svelte-1j5kr8v"></div> <div class="petal p-right svelte-1j5kr8v"></div> <div class="center-dot svelte-1j5kr8v"></div></div> <!> <!></div>');function $o(u,e){ae(e,!1);const a=s.studio;je();var n=Te(),l=ne(n);{var c=v=>{var d=jo(),p=i(d),x=o(p,2);{var b=y=>{var w=Io(),m=i(w);{var k=L=>{var I=ve("üîí");f(L,I)},A=L=>{var I=ve("‚òÄÔ∏è");f(L,I)},C=L=>{var I=ve("üåô");f(L,I)},T=L=>{var I=ve("üèÅ");f(L,I)};O(m,L=>{a.isAlphaLocked||a.isColorLocked?L(k):a.isShadingLighten?L(A,1):a.isShadingDarken?L(C,2):a.isShadingDither&&L(T,3)})}r(w),fe(3,w,()=>Lt),f(y,w)};O(x,y=>{(a.isAlphaLocked||a.isColorLocked||a.isShadingLighten||a.isShadingDarken||a.isShadingDither)&&y(b)})}var h=o(x,2);{var g=y=>{var w=Po(),m=ne(w),k=o(m,2),A=i(k),C=i(A);r(A),ge(2),r(k),P(()=>{pe(m,`background-color: ${s.activeColor??""};`),pe(C,`background-color: ${s.activeColor??""};`)}),fe(3,m,()=>be,()=>({duration:400})),fe(1,k,()=>Yt,()=>({y:-10,duration:400})),fe(2,k,()=>be,()=>({duration:400})),f(y,w)};O(h,y=>{s.isPicking&&y(g)})}r(d),P(()=>pe(p,`transform: scale(${a.brushSize??""})`)),fe(3,d,()=>be,()=>({duration:800})),f(v,d)};O(l,v=>{s.isCursorVisible&&v(c)})}f(u,n),re()}var Ro=lt('<rect fill="none" stroke="var(--color-ui-accent)" stroke-width="0.1" stroke-dasharray="0.2, 0.2" class="marching-ants svelte-1msfnni"></rect>'),Mo=lt('<ellipse fill="none" stroke="var(--color-ui-accent)" stroke-width="0.1" stroke-dasharray="0.2, 0.2" class="marching-ants svelte-1msfnni"></ellipse>'),Oo=lt('<polyline fill="none" stroke="var(--color-ui-accent)" stroke-width="0.1" stroke-dasharray="0.2, 0.2" class="marching-ants svelte-1msfnni"></polyline><line stroke="var(--color-ui-accent)" stroke-width="0.1" stroke-dasharray="0.2, 0.2" class="marching-ants svelte-1msfnni"></line>',1),Do=lt('<svg class="pointer-events-none absolute inset-0 z-40 h-full w-full overflow-visible" preserveAspectRatio="none"><!></svg>');function zo(u,e){ae(e,!0);var a=Te(),n=ne(a);{var l=c=>{const v=H(()=>s.studio.shapeAnchor),d=H(()=>s.cursor.pos),p=H(()=>Math.min(t(v).x,t(d).x)),x=H(()=>Math.min(t(v).y,t(d).y)),b=H(()=>Math.max(t(v).x,t(d).x)),h=H(()=>Math.max(t(v).y,t(d).y)),g=H(()=>t(b)-t(p)+1),y=H(()=>t(h)-t(x)+1);var w=Do(),m=i(w);{var k=T=>{var L=Ro();P(()=>{z(L,"x",t(p)),z(L,"y",t(x)),z(L,"width",t(g)),z(L,"height",t(y))}),f(T,L)},A=T=>{var L=Mo();P(()=>{z(L,"cx",t(p)+t(g)/2),z(L,"cy",t(x)+t(y)/2),z(L,"rx",t(g)/2),z(L,"ry",t(y)/2)}),f(T,L)},C=T=>{const L=H(()=>(t(v).x+t(d).x)/2),I=H(()=>(t(v).y+t(d).y)/2),$=H(()=>Math.max(Math.abs(t(d).x-t(v).x),Math.abs(t(d).y-t(v).y))/2),j=H(()=>s.studio.polygonSides),R=H(()=>s.studio.polygonIndentation),F=H(()=>Array.from({length:t(R)>0?t(j)*2:t(j)}).map((G,U)=>{const Z=-Math.PI/2+U*2*Math.PI/(t(R)>0?t(j)*2:t(j)),de=t(R)>0?U%2===0?t($):t($)*(1-t(R)/100):t($);return`${t(L)+.5+Math.cos(Z)*de},${t(I)+.5+Math.sin(Z)*de}`}));var ee=Oo(),J=ne(ee),D=o(J);P((G,U,Z,de,V)=>{z(J,"points",G),z(D,"x1",U),z(D,"y1",Z),z(D,"x2",de),z(D,"y2",V)},[()=>t(F).join(" "),()=>t(L)+.5+Math.cos(-Math.PI/2+((t(R)>0?t(j)*2:t(j))-1)*2*Math.PI/(t(R)>0?t(j)*2:t(j)))*(t(R)>0?((t(R)>0?t(j)*2:t(j))-1)%2===0?t($):t($)*(1-t(R)/100):t($)),()=>t(I)+.5+Math.sin(-Math.PI/2+((t(R)>0?t(j)*2:t(j))-1)*2*Math.PI/(t(R)>0?t(j)*2:t(j)))*(t(R)>0?((t(R)>0?t(j)*2:t(j))-1)%2===0?t($):t($)*(1-t(R)/100):t($)),()=>t(L)+.5+Math.cos(-Math.PI/2)*t($),()=>t(I)+.5+Math.sin(-Math.PI/2)*t($)]),f(T,ee)};O(m,T=>{s.studio.activeTool==="RECTANGLE"?T(k):s.studio.activeTool==="ELLIPSE"?T(A,1):s.studio.activeTool==="POLYGON"&&T(C,2)})}r(w),P(()=>z(w,"viewBox",`0 0 ${e.w??""} ${e.h??""}`)),f(c,w)};O(n,c=>{s.studio.activeTool!=="BRUSH"&&s.studio.shapeAnchor&&c(l)})}f(u,a),re()}var Fo=S('<div class="pointer-events-none absolute inset-0 z-[5] overflow-hidden"><img class="absolute origin-top-left"/></div>');function No(u,e){ae(e,!1);const a=s.studio;je();var n=Te(),l=ne(n);{var c=v=>{var d=Fo(),p=i(d);r(d),P(x=>{pe(d,`opacity: ${a.underlayOpacity??""}`),z(p,"src",a.underlayImage),z(p,"alt",x),pe(p,`
                transform: translate(${a.underlayOffset.x??""}px, ${a.underlayOffset.y??""}px) scale(${a.underlayScale??""});
                image-rendering: auto;
            `)},[()=>_("workspace:underlay")]),fe(3,d,()=>be),f(v,d)};O(l,v=>{a.underlayImage&&a.isUnderlayVisible&&v(c)})}f(u,n),re()}var Bo=S('<canvas class="pointer-events-none absolute inset-0 z-0 h-full w-full"></canvas>');function Go(u,e){ae(e,!0);let a=se(e,"opacity",3,.2),n=se(e,"tint",3,null),l=ce(null);He(()=>{const v=t(l)?.getContext("2d");if(!(!v||!t(l))){v.imageSmoothingEnabled=!1,v.clearRect(0,0,e.width,e.height);for(let d=0;d<e.pixels.length;d++){const p=e.pixels[d];if(p!==0){const x=n()||vt.uint32ToHex(p);v.fillStyle=x;const b=d%e.width,h=Math.floor(d/e.width);v.fillRect(b,h,1,1)}}}});var c=Bo();gt(c,v=>B(l,v),()=>t(l)),P(()=>{z(c,"width",e.width),z(c,"height",e.height),pe(c,`opacity: ${a()??""}; image-rendering: pixelated;`)}),f(u,c),re()}function Ho(u,e){ae(e,!0);let a=H(()=>{if(!s.showGhostLayers)return[];const v=s.project.activeFrameIndex,d=s.project.frames,p=[];for(let x=1;x<=3;x++){const b=v-x;b>=0&&p.push({id:`past-${b}`,pixels:d[b].compositePixels,opacity:.4/x,tint:"#8d99ae"})}for(let x=1;x<=3;x++){const b=v+x;b<d.length&&p.push({id:`future-${b}`,pixels:d[b].compositePixels,opacity:.4/x,tint:"#a3b18a"})}return p});var n=Te(),l=ne(n);{var c=v=>{var d=Te(),p=ne(d);_e(p,17,()=>t(a),x=>x.id,(x,b)=>{Go(x,{get pixels(){return t(b).pixels},get width(){return e.w},get height(){return e.h},get opacity(){return t(b).opacity},get tint(){return t(b).tint}})}),f(v,d)};O(l,v=>{s.showGhostLayers&&v(c)})}f(u,n),re()}var Uo=lt('<polyline fill="none" stroke-linecap="round" stroke-linejoin="round"></polyline>'),Vo=lt('<svg class="pointer-events-none absolute inset-0 z-[20] h-full w-full overflow-visible" preserveAspectRatio="none"><!></svg>');function Yo(u,e){ae(e,!0);let a=H(()=>xt.isSnappedState),n=H(()=>s.canvas.strokePoints.map(d=>`${d.x},${d.y}`).join(" "));var l=Vo(),c=i(l);{var v=d=>{var p=Uo();P(()=>{z(p,"points",t(n)),z(p,"stroke",s.paletteState.activeColor),z(p,"stroke-width",t(a)?"0.08":"0.03"),z(p,"stroke-dasharray",t(a)?"none":"0.1 0.1"),oe(p,0,`${t(a)?"drop-shadow-md":"marching-ants"} transition-all duration-300`,"svelte-zydpx5"),pe(p,`opacity: ${t(a)?"1":"0.4"}`)}),f(d,p)};O(c,d=>{s.canvas.strokePoints.length>1&&d(v)})}r(l),P(()=>z(l,"viewBox",`0 0 ${e.w??""} ${e.h??""}`)),f(u,l),re()}var Ko=S('<div class="pointer-events-none absolute inset-0 z-0 opacity-20 blur-[1px] grayscale"></div>'),Qo=S('<div class="canvas-viewport relative grid h-full w-full grid-cols-[20px_1fr] grid-rows-[20px_1fr] overflow-hidden svelte-5wsvqt"><div class="z-[30] border-r border-b border-text-main/10 bg-canvas-bg/90 backdrop-blur-md" aria-hidden="true"></div> <div class="relative z-[20] border-b border-text-main/10"><!></div> <div class="relative z-[20] border-r border-text-main/10"><!></div> <div class="relative flex flex-1 items-center justify-center overflow-hidden bg-ui-structural/[0.05]"><!> <div class="canvas-container absolute top-1/2 left-1/2 origin-center transition-transform duration-500 ease-[cubic-bezier(0.23,1,0.32,1)] svelte-5wsvqt"><div class="relative h-full w-full shadow-[0_20px_60px_rgba(0,0,0,0.12)] ring-1 ring-text-main/5 outline-none focus:ring-2 focus:ring-ui-accent" role="grid" tabindex="0"><!> <!> <!> <canvas class="pointer-events-none absolute inset-0 h-full w-full" style="image-rendering: pixelated;"></canvas> <!> <div class="pixel-grid-surface pointer-events-none absolute inset-0 z-10 h-full w-full"></div> <div class="pointer-events-none absolute inset-0 z-30 overflow-hidden"><div class="absolute transition-all duration-75 ease-out"><!></div></div> <!> <!></div></div></div></div>');function qo(u,e){ae(e,!0);let a=ce(null),n=ce(null);He(()=>{if(t(a)){const U=Xe.connectCanvas(t(a));return()=>U()}});let l=H(()=>s.canvas.width),c=H(()=>s.canvas.height),v=H(()=>s.studio.isTilingEnabled),d=ce("");function p(U){if(U.ctrlKey){U.preventDefault();const Z=U.deltaY>0?-.1:.1;s.studio.setZoom(Z)}}He(()=>{if(s.canvas.version===-1)return;const Z=t(n)?.getContext("2d",{alpha:!0}),de=s.canvas.compositePixels;if(!Z||!t(n))return;Z.imageSmoothingEnabled=!1;const V=Z.createImageData(t(l),t(c));new Uint32Array(V.data.buffer).set(de),Z.putImageData(V,0,0),t(v)&&B(d,t(n).toDataURL(),!0)});var x=Qo();Oe("pointermove",ta,U=>t(a)&&xt.handleMove(U,t(a))),Oe("pointerup",ta,()=>xt.handleEnd());var b=o(i(x),2),h=i(b);da(h,{orientation:"horizontal"}),r(b);var g=o(b,2),y=i(g);da(y,{orientation:"vertical"}),r(g);var w=o(g,2),m=i(w);{var k=U=>{var Z=Ko();P((de,V)=>pe(Z,`
					background-image: url(${t(d)??""});
					background-repeat: repeat;
					background-size: ${de??""} ${V??""};
					background-position: center;
					transform: ${s.cameraTransform??""};
				`),[()=>s.canvas.getFitDimension("horizontal"),()=>s.canvas.getFitDimension("vertical")]),fe(3,Z,()=>be),f(U,Z)};O(m,U=>{t(v)&&U(k)})}var A=o(m,2),C=i(A),T=i(C);yo(T,{});var L=o(T,2);No(L,{});var I=o(L,2);Ho(I,{get w(){return t(l)},get h(){return t(c)}});var $=o(I,2);gt($,U=>B(n,U),()=>t(n));var j=o($,2);zo(j,{get w(){return t(l)},get h(){return t(c)}});var R=o(j,2),F=o(R,2),ee=i(F),J=i(ee);$o(J,{}),r(ee),r(F);var D=o(F,2);Yo(D,{get w(){return t(l)},get h(){return t(c)}});var G=o(D,2);So(G,{}),r(C),gt(C,U=>B(a,U),()=>t(a)),r(A),r(w),r(x),P(U=>{pe(A,`
				transform: ${s.cameraTransform??""};
				aspect-ratio: ${t(l)??""} / ${t(c)??""};
				width: ${U??""};
			`),pe(C,`
										background-color: ${s.backgroundColor??""};
										touch-action: none;
										cursor: ${Je.current.type==="PAN"?xt.isPointerDownActive?"grabbing":"grab":"crosshair"};
									`),z($,"width",t(l)),z($,"height",t(c)),pe(R,`--grid-cols: ${t(l)??""}; --grid-rows: ${t(c)??""};`),pe(ee,`
							left: ${s.cursor.pos.x/t(l)*100}%; 
							top: ${s.cursor.pos.y/t(c)*100}%; 
							width: ${100/t(l)}%; 
							height: ${100/t(c)}%;
						`)},[()=>s.canvas.getFitDimension("horizontal")]),Oe("wheel",x,p),te("contextmenu",C,U=>U.preventDefault()),te("pointerdown",C,U=>t(a)&&xt.handleStart(U,t(a))),f(u,x),re()}Ae(["contextmenu","pointerdown"]);function Ut(u){return--u*u*u*u*u+1}const Wo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAYAAACAvzbMAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAveSURBVHgB7dzLb5z3dcfh886FHHEoizQpyQpl6+K6jRdB3KIN4nhhKksnRf0f2AYSZ5l2V8GLCAicdNdd0SaLchcU6MJABKMtEIgqml6QLGTErlzUUVibimXZskSJpMjhXMoRsrWi3wEZjcTnAQhv3q8lUdR8yFmcCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAdOFTyQvjf3tT+vqurPYsRs/54u/OUHP/6LYOT81eN/+teDweCZGDH9iPOvLZ89EzxwGsGDavhCMB8jZvsFKhhNv4nHfIyYWlUtBQ+kWgBAgoAAkCIgAKQICAApAgJAioAAkCIgAKQICAApAgJAioAAkCIgAKQ4pjgCvj/3wstR1f6+ZPPM1Mk4OjEbu639hSeKnr/66cdx7mfnizZRVQunP/jxK8E9+97c1xaqqnqpZHPqT56PQ48eLJnEvi/OFT1fb7ei9eThos27//qz+MkPflS06Q/6r7x2+c2F4L7yEwgAKQICQIqAAJAiIACkCAgAKQICQIqAAJAiIACkCAgAKQICQIqAAJDSCHbUman5qfrk5DMlm321sS9ONMZLJrGvXvZ8Vm9to+j5RncQB6fL7i3Va7Wp7w6+Pl+yaXS7S6ev/NNSPAQyXzNT7QPHxsbGSiYx1mxGqf7qZpTqrRZ+zdTq8bmnnyzaxGBw/LtV2ddMb3X1wpkbizeCHSMgO2z4QrD9ST1XsplpPXLnOOIo2rh0tej5ifZ4fPVLzxdtfnX5/168cu2jF0s2/XpteHxxIR4C4+2J4Z+96JjmH5x4Kk7MHY/dtvnLT4qer7XLv7F5/NgT8Xuv/VHR5ic/+NF3Gu9e+k7JpjE5eSpuxGKwY7yFBUCKgACQIiAApAgIACkCAkCKgACQIiAApAgIACkCAkCKgACQIiAApLiF9Vu8PvfCyyXPHxp75FirXnbkbnbskXhY9Dvd6F5fK9q0+rU4/rnjJZNYWV15/vV4IR4G0wdmnj8weaBo097XjlE02OpG79P1ok0Mqqi3V4smR04ej1Lvv/2/L74+eOF4yea1y28uBJ+pCu7q+0e/Pih5fmY7Bs/Ofj64d43pdowfnSna/Ncvfh5Lv16Kh8GJ7Xh+6Qt/HHtVfXoixp6YLtqMPz6z/XUzWbR54/W/icsX3yvanF4+6zXyLryFBUCKgACQIiAApAgIACkCAkCKgACQIiAApAgIACkCAkCKgACQIiAApDimyH3XW9uMzeVrRZtjU4fj0KMHizbv/PKdWLtdeOiv0NT+qfj9Y08Vbdr7JgIeRALCfTcYXvDd/igxe3TmzhHGEsPji7sdkGajGSfmjgXsBd7CAiBFQABIERAAUgQEgBQBASBFQABIERAAUgQEgBQBASBFQABIERAAUtzC2mEbvc1YuvlR0abdbMXBfQeCe7d17VZ0r68WbZ5uHoknZ2aLNq2Th4qebzabAXuFgOyw3qAfa92Nok2zXg/K9G93otT+eiti+FGgXXjxF/YSb2EBkCIgAKQICAApAgJAioAAkCIgAKQICAApAgJAioAAkCIgAKQICAApbmHBXaz94v2i5+vt8WidPBywF/gJBIAUAQEgRUAASBEQAFIEBIAUAQEgRUAASBEQAFIEBIAUAQEgRUAASHELawT0B4NY724UbZpVI5p1f327rd5uFT1fjdWjt1b2d1nVa1FrjQX3btDpRW+17PM86PWDneUVaATc7Kzf+Sgx156JqfpksLtaJw8VPT+Mx8alq0WbxnQ7xo/OBPeu89GNKNXf6AQ7y1tYAKQICAApAgJAioAAkCIgAKQICAApAgJAioAAkCIgAKQICAApAgJAiltYv01VLZQ8vtHfOv5hZ2W+ZNOqNWO6MVEyibXuZpTaPzYR9cr3DCW619eKnu93usHuu/L+cqyu3Cza1Gu1N7b/PZcf0eIzVcGO+sbsl+drUT9XsjkydiCenjgSu+3EI4djolF2XZbdt9ePKdanJ2Lsiemizb+9+S/x3tsXo9Cp08tnF4Md49tRAFIEBIAUAQEgRUAASBEQAFIEBIAUAQEgRUAASBEQAFIEBIAUAQEgxTHFHdbtti40m51XSjar3c35i+sfvlSyeWzsQPEBxqvrK9GsrxZt5tqzwb2rtcaiObu/aDM8wLi5fK1oM7yfVW8/HHfNrnywHO+/8/OizfWPry3EoH++aNTrLwU7SkB22MKNxeG1z4WSzTcPfiVudTaKAjJVGI+hte7GduGKJgJSqKpXd17cSwwv/m5eXSna3IlH2S8zslZXbsV7b/930aa/HY/XLr+5ENxX3sICIEVAAEgREABSBASAFAEBIEVAAEgREABSBASAFAEBIEVAAEgREABS3MIaAfWt/mK30ThVsrmydfPbVzorL5Zsntp3OCbr4yWTWLr5UdHzrUYzHpt4NPaq/sZWbFwq+5xVY41onTxUtBkebRxF12/diAvvvlW02ehsDo8ininZbK2tXwjuOwEZAX974z+Xtv+zVLJ5debZl6Mq+wFya9CLUncOMHLPBr1+9NY2izaN7YA8LJd1t7a24uqnHxdtoqp+dXr57GLwwPEWFgApAgJAioAAkCIgAKQICAApAgJAioAAkCIgAKQICAApAgJAioAAkFIFe8a3Zp87N4iYL9l8derzsdumxtsx156Nh0G9PR6tk4eLNt3ra7G5fK1oM350JhrT7dht//DP/xiFFk8vny06DMqDy08gAKQICAApAgJAioAAkCIgAKQICAApAgJAioAAkCIgAKQICAApAgJASiPYM/qDwVu1quz82fXu+nzJ842qHvvr4yWT4e8r1rsbRZtm1YhmffS+fAe9fvTWyv4s/U436u1WlCr9dW521mNr0ItCiyUPV1V1IdgzHFPkrl6dfW5Q8vx0YyL+cPKJ2G1z7ZmYGp+Mh8HwKOLwOGKJ4fHF4RHGEv9x7WJc27wVJU4vn/UawWfyFhYAKQICQIqAAJAiIACkCAgAKQICQIqAAJAiIACkCAgAKQICQIqAAJDimCJ3VQ1ioeT5zqB7/MPOynzJplVr3rmhVWKtuxml9o9NRL0ave+ZBp1u8V2rT1avx+r6zaJNLao3oqpuBOwQh9LYUd+Y/fJ8LernSjZHxg7E0xNHYredeORwTDTKr96Oogs3LsXy+idR6NTp5bOLATvEW1gApAgIACkCAkCKgACQIiAApAgIACkCAkCKgACQIiAApAgIACkCAkCKY4rsqG63daHZ7LxSslntbs5fXP/wpZLNY2MHig8wXl1fiWZ9tWgz156N3Xb59qdx8davizab/c5CDPrni0a9/lLADhIQdtTCjcXhtdeFks03D34lbnU2igIyVRiPobXuxnbhiia/k4Dc7N6Oi6uXizaDweD8D6/9+0LAfeQtLABSBASAFAEBIEVAAEgREABSBASAFAEBIEVAAEgREABSBASAFAEBIMUtLO67+lZ/sdtonCrZXNm6+e0rnZUXY5f9z8bV2G23e5vn+1GdKdlM9poXAu6zKuAB9OrMswtR1YoOMI6qahALf3ftp0UXjGEUeAsLgBQBASBFQABIERAAUgQEgBQBASBFQABIERAAUgQEgBQBASBFQABIcQuLPeNbs8+dG0TMxy7a/v8v/vCTnxYdhoQHlZ9AAEgREABSBASAFAEBIEVAAEgREABSBASAFAEBIEVAAEgREABSBASAlEbAHtEfDN6qVbt+/u1CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKPq/wHHEEo6B7wOjAAAAABJRU5ErkJggg==";var Xo=S('<div class="fixed inset-0 z-[2000] flex flex-col items-center justify-center bg-canvas-bg" role="dialog" aria-modal="true"><svg class="pointer-events-none absolute inset-0 h-full w-full opacity-[var(--grain-opacity,0.03)]"><filter id="grain"><feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="3" stitchTiles="stitch"></feTurbulence><feColorMatrix type="saturate" values="0"></feColorMatrix></filter><rect width="100%" height="100%" filter="url(#grain)"></rect></svg> <div class="absolute h-[500px] w-[500px] animate-pulse rounded-full bg-ui-structural/5 blur-[120px]" aria-hidden="true"></div> <div class="relative flex flex-col items-center gap-2"><div class="mb-8 flex animate-bounce items-center justify-center"><img class="h-32 w-auto drop-shadow-2xl transition-transform duration-[3s] ease-in-out"/></div> <div><!></div></div> <div class="absolute bottom-24 flex flex-col items-center gap-8"><div class="flex flex-col items-center gap-4"><div class="h-1 w-48 overflow-hidden rounded-full bg-ui-structural/5 ring-1 ring-grid-border/10" role="progressbar" aria-valuemin="0" aria-valuemax="100"><div></div></div> <div class="flex flex-col items-center gap-1 text-center"><span class="h-4 font-serif text-[11px] tracking-wide text-text-main/80 italic"> </span> <span class="font-mono text-[8px] font-bold tracking-[0.3em] text-text-main/40 uppercase"> </span></div></div></div></div>');function Zo(u,e){ae(e,!0);let a=ce(!0),n=ce(0),l=ce(0),c=ce(!1);const v=5;function d(){he.emit("READY"),B(a,!1),setTimeout(()=>{s.isAppReady=!0,s.showManual=!0},800)}_t(()=>{try{he.emit("STARTUP")}catch(g){console.warn("Feedback engine failed to start:",g)}const h=setInterval(()=>{if(t(n)<100){const g=Math.random()*15;B(n,Math.min(100,t(n)+g),!0),B(l,Math.min(v-1,Math.floor(t(n)/100*v)),!0)}else clearInterval(h),setTimeout(()=>{B(c,!0),d()},600)},400);return()=>{clearInterval(h)}});var p=Te(),x=ne(p);{var b=h=>{var g=Xo(),y=o(i(g),4),w=i(y),m=i(w);pe(m,`transform: scale(${1+Math.sin(Date.now()/1500)*.05});`),r(w);var k=o(w,2),A=i(k);ya(A,{size:"lg"}),r(k),r(y);var C=o(y,2),T=i(C),L=i(T),I=i(L);r(L);var $=o(L,2),j=i($),R=i(j,!0);r(j);var F=o(j,2),ee=i(F,!0);r(F),r($),r(T),r(C),r(g),P((J,D,G,U)=>{z(g,"aria-busy",!t(c)),z(g,"aria-label",J),z(m,"src",Wo),z(m,"alt",D),z(L,"aria-valuenow",t(n)),oe(I,1,`h-full bg-text-main/40 transition-all duration-500 ease-out ${t(c)?"bg-ui-accent/60":""}`),pe(I,`width: ${t(n)??""}%`),E(R,G),E(ee,U)},[()=>_("splash:title"),()=>_("common:app.name"),()=>t(c)?_("splash:welcome"):_(`splash:phases.${t(l)}`),()=>_("splash:version",{replace:{version:s.version}})]),fe(1,w,()=>Lt,()=>({duration:1500,start:.9,easing:Ut})),fe(1,k,()=>Yt,()=>({y:15,duration:1e3,delay:400,easing:Ut})),fe(2,g,()=>be,()=>({duration:1e3})),f(h,g)};O(x,h=>{t(a)&&h(b)})}f(u,p),re()}var Jo=S('<div class="flex flex-col gap-2"><div class="flex justify-between font-serif text-[10px] font-bold tracking-wider uppercase opacity-40"><div class="flex items-center gap-1.5"><span> </span> <span> </span></div> <span> </span></div> <input type="range"/></div>');function Rt(u,e){ae(e,!0);let a=se(e,"value",15),n=se(e,"min",3,0),l=se(e,"step",3,1),c=se(e,"unit",3,""),v=se(e,"isHue",3,!1);function d(T){const L=parseFloat(T.target.value);a(L),e.onchange&&e.onchange(L)}var p=Jo(),x=i(p),b=i(x),h=i(b),g=i(h,!0);r(h);var y=o(h,2),w=i(y,!0);r(y),r(b);var m=o(b,2),k=i(m);r(m),r(x);var A=o(x,2);kt(A);let C;r(p),P(T=>{E(g,e.icon),E(w,e.label),E(k,`${T??""}${c()??""}`),z(A,"min",n()),z(A,"max",e.max),z(A,"step",l()),mr(A,a()),C=oe(A,1,"custom-slider svelte-d8mhf4",null,C,{"hue-slider":v()})},[()=>l()<1?a().toFixed(2):Math.round(a())]),te("input",A,d),f(u,p),re()}Ae(["input"]);var en=S('<span class="mt-1 font-serif text-[9px] font-black tracking-[0.2em] text-text-main/40 uppercase"> </span>'),tn=lt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="square" class="h-4 w-4 text-text-main/40"><path d="M18 6L6 18M6 6l12 12"></path></svg>'),an=S('<div class="flex shrink-0 items-center justify-end gap-3 border-t-2 border-ui-structural bg-grid-border/20 px-6 py-4"><!></div>'),rn=S('<div class="fixed inset-0 flex items-center justify-center bg-ui-structural/40 p-4 backdrop-blur-[2px] md:p-8"><div role="dialog" aria-modal="true" tabindex="-1"><div class="flex shrink-0 items-center justify-between border-b-2 border-ui-structural bg-sidebar-bg/30 px-6 py-5"><div class="flex flex-col"><h2 class="font-tiny5 text-2xl leading-none tracking-wider text-text-main"> </h2> <!></div> <!></div> <div class="custom-scrollbar flex-1 overflow-y-auto px-6 py-6"><!></div> <!></div></div>');function ct(u,e){ae(e,!0);let a=se(e,"title",3,""),n=se(e,"subtitle",3,""),l=se(e,"isOpen",3,!1),c=se(e,"width",3,"auto"),v=se(e,"maxWidth",3,"95vw"),d=se(e,"zIndex",3,1500),p=se(e,"class",3,"");He(()=>{if(l())return s.pushEscapeAction(e.onClose),()=>s.popEscapeAction(e.onClose)}),_t(()=>{l()&&rt.playCeramicSlide()}),He(()=>{l()&&rt.playCeramicSlide()});var x=Te(),b=ne(x);{var h=g=>{var y=rn(),w=i(y),m=i(w),k=i(m),A=i(k),C=i(A,!0);r(A);var T=o(A,2);{var L=J=>{var D=en(),G=i(D,!0);r(D),P(U=>E(G,U),[()=>n()?_(n()):""]),f(J,D)};O(T,J=>{n()&&J(L)})}r(k);var I=o(k,2);xe(I,{variant:"ghost",size:"sm",get onclick(){return e.onClose},ariaLabel:"ui:labels.close",children:(J,D)=>{var G=tn();f(J,G)},$$slots:{default:!0}}),r(m);var $=o(m,2),j=i($);{var R=J=>{var D=Te(),G=ne(D);Me(G,()=>e.children),f(J,D)};O(j,J=>{e.children&&J(R)})}r($);var F=o($,2);{var ee=J=>{var D=an(),G=i(D);Me(G,()=>e.footer),r(D),f(J,D)};O(F,J=>{e.footer&&J(ee)})}r(w),r(y),P(J=>{pe(y,`z-index: ${d()??""};`),oe(w,1,`
                flex max-h-[90vh] flex-col overflow-hidden rounded-sm border-2
                border-ui-structural bg-canvas-bg shadow-[8px_8px_0px_var(--color-ui-structural)]
                ${p()??""}
            `),pe(w,`width: ${c()??""}; max-width: ${v()??""};`),E(C,J)},[()=>a()?_(a()):""]),te("mousedown",y,J=>{J.stopPropagation(),J.target===J.currentTarget&&e.onClose()}),te("mousedown",w,J=>J.stopPropagation()),fe(3,w,()=>Lt,()=>({duration:300,easing:Ut,start:.9})),fe(3,y,()=>be,()=>({duration:150})),f(g,y)};O(b,g=>{l()&&g(h)})}f(u,x),re()}Ae(["mousedown"]);var sn=S('<span aria-hidden="true">üñåÔ∏è</span>'),on=S('<div class="flex flex-col gap-8" role="presentation"><div class="flex items-center justify-between px-2"><span class="text-3xl" aria-hidden="true">üè∫</span> <div class="editor-checker-small h-16 w-32 rounded-xl border-4 border-canvas-bg shadow-lg"></div></div> <div class="flex flex-col gap-6"><!> <!> <!> <!> <!></div> <div class="flex flex-col gap-4"><!> <div class="flex gap-3"><!> <!></div></div></div>');function sa(u,e){ae(e,!0);let a=se(e,"value",15),n=ce(0),l=ce(0),c=ce(0),v=ce(1),d=ce(0),p=ce(wt(a()));He(()=>{const g=vt.toHSLA(a());Mt(()=>{B(n,g.h,!0),B(l,g.s,!0),B(c,g.l,!0),B(v,g.a,!0),B(d,0),t(p)!==a()&&B(p,a(),!0)})}),He(()=>{const g=vt.toHex({h:t(n),s:t(l),l:t(c),a:t(v)});Mt(()=>{a(g),B(p,g,!0)})});function x(g){const w=g.target.value.toUpperCase();B(p,w,!0);const m=w.replace("#","");if(m.length===6||m.length===8){const k=vt.toHSLA(w);B(n,k.h,!0),B(l,k.s,!0),B(c,k.l,!0),B(v,k.a,!0),B(d,0)}}function b(g){const y=g-t(d),w=vt.toHex({h:t(n),s:t(l),l:t(c),a:t(v)}),m=vt.applyTemperature(w,y/100),k=vt.toHSLA(m);B(n,k.h,!0),B(l,k.s,!0),B(c,k.l,!0),B(d,g,!0)}He(()=>(s.pushEscapeAction(e.onClose),()=>s.popEscapeAction(e.onClose)));function h(g){g.key==="Enter"&&e.onClose()}ct(u,{title:"tools:color_picker.title",subtitle:"tools:color_picker.subtitle",isOpen:!0,get onClose(){return e.onClose},width:"450px",zIndex:2e3,children:(g,y)=>{var w=on(),m=i(w),k=o(i(m),2);r(m);var A=o(m,2),C=i(A);{let D=H(()=>_("tools:color_picker.label.hue"));Rt(C,{get label(){return t(D)},icon:"üåà",max:360,unit:"¬∞",isHue:!0,get value(){return t(n)},set value(G){B(n,G,!0)}})}var T=o(C,2);{let D=H(()=>_("tools:color_picker.label.saturation"));Rt(T,{get label(){return t(D)},icon:"üíß",max:100,unit:"%",get value(){return t(l)},set value(G){B(l,G,!0)}})}var L=o(T,2);{let D=H(()=>_("tools:color_picker.label.lightness"));Rt(L,{get label(){return t(D)},icon:"‚òÄÔ∏è",max:100,unit:"%",get value(){return t(c)},set value(G){B(c,G,!0)}})}var I=o(L,2);{let D=H(()=>_("tools:color_picker.label.temperature"));Rt(I,{get label(){return t(D)},icon:"üå°Ô∏è",get value(){return t(d)},onchange:b,min:-100,max:100,unit:""})}var $=o(I,2);{let D=H(()=>_("tools:color_picker.label.alpha"));Rt($,{get label(){return t(D)},icon:"üå¨Ô∏è",min:0,max:1,step:.01,unit:"",get value(){return t(v)},set value(G){B(v,G,!0)}})}r(A);var j=o(A,2),R=i(j);Ue(R,{label:"tools:color_picker.label.hex",get value(){return t(p)},oninput:x,ariaLabel:"tools:color_picker.label.hex",class:"font-mono text-lg uppercase"});var F=o(R,2),ee=i(F);xe(ee,{variant:"secondary",onclick:()=>{K.pickColor(),e.onClose()},ariaLabel:"tools:color_picker.button.eye_dropper",class:"!h-14 !w-14 text-xl",children:(D,G)=>{var U=sn();f(D,U)},$$slots:{default:!0}});var J=o(ee,2);xe(J,{variant:"primary",class:"flex-1 py-4",get onclick(){return e.onClose},ariaLabel:"ui:labels.confirm",children:(D,G)=>{ge();var U=ve();P(Z=>E(U,Z),[()=>_("ui:labels.confirm")]),f(D,U)},$$slots:{default:!0}}),r(F),r(j),r(w),P(D=>{pe(k,`background-color: ${a()??""};`),z(k,"aria-label",D)},[()=>_("ui:accessibility.color_preview")]),te("keydown",w,h),f(g,w)},$$slots:{default:!0}}),re()}Ae(["keydown"]);var nn=S("<span> </span>"),ln=S('<button><span class="font-serif text-sm font-bold tracking-tight"> </span> <!></button>');function cn(u,e){ae(e,!0);var a=ln(),n=i(a),l=i(n,!0);r(n);var c=o(n,2);{var v=d=>{var p=nn(),x=i(p,!0);r(p),P(()=>{oe(p,1,`font-mono text-[10px] font-bold uppercase ${e.isSelected?"text-white/60":"opacity-20"}`),E(x,e.action.shortcut)}),f(d,p)};O(c,d=>{e.action.shortcut&&d(v)})}r(a),P(d=>{oe(a,1,`editor-action-btn flex items-center justify-between rounded-xl px-6 py-4 transition-all ${e.isSelected?"active bg-ui-accent text-canvas-bg shadow-lg":"hover:bg-text-main/5"}`),E(l,d)},[()=>_(e.action.label)]),te("click",a,()=>{e.action.action(),e.onSelect()}),Oe("mouseenter",a,function(...d){e.onSelect?.apply(this,d)}),f(u,a),re()}Ae(["click"]);var dn=S('<div class="p-8 text-center font-serif text-sm text-text-main/40 italic"> </div>'),vn=S('<div class="flex flex-col gap-1"></div>'),un=S('<div class="fixed inset-0 z-[1200] flex items-start justify-center bg-ui-structural/10 pt-[15vh] backdrop-blur-sm" role="presentation"><div class="flex w-[600px] flex-col overflow-hidden rounded-xl border border-text-main/5 bg-canvas-bg/95 shadow-2xl" role="dialog" aria-labelledby="palette-title" aria-modal="true"><div class="relative flex items-center border-b border-text-main/5 bg-canvas-bg/40 p-4"><span class="mr-2 text-2xl opacity-40" aria-hidden="true">üìñ</span> <h2 id="palette-title" class="sr-only"> </h2> <!></div> <div class="custom-scrollbar max-h-[50vh] overflow-y-auto p-4 svelte-k2yexi" role="list"><!></div> <div class="flex items-center justify-between border-t border-text-main/5 bg-text-main/5 px-8 py-4"><span class="font-serif text-[9px] font-bold tracking-[0.2em] text-text-main/30 uppercase"> </span> <span class="font-serif text-[9px] font-bold tracking-[0.2em] text-text-main/30 uppercase"> </span></div></div></div>');function pn(u,e){ae(e,!0);let a=se(e,"onClose",3,()=>s.showCommandPalette=!1),n=ce(""),l=ce(0);const v=Ve.getActions().map(R=>({...R,id:R.intent.toLowerCase().replace(/_/g,"-"),action:()=>{Xe.handleIntent(R.intent)}}));let d=H(()=>v.filter(R=>R.label.toLowerCase().includes(t(n).toLowerCase())));He(()=>{t(n),B(l,0)}),He(()=>{t(l),t(d);const R=document.querySelector(".editor-action-btn.active");R&&R.scrollIntoView({block:"nearest"})});function p(R){R.key==="ArrowDown"?(R.preventDefault(),B(l,(t(l)+1)%t(d).length)):R.key==="ArrowUp"?(R.preventDefault(),B(l,(t(l)-1+t(d).length)%t(d).length)):R.key==="Enter"?(R.preventDefault(),t(d)[t(l)]&&(t(d)[t(l)].action(),a()())):R.key==="Escape"&&a()()}_t(()=>document.getElementById("palette-search")?.focus());var x=un(),b=i(x),h=i(b),g=o(i(h),2),y=i(g,!0);r(g);var w=o(g,2);Ue(w,{id:"palette-search",placeholder:"workspace:hud.menu.catalog_search",ariaLabel:"workspace:hud.menu.catalog_search",class:"flex-1 !border-none !bg-transparent text-xl !shadow-none",get value(){return t(n)},set value(R){B(n,R,!0)}}),r(h);var m=o(h,2),k=i(m);{var A=R=>{var F=dn(),ee=i(F,!0);r(F),P(J=>E(ee,J),[()=>_("workspace:hud.menu.catalog_no_results",{replace:{query:t(n)}})]),f(R,F)},C=R=>{var F=vn();_e(F,21,()=>t(d),Le,(ee,J,D)=>{{let G=H(()=>t(l)===D);cn(ee,{get action(){return t(J)},get isSelected(){return t(G)},onSelect:()=>B(l,D,!0)})}}),r(F),f(R,F)};O(k,R=>{t(d).length===0?R(A):R(C,!1)})}r(m);var T=o(m,2),L=i(T),I=i(L,!0);r(L);var $=o(L,2),j=i($,!0);r($),r(T),r(b),r(x),P((R,F,ee)=>{E(y,R),E(I,F),E(j,ee)},[()=>_("workspace:hud.menu.catalog_title"),()=>_("workspace:hud.menu.catalog_footer"),()=>_("workspace:hud.menu.catalog_count",{replace:{count:t(d).length}})]),te("mousedown",x,R=>R.target===R.currentTarget&&a()()),te("keydown",x,p),fe(3,b,()=>Lt,()=>({duration:150,start:.98})),f(u,x),re()}Ae(["mousedown","keydown"]);var fn=S('<div class="flex items-center justify-between px-1"><span class="text-[10px] font-bold tracking-widest text-text-main/70 uppercase"> </span> <span class="font-mono text-[10px] text-text-main/90"> </span></div>'),xn=S(`<div><!> <div class="
            h-3 w-full overflow-hidden rounded-sm border-2 border-ui-structural
            bg-grid-border shadow-[2px_2px_0px_var(--color-ui-structural)]
        "><div class="
                h-full border-r-2 border-ui-structural bg-ui-accent
                transition-all duration-300 ease-in-out
            "></div></div></div>`);function gn(u,e){let a=se(e,"value",3,0),n=se(e,"max",3,100),l=se(e,"class",3,"");const c=H(()=>Math.min(Math.max(a()/n()*100,0),100));var v=xn(),d=i(v);{var p=h=>{var g=fn(),y=i(g),w=i(y,!0);r(y);var m=o(y,2),k=i(m);r(m),r(g),P(A=>{E(w,e.label),E(k,`${A??""}%`)},[()=>Math.round(t(c))]),f(h,g)};O(d,h=>{e.label&&h(p)})}var x=o(d,2),b=i(x);r(x),r(v),P(()=>{oe(v,1,`flex w-full flex-col gap-1.5 ${l()??""}`),pe(b,`width: ${t(c)??""}%`)}),f(u,v)}var hn=S('<div class="text-2xl"><!></div>'),mn=S('<button type="button" role="radio"><!> <div class="text-center"><h3 class="font-serif text-[10px] font-bold tracking-tight uppercase"> </h3></div></button>');function va(u,e){ae(e,!0);let a=se(e,"disabled",3,!1),n=se(e,"class",3,"");var l=mn(),c=i(l);{var v=b=>{var h=hn(),g=i(h);{var y=m=>{var k=ve();P(()=>E(k,e.icon)),f(m,k)},w=m=>{var k=Te(),A=ne(k);Me(A,()=>e.icon),f(m,k)};O(g,m=>{typeof e.icon=="string"?m(y):m(w,!1)})}r(h),f(b,h)};O(c,b=>{e.icon&&b(v)})}var d=o(c,2),p=i(d),x=i(p,!0);r(p),r(d),r(l),P(b=>{z(l,"aria-checked",e.isSelected),l.disabled=a(),oe(l,1,`
        flex flex-col items-center gap-3 rounded-xl border-2 p-4 transition-all
        disabled:cursor-not-allowed disabled:opacity-20
        		${e.isSelected?"border-ui-accent bg-ui-accent/5 text-ui-accent":"border-text-main/5 bg-text-main/[0.05] text-text-main/40 hover:bg-text-main/10 hover:text-text-main/70 hover:opacity-100"}        ${n()??""}
    `),E(x,b)},[()=>_(e.label)]),te("click",l,()=>e.onclick(e.id)),f(u,l),re()}Ae(["click"]);var bn=S('<div class="flex flex-col items-center gap-3"><div class="editor-checker-small flex items-center justify-center overflow-hidden rounded-xl border-4 border-ui-structural bg-text-main/5 p-2 shadow-inner"><canvas class="rounded-sm shadow-sm"></canvas></div> <div class="flex flex-col items-center gap-1 text-center"><span class="font-tiny5 text-[10px] tracking-widest text-ui-accent uppercase"> </span> <span class="font-mono text-[8px] font-bold tracking-tighter opacity-30"> </span></div></div>');function _n(u,e){ae(e,!0);let a=ce(null);He(()=>{if(!t(a))return;const h=t(a).getContext("2d");if(!h)return;const g=s.canvas.width,y=s.canvas.height,w=s.canvas.compositePixels,m=s.studio.includePixelBorders,k=400,A=Math.min(k/g,k/y);t(a).width=g*A,t(a).height=y*A,h.imageSmoothingEnabled=!1,e.bgColor==="transparent"?h.clearRect(0,0,t(a).width,t(a).height):(h.fillStyle=e.bgColor,h.fillRect(0,0,t(a).width,t(a).height)),w.forEach((C,T)=>{if(C===0)return;const L=vt.uint32ToHex(C),I=T%g,$=Math.floor(T/g),j=Math.floor(I*A),R=Math.floor($*A),F=Math.ceil(A),ee=Math.ceil(A);h.fillStyle=L,h.fillRect(j,R,F,ee),m&&(h.strokeStyle="rgba(0, 0, 0, 0.15)",h.lineWidth=1,h.strokeRect(j+.5,R+.5,F-1,ee-1))})});var n=bn(),l=i(n),c=i(l);gt(c,h=>B(a,h),()=>t(a)),r(l);var v=o(l,2),d=i(v),p=i(d,!0);r(d);var x=o(d,2),b=i(x,!0);r(x),r(v),r(n),P((h,g)=>{E(p,h),E(b,g)},[()=>_("export:file_label",{replace:{format:e.format}}),()=>_("export:dimensions_label",{replace:{width:Math.round(s.canvas.width*e.scale),height:Math.round(s.canvas.height*e.scale)}})]),f(u,n),re()}var An=S('<button role="radio"><span class="font-serif text-[9px] font-bold tracking-tight uppercase"> <!></span></button>'),yn=S('<div class="flex flex-col gap-3"><div role="radiogroup"></div> <div><div class="flex flex-col gap-1"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/60 uppercase"> </span> <span class="font-serif text-[9px] text-text-main/40"> </span></div> <div class="grid grid-cols-2 gap-2" role="radiogroup"></div></div></div>'),wn=S('<div class="rounded-xl border border-ui-accent/20 bg-ui-accent/5 p-4 text-center"><span class="font-serif text-xs font-bold text-ui-accent italic"> </span></div>'),kn=S('<div class="flex flex-col gap-3"><!> <div role="radiogroup"></div> <!></div>'),En=S('<span aria-hidden="true">üé®</span> ',1),Ln=S('<span class="animate-spin text-2xl">‚è≥</span> <span> </span>',1),Sn=S("<span> </span>"),Cn=S('<div class="flex h-[75vh] flex-col items-start gap-12 overflow-hidden lg:flex-row"><div class="custom-scrollbar flex w-full shrink-0 flex-col gap-4 overflow-y-auto lg:h-full lg:w-[420px]"><div class="flex aspect-square w-full items-center justify-center rounded-2xl bg-text-main/5 p-6 ring-1 ring-text-main/5" role="img"><!></div> <div class="hidden flex-1 flex-col justify-end gap-2 lg:flex"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/40 uppercase"> </span> <p class="font-serif text-[9px] leading-relaxed text-text-main/30 italic"> </p></div></div> <div class="custom-scrollbar flex h-full flex-1 flex-col gap-6 overflow-y-auto pr-4"><!> <!> <div><!> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <div class="flex items-center justify-between"><div class="flex flex-col gap-1"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/60 uppercase"> </span> <span class="font-serif text-[9px] text-text-main/40"> </span></div> <!></div> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <div class="flex flex-col gap-4"><div class="flex flex-col gap-1"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/60 uppercase"> </span> <span class="font-serif text-[9px] text-text-main/40"> </span></div> <div class="flex flex-wrap items-center gap-3" role="radiogroup"><button style="background: repeating-conic-gradient(#dad7cd 0% 25%, #fff 0% 50%) 50% / 10px 10px;" role="radio"></button> <button role="radio"></button> <button role="radio"></button> <div class="flex items-center gap-2"><button role="radio"></button></div></div> <!></div></div> <div class="flex flex-col gap-3"><!> <!></div></div></div>'),Tn=S("<!> <!>",1);function In(u,e){ae(e,!0);let a=se(e,"onClose",3,()=>s.showExportMenu=!1),n=ce("image"),l=ce("png"),c=ce(!1),v=ce(!1),d=ce(!1),p=ce(wt(s.backgroundColor)),x=H(()=>s.project.frames.length>1);function b(L){t(d)||(B(n,L,!0),L==="image"?B(l,"png"):t(x)?B(l,"gif"):(B(n,"image"),B(l,"png")))}function h(){if(t(d)){s.studio.show(_("ui:studio.wait_brewing"));return}a()()}async function g(){if(t(d))return;if((["webm","gif","mp4"].includes(t(l))||t(l)==="svg"&&t(n)==="video")&&!t(x)){s.studio.show(_("export:status.requires_frames"));return}B(d,!0);try{await e.onExport(t(l),s.studio.exportScale,s.studio.exportBgColor)}finally{B(d,!1)}}_t(()=>{s.backgroundColor!=="#fdf6e3"&&(s.studio.exportBgColor=s.backgroundColor,B(p,s.backgroundColor,!0),B(v,!0))}),He(()=>{t(v)&&(s.studio.exportBgColor=t(p))});const y=H(()=>[{id:"image",label:"export:tabs.image"},{id:"video",label:"export:tabs.video",disabled:!t(x)}]),w=[{id:"png",label:"export:format.png",icon:"üñºÔ∏è"},{id:"webp",label:"export:format.webp",icon:"üï∏Ô∏è"},{id:"jpg",label:"export:format.jpg",icon:"üì∑"},{id:"svg",label:"export:format.svg_static",icon:"üìê"}],m=[{id:"gif",label:"export:format.gif",icon:"üéÄ"},{id:"webm",label:"export:format.webm",icon:"üé¨"},{id:"mp4",label:"export:format.mp4",icon:"üìΩÔ∏è"},{id:"svg",label:"export:format.svg_kinetic",icon:"üìê"}];var k=Tn(),A=ne(k);{var C=L=>{sa(L,{onClose:()=>B(c,!1),get value(){return t(p)},set value(I){B(p,I,!0)}})};O(A,L=>{t(c)&&L(C)})}var T=o(A,2);ct(T,{title:"export:title",subtitle:"export:subtitle",isOpen:!0,onClose:h,width:"1000px",children:(L,I)=>{var $=Cn(),j=i($),R=i(j),F=i(R);_n(F,{get format(){return t(l)},get scale(){return s.studio.exportScale},get bgColor(){return s.studio.exportBgColor}}),r(R);var ee=o(R,2),J=i(ee),D=i(J,!0);r(J);var G=o(J,2),U=i(G);r(G),r(ee),r(j);var Z=o(j,2),de=i(Z);{let ke=H(()=>t(d)?"pointer-events-none opacity-50":"");ka(de,{get tabs(){return t(y)},ariaLabel:"export:settings_label",onchange:b,get class(){return t(ke)},get activeTab(){return t(n)},set activeTab(De){B(n,De,!0)}})}var V=o(de,2);{var N=ke=>{var De=yn(),qe=i(De);_e(qe,21,()=>w,Le,(Re,Pe)=>{{let Pt=H(()=>t(l)===t(Pe).id);va(Re,{get id(){return t(Pe).id},get label(){return t(Pe).label},get icon(){return t(Pe).icon},get isSelected(){return t(Pt)},onclick:dt=>B(l,dt,!0),get disabled(){return t(d)}})}}),r(qe);var Ye=o(qe,2),Be=i(Ye),We=i(Be),Ke=i(We,!0);r(We);var Ee=o(We,2),ze=i(Ee,!0);r(Ee),r(Be);var $e=o(Be,2);_e($e,20,()=>["ACTIVE","VISIBLE","SELECTED","ALL","SELECTED_LAYERS"],Le,(Re,Pe)=>{const Pt=H(()=>Pe==="ACTIVE"?1:Pe==="VISIBLE"?s.project.frames.filter(pt=>pt.isVisible).length:Pe==="SELECTED"?s.project.selectedFrameIndices.size:Pe==="SELECTED_LAYERS"?s.project.activeFrame.selectedLayerIndices.size:s.project.frames.length);var dt=An(),Ft=i(dt),Nt=i(Ft),qt=o(Nt);{var Wt=pt=>{var Bt=ve();P(()=>E(Bt,`(${t(Pt)??""})`)),f(pt,Bt)};O(qt,pt=>{Pe!=="ACTIVE"&&pt(Wt)})}r(Ft),r(dt),P(pt=>{oe(dt,1,`rounded-lg border px-2 py-2 text-center transition-all ${s.studio.exportFrameSelection===Pe?"border-ui-accent bg-white text-ui-accent shadow-sm":"border-transparent bg-white/20 text-text-main/50 hover:bg-white/40"}`),z(dt,"aria-checked",s.studio.exportFrameSelection===Pe),E(Nt,`${pt??""} `)},[()=>_(`export:selection.${Pe.toLowerCase()}`)]),te("click",dt,()=>s.studio.exportFrameSelection=Pe),f(Re,dt)}),r($e),r(Ye),r(De),P((Re,Pe)=>{oe(qe,1,`grid grid-cols-2 gap-3 ${t(d)?"pointer-events-none opacity-50":""}`),oe(Ye,1,`mt-2 flex flex-col gap-4 rounded-xl border border-text-main/5 bg-text-main/5 p-4 ${t(d)?"pointer-events-none opacity-50":""}`),E(Ke,Re),E(ze,Pe)},[()=>_("export:label.selection"),()=>_("export:description.selection")]),fe(3,De,()=>be,()=>({duration:150})),f(ke,De)},W=ke=>{var De=kn(),qe=i(De);{var Ye=Ke=>{var Ee=wn(),ze=i(Ee),$e=i(ze,!0);r(ze),r(Ee),P(Re=>E($e,Re),[()=>_("export:status.requires_frames")]),f(Ke,Ee)};O(qe,Ke=>{t(x)||Ke(Ye)})}var Be=o(qe,2);_e(Be,21,()=>m,Le,(Ke,Ee)=>{{let ze=H(()=>t(l)===t(Ee).id),$e=H(()=>!t(x)||t(d));va(Ke,{get id(){return t(Ee).id},get label(){return t(Ee).label},get icon(){return t(Ee).icon},get isSelected(){return t(ze)},onclick:Re=>B(l,Re,!0),get disabled(){return t($e)}})}}),r(Be);var We=o(Be,2);{let Ke=H(()=>t(d)?"pointer-events-none opacity-50":"");Ue(We,{label:"export:label.fps",type:"number",min:1,max:60,ariaLabel:"export:label.fps",get class(){return t(Ke)},get value(){return s.project.fps},set value(Ee){s.project.fps=Ee}})}r(De),P(()=>oe(Be,1,`grid grid-cols-2 gap-3 ${!t(x)||t(d)?"pointer-events-none opacity-40":""}`)),fe(3,De,()=>be,()=>({duration:150})),f(ke,De)};O(V,ke=>{t(n)==="image"?ke(N):ke(W,!1)})}var M=o(V,2),X=i(M);Ue(X,{label:"export:label.scale",type:"number",min:1,max:100,ariaLabel:"export:label.scale",get value(){return s.studio.exportScale},set value(ke){s.studio.exportScale=ke}});var Y=o(X,4),ie=i(Y),q=i(ie),le=i(q,!0);r(q);var ye=o(q,2),Se=i(ye,!0);r(ye),r(ie);var Q=o(ie,2);Kt(Q,{ariaLabel:"export:label.borders",get checked(){return s.studio.includePixelBorders},set checked(ke){s.studio.includePixelBorders=ke}}),r(Y);var Ce=o(Y,4),we=i(Ce),me=i(we),Ie=i(me,!0);r(me);var Ne=o(me,2),et=i(Ne,!0);r(Ne),r(we);var it=o(we,2),st=i(it),Qe=o(st,2),ut=o(Qe,2),St=o(ut,2),ht=i(St);r(St),r(it);var Ct=o(it,2);{var Qt=ke=>{xe(ke,{variant:"ghost",size:"sm",onclick:()=>{B(p,s.backgroundColor,!0),s.studio.exportBgColor=t(p)},ariaLabel:"export:background.match_canvas",class:"flex items-center gap-2 !p-0 text-ui-accent opacity-60 hover:opacity-100",children:(De,qe)=>{var Ye=En(),Be=o(ne(Ye));P(We=>E(Be,` ${We??""}`),[()=>_("export:background.match_canvas")]),f(De,Ye)},$$slots:{default:!0}})};O(Ct,ke=>{s.backgroundColor!=="#fdf6e3"&&ke(Qt)})}r(Ce),r(M);var Tt=o(M,2),Dt=i(Tt);{var zt=ke=>{gn(ke,{label:"export:status.progress",get value(){return s.studio.exportProgress},class:"mb-2"})};O(Dt,ke=>{t(d)&&ke(zt)})}var It=o(Dt,2);{let ke=H(()=>t(d)||t(n)==="video"&&!t(x));xe(It,{variant:"primary",class:"w-full py-5 text-xl",onclick:g,get disabled(){return t(ke)},ariaLabel:"export:button.submit",children:(De,qe)=>{var Ye=Te(),Be=ne(Ye);{var We=Ee=>{var ze=Ln(),$e=o(ne(ze),2),Re=i($e,!0);r($e),P(Pe=>E(Re,Pe),[()=>_("export:status.brewing")]),f(Ee,ze)},Ke=Ee=>{var ze=Sn(),$e=i(ze,!0);r(ze),P(Re=>E($e,Re),[()=>_("export:button.submit")]),f(Ee,ze)};O(Be,Ee=>{t(d)?Ee(We):Ee(Ke,!1)})}f(De,Ye)},$$slots:{default:!0}})}r(Tt),r(Z),r($),P((ke,De,qe,Ye,Be,We,Ke,Ee,ze,$e,Re,Pe)=>{z(R,"aria-label",ke),E(D,De),E(U,`${qe??""} & ${Ye??""}`),oe(M,1,`flex flex-col gap-5 rounded-xl border border-text-main/5 bg-text-main/[0.05] p-6 ${t(d)?"pointer-events-none opacity-50":""}`),E(le,Be),E(Se,We),E(Ie,Ke),E(et,Ee),oe(st,1,`h-10 w-10 rounded-xl border-2 ${s.studio.exportBgColor==="transparent"?"border-ui-accent":"border-text-main/5"}`),z(st,"title",ze),z(st,"aria-checked",s.studio.exportBgColor==="transparent"),oe(Qe,1,`h-10 w-10 rounded-xl border-2 ${s.studio.exportBgColor==="#fdf6e3"?"border-ui-accent":"border-text-main/5"} bg-[#fdf6e3]`),z(Qe,"title",$e),z(Qe,"aria-checked",s.studio.exportBgColor==="#fdf6e3"),oe(ut,1,`h-10 w-10 rounded-xl border-2 ${s.studio.exportBgColor==="#333d29"?"border-ui-accent":"border-text-main/5"} bg-[#333d29]`),z(ut,"title",Re),z(ut,"aria-checked",s.studio.exportBgColor==="#333d29"),oe(ht,1,`h-10 w-16 rounded-xl border-2 ${t(v)?"border-ui-accent":"border-text-main/5"} editor-checker-small transition-transform hover:scale-105`),pe(ht,`background-color: ${t(p)??""};`),z(ht,"title",Pe),z(ht,"aria-checked",t(v))},[()=>_("export:preview_label"),()=>_("export:preview_label"),()=>_("export:description.scale"),()=>_("export:description.background"),()=>_("export:label.borders"),()=>_("export:description.borders"),()=>_("export:label.background"),()=>_("export:description.background"),()=>_("export:background.transparent"),()=>_("export:background.cream"),()=>_("export:background.black"),()=>_("export:background.custom")]),te("click",st,()=>{s.studio.exportBgColor="transparent",B(v,!1)}),te("click",Qe,()=>{s.studio.exportBgColor="#fdf6e3",B(v,!1)}),te("click",ut,()=>{s.studio.exportBgColor="#333d29",B(v,!1)}),te("click",ht,()=>{B(v,!0),s.studio.exportBgColor=t(p),B(c,!0)}),f(L,$)},$$slots:{default:!0}}),f(u,k),re()}Ae(["click"]);var Pn=S('<span class="text-lg opacity-40">‚úï</span>'),jn=S('<div class="bg-hud-shadow/20 fixed inset-0 z-[1000] backdrop-blur-[1px]"></div> <div role="dialog" aria-modal="true"><div class="flex items-center justify-between border-b border-ui-structural/10 px-6 py-4"><h2 class="font-tiny5 text-xl tracking-wider text-text-main uppercase"> </h2> <!></div> <div class="custom-scrollbar flex-1 overflow-y-auto p-6"><!></div></div>',1);function La(u,e){ae(e,!0);let a=se(e,"title",3,""),n=se(e,"isOpen",3,!1),l=se(e,"width",3,"320px"),c=se(e,"class",3,"");He(()=>{if(n())return s.pushEscapeAction(e.onClose),()=>s.popEscapeAction(e.onClose)}),He(()=>{n()&&rt.playPaperFlip()});var v=Te(),d=ne(v);{var p=x=>{var b=jn(),h=ne(b),g=o(h,2),y=i(g),w=i(y),m=i(w,!0);r(w);var k=o(w,2);xe(k,{variant:"ghost",size:"sm",get onclick(){return e.onClose},ariaLabel:"ui:labels.close",children:(L,I)=>{var $=Pn();f(L,$)},$$slots:{default:!0}}),r(y);var A=o(y,2),C=i(A);{var T=L=>{var I=Te(),$=ne(I);Me($,()=>e.children),f(L,I)};O(C,L=>{e.children&&L(T)})}r(A),r(g),P((L,I)=>{oe(g,1,`
            fixed top-0 right-0 z-[1001] flex
            h-full flex-col border-l-2 border-ui-structural
            bg-canvas-bg shadow-[-8px_0px_0px_rgba(0,0,0,0.05)]
            ${c()??""}
        `),pe(g,`width: ${l()??""};`),z(g,"aria-label",L),E(m,I)},[()=>a()||_("ui:accessibility.drawer"),()=>a()?_(a()):""]),te("click",h,function(...L){e.onClose?.apply(this,L)}),fe(3,h,()=>be,()=>({duration:200})),fe(3,g,()=>Yt,()=>({x:400,duration:400,easing:Ut})),f(x,b)};O(d,x=>{n()&&x(p)})}f(u,v),re()}Ae(["click"]);var $n=S('<div class="flex items-center justify-between"><span class="font-serif text-sm text-text-main/80"> </span> <kbd class="rounded border border-ui-structural/20 bg-canvas-bg px-2 py-1 font-mono text-[10px] font-bold text-ui-structural shadow-sm ring-1 ring-ui-structural/10"> </kbd></div>');function Rn(u,e){ae(e,!0);var a=$n(),n=i(a),l=i(n,!0);r(n);var c=o(n,2),v=i(c,!0);r(c),r(a),P((d,p)=>{E(l,d),E(v,p)},[()=>_(e.label),()=>e.customKey||Ve.getLabel(e.intent)]),f(u,a),re()}var Mn=S('<div class="flex flex-col gap-4"><h3 class="border-b border-text-main/10 pb-2 font-serif text-sm font-bold tracking-[0.2em] text-text-main/60 uppercase"> </h3> <div class="grid grid-cols-2 gap-x-12 gap-y-4"></div></div>');function On(u,e){ae(e,!0);var a=Mn(),n=i(a),l=i(n,!0);r(n);var c=o(n,2);_e(c,21,()=>e.group.items,Le,(v,d)=>{Rn(v,{get intent(){return t(d).intent},get label(){return t(d).label},get customKey(){return t(d).customKey}})}),r(c),r(a),P(v=>E(l,v),[()=>_(e.group.group)]),f(u,a),re()}var Dn=S('<div class="flex flex-col"><span class="font-tiny5 text-[10px] text-ui-accent uppercase"> </span> <span class="font-serif text-[10px] text-text-main/40 italic"> </span></div>'),zn=S('<button class="absolute top-1/2 right-5 -translate-y-1/2 text-text-main/30 hover:text-text-main/60">‚úï</button>'),Fn=S('<div class="pointer-events-none absolute top-1/2 right-6 -translate-y-1/2 text-text-main/20">üîç</div>'),Nn=S('<div class="grid grid-cols-2 gap-x-16 gap-y-12 px-2"></div>'),Bn=S('<div class="flex flex-col items-center justify-center gap-4 py-20"><span class="text-4xl">üçµ</span> <p class="font-serif text-sm text-text-main/40 italic"> </p></div>'),Gn=S('<div class="flex flex-col gap-10"><header class="flex flex-col gap-2 rounded-xl bg-ui-structural/5 p-6 ring-1 ring-ui-structural/10" aria-labelledby="guide-header-title"><div class="flex flex-col gap-1"><h3 id="guide-header-title" class="font-tiny5 text-xl text-text-main uppercase"> </h3> <p class="font-serif text-[10px] leading-relaxed text-text-main/60"> </p></div> <div class="mt-4 grid grid-cols-3 gap-4 border-t border-text-main/5 pt-4"></div></header> <section class="flex flex-col gap-4"><div class="relative"><input type="text" class="w-full rounded-xl border border-text-main/10 bg-canvas-bg px-6 py-4 font-serif text-sm text-text-main transition-all outline-none focus:border-ui-accent focus:ring-4 focus:ring-ui-accent/10"/> <!></div></section> <!> <footer class="mt-4 border-t border-text-main/5 pt-8 text-center"><p class="font-serif text-[11px] text-text-main/40 italic"> </p></footer></div>');function Hn(u,e){ae(e,!0);let a=se(e,"onClose",3,()=>s.showShortcuts=!1),n=ce(""),l=ce(null);He(()=>{t(l)&&t(l).focus()});const c=H(()=>{const v=Ve.getGroupedActions();if(!t(n))return v;const d=t(n).toLowerCase();return v.map(p=>{const x=p.items.filter(b=>{const h=_(b.label).toLowerCase(),g=b.shortcut?.toLowerCase()||"";return h.includes(d)||g.includes(d)});return{...p,items:x}}).filter(p=>p.items.length>0)});La(u,{title:"shortcuts:title",isOpen:!0,get onClose(){return a()},width:"1000px",children:(v,d)=>{var p=Gn(),x=i(p),b=i(x),h=i(b),g=i(h,!0);r(h);var y=o(h,2),w=i(y,!0);r(y),r(b);var m=o(b,2);_e(m,20,()=>[["Frame","Frame"],["Layer","Layer"],["Color","Color"],["Tool","Tool"],["Paint","Paint"],["Delete","Delete"]],Le,(D,G)=>{var U=H(()=>ar(G,2));let Z=()=>t(U)[0],de=()=>t(U)[1];var V=Dn(),N=i(V),W=i(N,!0);r(N);var M=o(N,2),X=i(M,!0);r(M),r(V),P(Y=>{E(W,Z()),E(X,Y)},[()=>_("shortcuts:glossary_meaning",{replace:{tech:de()}})]),f(D,V)}),r(m),r(x);var k=o(x,2),A=i(k),C=i(A);kt(C),gt(C,D=>B(l,D),()=>t(l));var T=o(C,2);{var L=D=>{var G=zn();te("click",G,()=>B(n,"")),f(D,G)},I=D=>{var G=Fn();f(D,G)};O(T,D=>{t(n)?D(L):D(I,!1)})}r(A),r(k);var $=o(k,2);{var j=D=>{var G=Nn();_e(G,21,()=>t(c),Le,(U,Z)=>{On(U,{get group(){return t(Z)}})}),r(G),f(D,G)},R=D=>{var G=Bn(),U=o(i(G),2),Z=i(U,!0);r(U),r(G),P(de=>E(Z,de),[()=>_("shortcuts:no_results",{replace:{query:t(n)}})]),f(D,G)};O($,D=>{t(c).length>0?D(j):D(R,!1)})}var F=o($,2),ee=i(F),J=i(ee);r(ee),r(F),r(p),P((D,G,U,Z)=>{E(g,D),E(w,G),z(C,"placeholder",U),E(J,`"${Z??""}"`)},[()=>_("shortcuts:header_title"),()=>_("shortcuts:header_desc"),()=>_("shortcuts:search_placeholder"),()=>_("shortcuts:footer_quote")]),Ot(C,()=>t(n),D=>B(n,D)),f(v,p)},$$slots:{default:!0}}),re()}Ae(["click"]);var Un=S('<div class="flex flex-col gap-6"><div class="rounded-xl border border-text-main/5 bg-text-main/[0.05] p-6"><h3 class="mb-2 font-serif text-sm font-bold tracking-tight text-text-main/60 uppercase">Project File (.rupa)</h3> <p class="truncate font-serif text-sm leading-relaxed text-text-main/50"> </p></div> <div class="flex flex-col gap-3"><!> <!></div></div>');function Vn(u,e){ae(e,!0);let a=se(e,"onClose",3,()=>s.showPersistenceMenu=!1);ct(u,{title:"actions:save",subtitle:"workspace:project.saved",isOpen:!0,get onClose(){return a()},width:"400px",children:(n,l)=>{var c=Un(),v=i(c),d=o(i(v),2),p=i(d,!0);r(d),r(v);var x=o(v,2),b=i(x);xe(b,{variant:"primary",class:"w-full py-4",onclick:()=>{K.persistence.save(),a()()},ariaLabel:"actions:save",children:(g,y)=>{ge();var w=ve();P(m=>E(w,m),[()=>_("actions:save")]),f(g,w)},$$slots:{default:!0}});var h=o(b,2);xe(h,{variant:"secondary",class:"w-full py-4",onclick:()=>{K.persistence.load(),a()()},ariaLabel:"actions:open",children:(g,y)=>{ge();var w=ve();P(m=>E(w,m),[()=>_("actions:open")]),f(g,w)},$$slots:{default:!0}}),r(x),r(c),P(g=>E(p,g),[()=>s.project.currentFilePath?s.project.currentFilePath.split(/[\\/]/).pop():_("workspace:project.unsaved")]),f(n,c)},$$slots:{default:!0}}),re()}var Yn=S('<div class="flex flex-col gap-8"><div class="flex flex-col gap-6 rounded-xl border border-text-main/5 bg-text-main/[0.05] p-8"><div class="relative flex items-end gap-4"><div class="flex-1"><!></div> <button title="Lock Aspect Ratio"><span class="text-xs"> </span></button> <div class="flex-1"><!></div></div> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <!> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <!> <div class="h-px w-full bg-text-main/5" aria-hidden="true"></div> <div class="flex items-center justify-between"><div class="flex flex-col gap-1"><span class="font-serif text-sm font-bold tracking-tight text-text-main/60 uppercase"> </span> <span class="font-serif text-[10px] text-text-main/40"> </span></div> <div class="flex items-center gap-3"><div class="flex items-center gap-1.5 rounded-lg border border-text-main/5 bg-text-main/[0.03] p-1"><button class="h-6 w-6 rounded-md border border-text-main/10 shadow-sm transition-transform hover:scale-110 active:scale-95" style="background-color: #fdf6e3;" title="Canvas Cream (Washi White)" aria-label="Set background to Canvas Cream"></button> <button class="h-6 w-6 rounded-md border border-text-main/10 shadow-sm transition-transform hover:scale-110 active:scale-95" style="background-color: #121412;" title="Canvas Dark (Night Washi)" aria-label="Set background to Canvas Dark"></button></div> <button class="group relative flex items-center gap-3"><div class="editor-checker-small h-10 w-16 rounded-xl border-2 border-canvas-bg shadow-sm transition-transform group-hover:scale-105"></div> <div class="absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-ui-accent text-[8px] text-white opacity-0 transition-opacity group-hover:opacity-100">üé®</div></button></div></div> <p class="font-serif text-[10px] leading-relaxed text-text-main/40 italic"> </p></div> <!></div>'),Kn=S("<!> <!>",1);function Qn(u,e){ae(e,!0);let a=se(e,"onClose",3,()=>s.showSettings=!1),n=ce(wt(s.canvas.width.toString())),l=ce(wt(s.canvas.height.toString())),c=ce(!1),v=s.canvas.width/s.canvas.height,d=ce(!1);function p(C){try{const T=C.replace(/[^0-9+\-*/.]/g,""),L=new Function(`return ${T}`)();return isNaN(L)?0:Math.round(L)}catch{return parseInt(C)||0}}function x(){const C=p(t(n));if(t(c)&&C>0){const T=Math.round(C/v);B(l,T.toString(),!0)}}function b(){const C=p(t(l));if(t(c)&&C>0){const T=Math.round(C*v);B(n,T.toString(),!0)}}function h(){B(c,!t(c)),t(c)&&(v=p(t(n))/p(t(l))||1)}function g(){const C=Math.max(1,p(t(n))),T=Math.max(1,p(t(l)));K.manipulation.resize(C,T),a()()}function y(C){C.key==="Enter"&&(C.preventDefault(),g())}var w=Kn(),m=ne(w);ct(m,{title:"workspace:settings.title",subtitle:"workspace:settings.subtitle",isOpen:!0,get onClose(){return a()},width:"450px",children:(C,T)=>{var L=Yn(),I=i(L),$=i(I),j=i($),R=i(j);Ue(R,{label:"workspace:settings.width",type:"text",oninput:x,ariaLabel:"workspace:settings.width",get value(){return t(n)},set value(me){B(n,me,!0)}}),r(j);var F=o(j,2),ee=i(F),J=i(ee,!0);r(ee),r(F);var D=o(F,2),G=i(D);Ue(G,{label:"workspace:settings.height",type:"text",oninput:b,ariaLabel:"workspace:settings.height",get value(){return t(l)},set value(me){B(l,me,!0)}}),r(D),r($);var U=o($,4);nt(U,{label:"workspace:settings.stabilization",min:0,max:100,ariaLabel:"workspace:settings.stabilization",get value(){return s.studio.stabilization},set value(me){s.studio.stabilization=me}});var Z=o(U,4);Ue(Z,{label:"workspace:settings.fps_label",type:"number",min:1,max:60,ariaLabel:"workspace:settings.fps_label",class:"w-24",get value(){return s.project.fps},set value(me){s.project.fps=me}});var de=o(Z,4),V=i(de),N=i(V),W=i(N,!0);r(N);var M=o(N,2),X=i(M,!0);r(M),r(V);var Y=o(V,2),ie=i(Y),q=i(ie),le=o(q,2);r(ie);var ye=o(ie,2),Se=i(ye);ge(2),r(ye),r(Y),r(de);var Q=o(de,2),Ce=i(Q,!0);r(Q),r(I);var we=o(I,2);xe(we,{variant:"primary",class:"w-full py-4 text-lg",onclick:g,ariaLabel:"workspace:settings.apply",children:(me,Ie)=>{ge();var Ne=ve();P(et=>E(Ne,et),[()=>_("workspace:settings.apply")]),f(me,Ne)},$$slots:{default:!0}}),r(L),P((me,Ie,Ne,et)=>{oe(F,1,`mb-2 flex h-10 w-10 items-center justify-center rounded-lg border transition-all ${t(c)?"border-ui-accent bg-ui-accent/10 text-ui-accent shadow-inner":"border-text-main/10 bg-canvas-bg text-text-main/30 hover:text-text-main/60"}`),E(J,t(c)?"üîí":"üîì"),E(W,me),E(X,Ie),z(ye,"aria-label",Ne),pe(Se,`background-color: ${s.backgroundColor??""};`),E(Ce,et)},[()=>_("workspace:settings.background_label"),()=>_("workspace:settings.background_desc"),()=>_("actions:pick_color"),()=>_("workspace:settings.note")]),te("keydown",L,y),te("click",F,h),te("click",q,()=>s.backgroundColor="#fdf6e3"),te("click",le,()=>s.backgroundColor="#121412"),te("click",ye,()=>B(d,!0)),f(C,L)},$$slots:{default:!0}});var k=o(m,2);{var A=C=>{sa(C,{onClose:()=>B(d,!1),get value(){return s.backgroundColor},set value(T){s.backgroundColor=T}})};O(k,C=>{t(d)&&C(A)})}f(u,w),re()}Ae(["keydown","click"]);var qn=S('<div class="h-3 w-3 rounded-sm shadow-inner"></div>'),Wn=S('<span class="font-mono text-[8px] opacity-20"> </span>'),Xn=S('<div class="group flex items-center justify-between rounded-xl border border-text-main/5 bg-text-main/[0.05] p-4 transition-all hover:bg-ui-highlight/10"><div class="flex flex-col gap-2 overflow-hidden"><div class="flex items-center gap-3"><span class="font-serif text-sm font-bold text-text-main"> </span> <!></div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex items-center gap-2 opacity-0 transition-opacity group-hover:opacity-100"><!> <!> <!></div></div>');function Zn(u,e){ae(e,!0);function a(T){return T.replace(/_/g," ").toLowerCase().split(" ").map(L=>L.charAt(0).toUpperCase()+L.slice(1)).join(" ")}var n=Xn(),l=i(n),c=i(l),v=i(c),d=i(v,!0);r(v);var p=o(v,2);{var x=T=>{Fe(T,{variant:"secondary",size:"sm",children:(L,I)=>{ge();var $=ve();P(j=>E($,j),[()=>_("ui:labels.default")]),f(L,$)},$$slots:{default:!0}})};O(p,T=>{e.preset.isDefault&&T(x)})}r(c);var b=o(c,2),h=i(b);_e(h,17,()=>e.preset.colors.slice(0,12),Le,(T,L)=>{var I=qn();P(()=>pe(I,`background-color: ${t(L)??""};`)),f(T,I)});var g=o(h,2);{var y=T=>{var L=Wn(),I=i(L);r(L),P(()=>E(I,`+${e.preset.colors.length-12}`)),f(T,L)};O(g,T=>{e.preset.colors.length>12&&T(y)})}r(b),r(l);var w=o(l,2),m=i(w);xe(m,{variant:"primary",size:"sm",onclick:()=>e.onApply(e.preset.id),ariaLabel:"tools:palette_library.button.apply",children:(T,L)=>{ge();var I=ve();P($=>E(I,$),[()=>_("tools:palette_library.button.apply")]),f(T,I)},$$slots:{default:!0}});var k=o(m,2);xe(k,{variant:"secondary",size:"sm",onclick:()=>e.onExport(e.preset.id),ariaLabel:"export:button.export_recipe",class:"h-8 w-8 !p-0",children:(T,L)=>{ge();var I=ve("üì•");f(T,I)},$$slots:{default:!0}});var A=o(k,2);{var C=T=>{xe(T,{variant:"danger",size:"sm",onclick:()=>e.onDelete(e.preset.id),ariaLabel:"tools:palette_library.button.delete",class:"h-8 w-8 !p-0",children:(L,I)=>{ge();var $=ve("üóëÔ∏è");f(L,$)},$$slots:{default:!0}})};O(A,T=>{e.preset.isDefault||T(C)})}r(w),r(n),P(T=>E(d,T),[()=>a(e.preset.name)]),fe(3,n,()=>wa,()=>({duration:200})),f(u,n),re()}var Jn=S('<div class="flex flex-col gap-8"><div class="flex items-center gap-3"><button class="flex flex-1 items-center justify-center gap-2 rounded-xl border-2 border-dashed border-text-main/10 bg-text-main/[0.05] py-4 transition-all hover:border-ui-accent/40 hover:bg-ui-highlight/20"><span class="text-lg">üè∫</span> <div class="flex flex-col items-start"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/60 uppercase"> </span> <span class="font-serif text-[8px] text-text-main/30 italic"> </span></div></button> <button class="flex flex-1 items-center justify-center gap-2 rounded-xl border-2 border-dashed border-text-main/10 bg-text-main/[0.05] py-4 transition-all hover:border-ui-accent/40 hover:bg-ui-highlight/20"><span class="text-lg">üì¶</span> <div class="flex flex-col items-start"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/60 uppercase"> </span> <span class="font-serif text-[8px] text-text-main/30 italic"> </span></div></button></div> <div class="flex flex-col gap-3 rounded-xl border border-ui-accent/10 bg-ui-accent/5 p-6"><div class="flex flex-col gap-1"><span class="font-serif text-[10px] font-bold tracking-widest text-ui-accent uppercase"> </span> <span class="font-serif text-[9px] text-ui-accent/60 italic"> </span></div> <div class="flex items-end gap-2"><!> <!></div></div> <div class="flex flex-col gap-4"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/30 uppercase"> </span> <div class="flex flex-col gap-2"></div></div></div>'),el=S('<input type="file" accept=".gpl,.txt" class="hidden"/> <!>',1);function tl(u,e){ae(e,!0);let a=se(e,"onClose",3,()=>s.studio.showPaletteLibrary=!1),n=ce(""),l=ce(void 0);function c(){t(n).trim()&&(s.paletteState.savePreset(t(n).trim()),B(n,""),K.persistence.backup(),K.persistence.saveGlobalPalettes())}function v(m){s.paletteState.applyPreset(m),s.studio.show(_("tools:palette_library.applied_toast"))}function d(m){s.paletteState.deletePreset(m),K.persistence.backup(),K.persistence.saveGlobalPalettes()}function p(){s.paletteState.newPalette(),s.studio.show(_("tools:palette_library.new_toast"))}function x(){t(l)?.click()}async function b(m){const k=m.target.files?.[0];if(!k)return;const A=await k.text();s.paletteState.importPalette(A)?s.studio.show(_("tools:palette_library.import_success_toast",{replace:{name:k.name}})):s.studio.show(_("tools:palette_library.import_error_toast")),m.target.value=""}function h(m){const k=s.paletteState.presets.find(I=>I.id===m);if(!k)return;const A=vt.toGPL(k.name,k.colors),C=new Blob([A],{type:"text/plain"}),T=URL.createObjectURL(C),L=document.createElement("a");L.href=T,L.download=`${k.name.toLowerCase().replace(/\s+/g,"-")}.gpl`,L.click(),URL.revokeObjectURL(T)}var g=el(),y=ne(g);gt(y,m=>B(l,m),()=>t(l));var w=o(y,2);ct(w,{title:"tools:palette_library.title",subtitle:"tools:palette_library.subtitle",isOpen:!0,get onClose(){return a()},width:"600px",children:(m,k)=>{var A=Jn(),C=i(A),T=i(C),L=o(i(T),2),I=i(L),$=i(I,!0);r(I);var j=o(I,2),R=i(j,!0);r(j),r(L),r(T);var F=o(T,2),ee=o(i(F),2),J=i(ee),D=i(J,!0);r(J);var G=o(J,2),U=i(G,!0);r(G),r(ee),r(F),r(C);var Z=o(C,2),de=i(Z),V=i(de),N=i(V,!0);r(V);var W=o(V,2),M=i(W,!0);r(W),r(de);var X=o(de,2),Y=i(X);Ue(Y,{placeholder:"tools:palette_library.name_placeholder",ariaLabel:"tools:palette_library.save_label",class:"flex-1",onkeydown:Q=>Q.key==="Enter"&&c(),get value(){return t(n)},set value(Q){B(n,Q,!0)}});var ie=o(Y,2);{let Q=H(()=>!t(n).trim());xe(ie,{variant:"primary",onclick:c,get disabled(){return t(Q)},ariaLabel:"tools:palette_library.button.save",class:"py-2.5",children:(Ce,we)=>{ge();var me=ve();P(Ie=>E(me,Ie),[()=>_("tools:palette_library.button.save")]),f(Ce,me)},$$slots:{default:!0}})}r(X),r(Z);var q=o(Z,2),le=i(q),ye=i(le,!0);r(le);var Se=o(le,2);_e(Se,21,()=>s.paletteState.presets,Q=>Q.id,(Q,Ce)=>{Zn(Q,{get preset(){return t(Ce)},onApply:v,onExport:h,onDelete:d})}),r(Se),r(q),r(A),P((Q,Ce,we,me,Ie,Ne,et,it,st)=>{z(T,"aria-label",Q),E($,Ce),E(R,we),z(F,"aria-label",me),E(D,Ie),E(U,Ne),E(N,et),E(M,it),E(ye,st)},[()=>_("tools:palette_library.new_set"),()=>_("tools:palette_library.new_set"),()=>_("tools:palette_library.new_set_desc"),()=>_("tools:palette_library.import"),()=>_("tools:palette_library.import"),()=>_("tools:palette_library.import_desc"),()=>_("tools:palette_library.save_label"),()=>_("tools:palette_library.save_desc"),()=>_("tools:palette_library.list_title")]),te("click",T,p),te("click",F,x),f(m,A)},$$slots:{default:!0}}),te("change",y,b),f(u,g),re()}Ae(["change","click"]);var al=S('<div class="flex flex-col gap-8"><div class="flex flex-col gap-6 rounded-xl border border-text-main/5 bg-text-main/[0.05] p-8"><div class="grid grid-cols-2 gap-8"><!> <!></div> <p class="font-serif text-[10px] leading-relaxed text-text-main/40 italic"> </p></div> <!></div>');function rl(u,e){ae(e,!0);let a=se(e,"onClose",3,()=>s.studio.showGoTo=!1),n=ce(wt(s.displayCoords.x)),l=ce(wt(s.displayCoords.y));function c(){K.jumpTo(t(n),t(l)),a()()}function v(d){d.key==="Enter"&&c()}_t(()=>{setTimeout(()=>{const d=document.getElementById("goto-x");d&&d.focus()},100)}),ct(u,{title:"workspace:navigation.title",subtitle:"workspace:navigation.subtitle",isOpen:!0,get onClose(){return a()},width:"400px",children:(d,p)=>{var x=al(),b=i(x),h=i(b),g=i(h);Ue(g,{id:"goto-x",label:"workspace:navigation.label_x",type:"number",onkeydown:v,ariaLabel:"workspace:navigation.label_x",get value(){return t(n)},set value(A){B(n,A,!0)}});var y=o(g,2);Ue(y,{id:"goto-y",label:"workspace:navigation.label_y",type:"number",onkeydown:v,ariaLabel:"workspace:navigation.label_y",get value(){return t(l)},set value(A){B(l,A,!0)}}),r(h);var w=o(h,2),m=i(w,!0);r(w),r(b);var k=o(b,2);xe(k,{variant:"primary",class:"w-full py-4 text-lg",onclick:c,ariaLabel:"workspace:navigation.action",children:(A,C)=>{ge();var T=ve();P(L=>E(T,L),[()=>_("workspace:navigation.action")]),f(A,T)},$$slots:{default:!0}}),r(x),P(A=>E(m,A),[()=>_("workspace:navigation.current",{replace:{x:s.displayCoords.x,y:s.displayCoords.y}})]),f(d,x)},$$slots:{default:!0}}),re()}var il=S('<div class="flex flex-col gap-8"><div class="flex items-center justify-between rounded-xl border border-text-main/5 bg-text-main/[0.05] p-6 shadow-sm"><div class="flex flex-col"><span class="font-serif text-sm font-bold tracking-tight text-text-main/60 uppercase"> </span> <span class="font-serif text-[10px] text-text-main/40"> </span></div> <!></div> <div class="flex flex-col gap-6 rounded-xl border border-text-main/5 bg-text-main/[0.05] p-8"><!> <!></div> <div class="rounded-xl bg-text-main/5 p-6"><h3 class="font-tiny5 mb-2 text-lg text-ui-accent"> </h3> <div class="flex flex-col gap-2 font-serif text-[11px] leading-relaxed text-text-main/60"><div class="flex justify-between"><span> </span> <span class="font-mono"> </span></div> <p class="text-text-main/50 italic"><!></p></div></div> <!></div>');function sl(u,e){ae(e,!0);let a=se(e,"onClose",3,()=>s.showAudioSettings=!1);ct(u,{title:"workspace:hud.audio.title",subtitle:"workspace:hud.audio.flow_title",isOpen:!0,get onClose(){return a()},width:"450px",children:(n,l)=>{var c=il(),v=i(c),d=i(v),p=i(d),x=i(p,!0);r(p);var b=o(p,2),h=i(b,!0);r(b),r(d);var g=o(d,2);{let U=H(()=>s.isMuted?"primary":"secondary"),Z=H(()=>s.isMuted?"actions:hud.unmute_audio":"actions:hud.mute_audio");xe(g,{get variant(){return t(U)},class:"!px-6 !py-2",onclick:()=>s.toggleMute(),get ariaLabel(){return t(Z)},children:(de,V)=>{ge();var N=ve();P(()=>E(N,s.isMuted?"üîá Muted":"üéê Active")),f(de,N)},$$slots:{default:!0}})}r(v);var y=o(v,2),w=i(y);nt(w,{label:"workspace:hud.audio.sfx_label",min:0,max:1,step:.01,ariaLabel:"workspace:hud.audio.sfx_label",get value(){return s.sfxVolume},set value(U){s.sfxVolume=U}});var m=o(w,2);nt(m,{label:"workspace:hud.audio.bgm_label",min:0,max:1,step:.01,ariaLabel:"workspace:hud.audio.bgm_label",get value(){return s.bgmVolume},set value(U){s.bgmVolume=U}}),r(y);var k=o(y,2),A=i(k),C=i(A,!0);r(A);var T=o(A,2),L=i(T),I=i(L),$=i(I,!0);r(I);var j=o(I,2),R=i(j);r(j),r(L);var F=o(L,2),ee=i(F);{var J=U=>{var Z=ve();P(de=>E(Z,de),[()=>_("workspace:hud.audio.status_awaiting")]),f(U,Z)},D=U=>{var Z=ve();P(de=>E(Z,de),[()=>_("workspace:hud.audio.status_playing")]),f(U,Z)};O(ee,U=>{s.usageMinutes<30?U(J):U(D,!1)})}r(F),r(T),r(k);var G=o(k,2);xe(G,{variant:"primary",class:"w-full py-4",get onclick(){return a()},ariaLabel:"ui:labels.confirm",children:(U,Z)=>{ge();var de=ve();P(V=>E(de,V),[()=>_("ui:labels.confirm")]),f(U,de)},$$slots:{default:!0}}),r(c),P((U,Z,de,V)=>{E(x,U),E(h,Z),E(C,de),E($,V),E(R,`${s.usageMinutes??""} minutes`)},[()=>_("workspace:hud.audio.master_mute"),()=>_("workspace:hud.audio.mute_desc"),()=>_("workspace:hud.audio.flow_title"),()=>_("workspace:hud.audio.duration_label")]),f(n,c)},$$slots:{default:!0}}),re()}var ol=S('<div class="flex flex-col gap-12"><section class="flex flex-col gap-6" aria-labelledby="philosophy-title"><div class="flex items-center gap-4 border-b border-text-main/10 pb-4"><span class="text-3xl" aria-hidden="true">üåø</span> <h3 id="philosophy-title" class="font-tiny5 text-3xl tracking-tighter text-ui-accent uppercase"> </h3></div> <div class="space-y-4 font-serif text-base leading-relaxed text-text-main/80"><p> </p> <p> </p> <p class="text-ui-accent italic"> </p></div></section> <div class="grid grid-cols-3 gap-6" role="list"><div class="flex flex-col gap-3 rounded-2xl border border-text-main/5 bg-text-main/[0.05] p-6 shadow-sm transition-all hover:bg-text-main/10" role="listitem"><div class="text-2xl" aria-hidden="true">üñåÔ∏è</div> <h4 class="font-tiny5 text-lg tracking-tight text-ui-accent uppercase"> </h4> <p class="font-serif text-[12px] leading-relaxed text-text-main/60"> </p></div> <div class="flex flex-col gap-3 rounded-2xl border border-text-main/5 bg-text-main/[0.05] p-6 shadow-sm transition-all hover:bg-text-main/10" role="listitem"><div class="text-2xl" aria-hidden="true">üçµ</div> <h4 class="font-tiny5 text-lg tracking-tight text-ui-accent uppercase"> </h4> <p class="font-serif text-[12px] leading-relaxed text-text-main/60"> </p></div> <div class="flex flex-col gap-3 rounded-2xl border border-text-main/5 bg-text-main/[0.05] p-6 shadow-sm transition-all hover:bg-text-main/10" role="listitem"><div class="text-2xl" aria-hidden="true">üìÑ</div> <h4 class="font-tiny5 text-lg tracking-tight text-ui-accent uppercase"> </h4> <p class="font-serif text-[12px] leading-relaxed text-text-main/60"> </p></div></div> <section class="flex flex-col gap-8 rounded-3xl bg-ui-accent/5 p-10 ring-1 ring-ui-accent/10" aria-labelledby="techniques-title"><h3 id="techniques-title" class="font-tiny5 text-2xl tracking-tighter text-ui-accent uppercase"> </h3> <div class="grid grid-cols-2 gap-x-12 gap-y-8"><div class="flex gap-5"><div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-2xl bg-canvas-bg text-2xl shadow-sm" aria-hidden="true">üéã</div> <div class="flex flex-col gap-1"><span class="font-serif text-sm font-black tracking-widest text-text-main/80 uppercase"> </span> <p class="font-serif text-[11px] leading-relaxed text-text-main/60"> </p></div></div> <div class="flex gap-5"><div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-2xl bg-canvas-bg text-2xl shadow-sm" aria-hidden="true">‚ú®</div> <div class="flex flex-col gap-1"><span class="font-serif text-sm font-black tracking-widest text-text-main/80 uppercase"> </span> <p class="font-serif text-[11px] leading-relaxed text-text-main/60"> </p></div></div> <div class="flex gap-5"><div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-2xl bg-canvas-bg text-2xl shadow-sm" aria-hidden="true">üåÄ</div> <div class="flex flex-col gap-1"><span class="font-serif text-sm font-black tracking-widest text-text-main/80 uppercase"> </span> <p class="font-serif text-[11px] leading-relaxed text-text-main/60"> </p></div></div> <div class="flex gap-5"><div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-2xl bg-canvas-bg text-2xl shadow-sm" aria-hidden="true">üéê</div> <div class="flex flex-col gap-1"><span class="font-serif text-sm font-black tracking-widest text-text-main/80 uppercase"> </span> <p class="font-serif text-[11px] leading-relaxed text-text-main/60"> </p></div></div></div></section> <footer class="flex flex-col items-center gap-6 border-t border-text-main/10 pt-10 text-center"><div class="flex flex-col items-center gap-2"><p class="font-serif text-sm text-text-main/50 italic"> </p> <span class="font-tiny5 text-[10px] tracking-[0.3em] text-text-main/30 uppercase"> </span></div> <div class="flex items-center gap-4"><!> <!></div></footer></div>');function nl(u,e){ae(e,!0);let a=se(e,"onClose",3,()=>s.showManual=!1);La(u,{title:"manual:title",isOpen:!0,get onClose(){return a()},width:"850px",children:(n,l)=>{var c=ol(),v=i(c),d=i(v),p=o(i(d),2),x=i(p,!0);r(p),r(d);var b=o(d,2),h=i(b),g=i(h,!0);r(h);var y=o(h,2),w=i(y,!0);r(y);var m=o(y,2),k=i(m,!0);r(m),r(b),r(v);var A=o(v,2),C=i(A),T=o(i(C),2),L=i(T,!0);r(T);var I=o(T,2),$=i(I,!0);r(I),r(C);var j=o(C,2),R=o(i(j),2),F=i(R,!0);r(R);var ee=o(R,2),J=i(ee,!0);r(ee),r(j);var D=o(j,2),G=o(i(D),2),U=i(G,!0);r(G);var Z=o(G,2),de=i(Z,!0);r(Z),r(D),r(A);var V=o(A,2),N=i(V),W=i(N,!0);r(N);var M=o(N,2),X=i(M),Y=o(i(X),2),ie=i(Y),q=i(ie,!0);r(ie);var le=o(ie,2),ye=i(le,!0);r(le),r(Y),r(X);var Se=o(X,2),Q=o(i(Se),2),Ce=i(Q),we=i(Ce,!0);r(Ce);var me=o(Ce,2),Ie=i(me,!0);r(me),r(Q),r(Se);var Ne=o(Se,2),et=o(i(Ne),2),it=i(et),st=i(it,!0);r(it);var Qe=o(it,2),ut=i(Qe,!0);r(Qe),r(et),r(Ne);var St=o(Ne,2),ht=o(i(St),2),Ct=i(ht),Qt=i(Ct,!0);r(Ct);var Tt=o(Ct,2),Dt=i(Tt,!0);r(Tt),r(ht),r(St),r(M),r(V);var zt=o(V,2),It=i(zt),ke=i(It),De=i(ke);r(ke);var qe=o(ke,2),Ye=i(qe,!0);r(qe),r(It);var Be=o(It,2),We=i(Be);xe(We,{variant:"secondary",class:"px-10 py-4",onclick:()=>{a()(),s.showShortcuts=!0},ariaLabel:"manual:footer.all_shortcuts",children:(Ee,ze)=>{ge();var $e=ve();P(Re=>E($e,Re),[()=>_("manual:footer.all_shortcuts")]),f(Ee,$e)},$$slots:{default:!0}});var Ke=o(We,2);xe(Ke,{variant:"primary",class:"px-16 py-4 text-xl",get onclick(){return a()},ariaLabel:"manual:footer.enter",children:(Ee,ze)=>{ge();var $e=ve();P(Re=>E($e,Re),[()=>_("manual:footer.enter")]),f(Ee,$e)},$$slots:{default:!0}}),r(Be),r(zt),r(c),P((Ee,ze,$e,Re,Pe,Pt,dt,Ft,Nt,qt,Wt,pt,Bt,Sa,Ca,Ta,Ia,Pa,ja,$a,Ra)=>{E(x,Ee),E(g,ze),E(w,$e),E(k,Re),E(L,Pe),E($,Pt),E(F,dt),E(J,Ft),E(U,Nt),E(de,qt),E(W,Wt),E(q,pt),E(ye,Bt),E(we,Sa),E(Ie,Ca),E(st,Ta),E(ut,Ia),E(Qt,Pa),E(Dt,ja),E(De,`"${$a??""}"`),E(Ye,Ra)},[()=>_("manual:philosophy.title"),()=>_("manual:philosophy.p1"),()=>_("manual:philosophy.p2"),()=>_("manual:philosophy.p3"),()=>_("manual:pillars.cursor.title"),()=>_("manual:pillars.cursor.desc"),()=>_("manual:pillars.colors.title"),()=>_("manual:pillars.colors.desc"),()=>_("manual:pillars.layers.title"),()=>_("manual:pillars.layers.desc"),()=>_("manual:techniques.title"),()=>_("manual:techniques.continuous.title"),()=>_("manual:techniques.continuous.desc"),()=>_("manual:techniques.magic_select.title"),()=>_("manual:techniques.magic_select.desc"),()=>_("manual:techniques.timeline.title"),()=>_("manual:techniques.timeline.desc"),()=>_("manual:techniques.audio.title"),()=>_("manual:techniques.audio.desc"),()=>_("manual:footer.quote"),()=>_("manual:footer.guild")]),f(n,c)},$$slots:{default:!0}}),re()}var ll=S('<div class="grid grid-cols-2 items-start gap-8"><div class="flex flex-col gap-2"><span class="text-xs font-bold text-text-main/60 uppercase"> </span> <!></div> <!></div> <div class="flex flex-col gap-2"><span class="text-xs font-bold text-text-main/60 uppercase"> </span> <div class="flex items-center gap-4"><!> <span class="text-[10px] text-text-main/40 italic">Use Ctrl + Alt + Arrows to nudge on canvas.</span></div></div> <div class="border-t border-text-main/5 pt-4"><!></div>',1),cl=S('<div class="flex flex-col gap-6"><div class="flex flex-col gap-2"><label class="text-xs font-bold text-text-main/60 uppercase" for="underlay-file"> </label> <input id="underlay-file" type="file" accept="image/*" class="text-xs text-text-main/80"/></div> <!></div>');function dl(u,e){ae(e,!1);const a=ga(s.studio);function n(c){const v=c.target;if(v.files&&v.files[0]){const d=new FileReader;d.onload=p=>{at(a,t(a).underlayImage=p.target?.result)},d.readAsDataURL(v.files[0])}}function l(){at(a,t(a).underlayOffset={x:0,y:0}),at(a,t(a).underlayScale=1)}je(),ct(u,{title:"actions:open_underlay_menu",isOpen:!0,onClose:()=>at(a,t(a).showUnderlayMenu=!1),children:(c,v)=>{var d=cl(),p=i(d),x=i(p),b=i(x,!0);r(x);var h=o(x,2);r(p);var g=o(p,2);{var y=w=>{var m=ll(),k=ne(m),A=i(k),C=i(A),T=i(C,!0);r(C);var L=o(C,2);{let G=bt(()=>t(a).isUnderlayVisible?"ui:labels.on":"ui:labels.off");Kt(L,{get label(){return t(G)},ariaLabel:"workspace:underlay.visibility",get checked(){return t(a).isUnderlayVisible},set checked(U){at(a,t(a).isUnderlayVisible=U)},$$legacy:!0})}r(A);var I=o(A,2);nt(I,{label:"workspace:project_panel.opacity",min:0,max:1,step:.05,ariaLabel:"workspace:project_panel.opacity",get value(){return t(a).underlayOpacity},set value(G){at(a,t(a).underlayOpacity=G)},$$legacy:!0}),r(k);var $=o(k,2),j=i($),R=i(j,!0);r(j);var F=o(j,2),ee=i(F);xe(ee,{variant:"secondary",size:"sm",onclick:l,ariaLabel:"actions:reset_viewport",children:(G,U)=>{ge();var Z=ve();P(de=>E(Z,de),[()=>_("actions:reset_viewport")]),f(G,Z)},$$slots:{default:!0}}),ge(2),r(F),r($);var J=o($,2),D=i(J);xe(D,{variant:"ghost",class:"w-full text-xs text-red-500 hover:underline",onclick:()=>at(a,t(a).underlayImage=null),ariaLabel:"actions:delete",children:(G,U)=>{ge();var Z=ve("Clear Reference Image");f(G,Z)},$$slots:{default:!0}}),r(J),P((G,U)=>{E(T,G),E(R,U)},[()=>_("workspace:underlay.visibility"),()=>_("workspace:underlay.positioning")]),f(w,m)};O(g,w=>{t(a).underlayImage&&w(y)})}r(d),P(w=>E(b,w),[()=>_("workspace:underlay.upload_label")]),te("change",h,n),f(c,d)},$$slots:{default:!0}}),re()}Ae(["change"]);var vl=S('<div class="flex flex-col gap-8"><!> <div class="flex flex-col gap-4"><div class="flex flex-col gap-1"><span class="font-serif text-[10px] font-bold tracking-widest text-text-main/60 uppercase"> </span> <span class="font-serif text-[9px] text-text-main/40 italic"> </span></div> <div class="grid grid-cols-2 gap-4"><!> <!></div></div> <!></div>');function ul(u,e){ae(e,!0);let a=se(e,"onClose",3,()=>s.studio.showPourBasin=!1),n=ce(5),l=ce(1),c=ce(0);function v(){K.selection.propagate(t(n),t(l),t(c)),a()()}ct(u,{title:"export:propagation.title",subtitle:"export:propagation.subtitle",isOpen:!0,get onClose(){return a()},width:"400px",children:(d,p)=>{var x=vl(),b=i(x);{let I=H(()=>s.project.frames.length-s.project.activeFrameIndex-1);Ue(b,{label:"export:propagation.frames_label",type:"number",min:1,get max(){return t(I)},ariaLabel:"export:propagation.frames_label",get value(){return t(n)},set value($){B(n,$,!0)}})}var h=o(b,2),g=i(h),y=i(g),w=i(y,!0);r(y);var m=o(y,2),k=i(m,!0);r(m),r(g);var A=o(g,2),C=i(A);Ue(C,{label:"workspace:navigation.label_x",type:"number",ariaLabel:"workspace:navigation.label_x",get value(){return t(l)},set value(I){B(l,I,!0)}});var T=o(C,2);Ue(T,{label:"workspace:navigation.label_y",type:"number",ariaLabel:"workspace:navigation.label_y",get value(){return t(c)},set value(I){B(c,I,!0)}}),r(A),r(h);var L=o(h,2);{let I=H(()=>t(n)<=0);xe(L,{variant:"primary",class:"w-full py-4 text-lg",onclick:v,get disabled(){return t(I)},ariaLabel:"export:propagation.action",children:($,j)=>{ge();var R=ve();P(F=>E(R,F),[()=>_("export:propagation.action")]),f($,R)},$$slots:{default:!0}})}r(x),P((I,$)=>{E(w,I),E(k,$)},[()=>_("export:propagation.offset_label"),()=>_("export:propagation.offset_desc")]),f(d,x)},$$slots:{default:!0}}),re()}var pl=S('<div class="mt-4 flex flex-col gap-1"><span class="font-mono text-[10px] font-bold text-text-main/40 uppercase">Technical Trace</span> <pre class="max-h-40 overflow-auto rounded-lg bg-text-main/5 p-4 font-mono text-[11px] whitespace-pre-wrap text-text-main/60"> </pre></div>'),fl=S('<div class="flex flex-col gap-6"><div class="flex flex-col gap-2"><p class="text-sm font-medium text-text-main/80"> </p> <!></div> <div class="flex justify-end gap-3 border-t border-text-main/5 pt-4"><!></div></div>');function xl(u,e){ae(e,!0);let a=se(e,"onClose",3,()=>s.studio.showErrorDialog=!1);const n=H(()=>s.studio.lastError);{let l=H(()=>t(n)?.title||"System Error");ct(u,{get title(){return t(l)},subtitle:"Technical Exception Details",isOpen:!0,get onClose(){return a()},width:"500px",children:(c,v)=>{var d=fl(),p=i(d),x=i(p),b=i(x,!0);r(x);var h=o(x,2);{var g=m=>{var k=pl(),A=o(i(k),2),C=i(A);r(A),r(k),P(()=>E(C,`
						${t(n).technical??""}
					`)),f(m,k)};O(h,m=>{t(n)?.technical&&m(g)})}r(p);var y=o(p,2),w=i(y);xe(w,{variant:"primary",get onclick(){return a()},ariaLabel:"ui:labels.confirm",children:(m,k)=>{ge();var A=ve();P(C=>E(A,C),[()=>_("ui:labels.confirm")]),f(m,A)},$$slots:{default:!0}}),r(y),r(d),P(()=>E(b,t(n)?.message||"An unexpected error has occurred.")),f(c,d)},$$slots:{default:!0}})}re()}var gl=S('<div class="flex flex-col gap-6"><p class="text-sm leading-relaxed text-text-main/70"> </p> <div class="flex justify-end gap-3 border-t border-text-main/5 pt-4"><!> <!></div></div>');function hl(u,e){ae(e,!0);async function a(){await K.persistence.restoreLastSession()&&s.studio.show(_("ui:studio.session_restored")),e.onResolve()}async function n(){await ha.saveProject("autosave_session",""),e.onResolve()}ct(u,{title:"ui:labels.recovery_title",subtitle:"ui:labels.recovery_subtitle",isOpen:!0,onClose:n,width:"450px",children:(l,c)=>{var v=gl(),d=i(v),p=i(d,!0);r(d);var x=o(d,2),b=i(x);xe(b,{variant:"danger",onclick:n,ariaLabel:"ui:labels.cancel",children:(g,y)=>{ge();var w=ve();P(m=>E(w,m),[()=>_("ui:labels.cancel")]),f(g,w)},$$slots:{default:!0}});var h=o(b,2);xe(h,{variant:"primary",onclick:a,ariaLabel:"ui:labels.confirm",children:(g,y)=>{ge();var w=ve();P(m=>E(w,m),[()=>_("ui:labels.confirm")]),f(g,w)},$$slots:{default:!0}}),r(x),r(v),P(g=>E(p,g),[()=>_("ui:labels.recovery_description")]),f(l,v)},$$slots:{default:!0}}),re()}var ml=S('<span class="text-xs opacity-60"> </span>'),bl=S('<button><div class="flex items-center gap-3"><!> <span class="font-serif text-xs font-medium"> </span></div></button>'),_l=S('<div class="fixed z-[2000] min-w-[160px] overflow-hidden rounded-lg border border-text-main/10 bg-canvas-bg/95 p-1 shadow-xl backdrop-blur-md" role="menu" tabindex="-1"><div class="flex flex-col gap-0.5"></div></div>');function Al(u,e){ae(e,!0);let a=ce(null),n=ce(160),l=ce(100),c=H(()=>e.x+t(n)>(typeof window<"u"?window.innerWidth:1e3)?e.x-t(n):e.x),v=H(()=>e.y+t(l)>(typeof window<"u"?window.innerHeight:1e3)?e.y-t(l):e.y);_t(()=>{t(a)&&(B(n,t(a).offsetWidth,!0),B(l,t(a).offsetHeight,!0))});var d=_l();Oe("mousedown",ta,x=>!t(a)?.contains(x.target)&&e.onClose());var p=i(d);_e(p,21,()=>e.items,Le,(x,b)=>{var h=bl(),g=i(h),y=i(g);{var w=A=>{var C=ml(),T=i(C,!0);r(C),P(()=>E(T,t(b).icon)),f(A,C)};O(y,A=>{t(b).icon&&A(w)})}var m=o(y,2),k=i(m,!0);r(m),r(g),r(h),P(()=>{h.disabled=t(b).disabled,oe(h,1,`flex w-full items-center justify-between rounded px-3 py-2 text-left transition-colors ${t(b).danger?"text-red-600 hover:bg-red-50":"text-text-main hover:bg-ui-accent/5"} ${t(b).disabled?"cursor-not-allowed opacity-30 grayscale":""}`),E(k,t(b).label)}),te("click",h,()=>{t(b).disabled||(t(b).action(),e.onClose())}),f(x,h)}),r(p),r(d),gt(d,x=>B(a,x),()=>t(a)),P(()=>pe(d,`left: ${t(c)??""}px; top: ${t(v)??""}px;`)),te("contextmenu",d,x=>x.preventDefault()),fe(3,d,()=>Lt,()=>({duration:100,start:.95,opacity:0})),f(u,d),re()}Ae(["contextmenu","click"]);var yl=S('<div class="pointer-events-none fixed bottom-24 left-1/2 z-[2000] -translate-x-1/2 rounded-full border border-ui-accent/20 bg-canvas-bg/95 px-6 py-2 shadow-2xl backdrop-blur-md"><div class="flex items-center gap-3"><span class="font-tiny5 text-lg tracking-widest text-ui-accent uppercase"> </span></div></div>');function wl(u,e){ae(e,!1);const a=s.studio;je();var n=Te(),l=ne(n);{var c=v=>{var d=yl(),p=i(d),x=i(p),b=i(x,!0);r(x),r(p),r(d),P(()=>E(b,a.toastMessage)),fe(3,d,()=>Yt,()=>({y:20,duration:300})),f(v,d)};O(l,v=>{a.showToast&&v(c)})}f(u,n),re()}var kl=S('<header class="app-header z-30 h-14 shrink-0 border-b border-text-main/10 bg-canvas-bg shadow-sm svelte-1towcbt"><!></header>'),El=S('<aside class="app-sidebar-left z-20 w-72 shrink-0 border-r border-text-main/10 bg-canvas-bg/50 shadow-sm svelte-1towcbt"><!></aside>'),Ll=S('<aside class="app-sidebar-right z-20 w-80 shrink-0 border-l border-text-main/10 bg-canvas-bg/50 shadow-sm svelte-1towcbt"><!></aside>'),Sl=S('<footer class="app-footer z-30 h-auto shrink-0 border-t border-text-main/10 bg-canvas-bg shadow-sm svelte-1towcbt"><!></footer>'),Cl=S('<div class="app-overlay-layer pointer-events-none fixed inset-0 z-[500] overflow-hidden"><!></div>'),Tl=S('<div class="app-shell h-screen w-screen overflow-hidden bg-canvas-bg font-serif text-text-main svelte-1towcbt"><!> <main class="app-main flex flex-1 overflow-hidden"><!> <section class="app-viewport relative flex-1 overflow-hidden bg-grid-border/5 svelte-1towcbt"><!></section> <!></main> <!> <!></div>');function Il(u,e){var a=Tl(),n=i(a);{var l=A=>{var C=kl(),T=i(C);Me(T,()=>e.header),r(C),f(A,C)};O(n,A=>{e.header&&A(l)})}var c=o(n,2),v=i(c);{var d=A=>{var C=El(),T=i(C);Me(T,()=>e.sidebarLeft),r(C),f(A,C)};O(v,A=>{e.sidebarLeft&&A(d)})}var p=o(v,2),x=i(p);{var b=A=>{var C=Te(),T=ne(C);Me(T,()=>e.viewport),f(A,C)};O(x,A=>{e.viewport&&A(b)})}r(p);var h=o(p,2);{var g=A=>{var C=Ll(),T=i(C);Me(T,()=>e.sidebarRight),r(C),f(A,C)};O(h,A=>{e.sidebarRight&&A(g)})}r(c);var y=o(c,2);{var w=A=>{var C=Sl(),T=i(C);Me(T,()=>e.footer),r(C),f(A,C)};O(y,A=>{e.footer&&A(w)})}var m=o(y,2);{var k=A=>{var C=Cl(),T=i(C);Me(T,()=>e.overlay),r(C),f(A,C)};O(m,A=>{e.overlay&&A(k)})}r(a),f(u,a)}var Pl=S('<div class="flex h-full w-full items-center px-4"><!></div>');function jl(u,e){var a=Pl(),n=i(a);Me(n,()=>e.children),r(a),f(u,a)}var $l=S('<div class="flex h-full w-full items-center px-4"><!></div>');function Rl(u,e){var a=$l(),n=i(a);Me(n,()=>e.children),r(a),f(u,a)}var Ml=S('<div class="flex h-full w-full flex-col overflow-hidden"><!></div>');function ua(u,e){se(e,"side",3,"left");var a=Ml(),n=i(a);Me(n,()=>e.children),r(a),f(u,a)}var Ol=S('<div class="h-full w-full"><!></div>');function Dl(u,e){var a=Ol(),n=i(a);Me(n,()=>e.children),r(a),f(u,a)}var zl=S('<div class="app-overlay contents-interactive pointer-events-none absolute inset-0 svelte-1e74jgv"><!></div>');function Fl(u,e){var a=zl(),n=i(a);Me(n,()=>e.children),r(a),f(u,a)}var ue=Et(()=>s),Nl=S('<div class="relative flex h-full w-full items-center justify-center overflow-hidden bg-grid-border/20 p-6"><div><!></div></div>'),Bl=S("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1);function Wl(u,e){ae(e,!1),_t(()=>Xe.mount()),je(),Il(u,{header:p=>{jl(p,{children:(x,b)=>{Nr(x)}})},sidebarLeft:p=>{ua(p,{side:"left",children:(x,b)=>{Pi(x,{})},$$slots:{default:!0}})},viewport:p=>{Dl(p,{children:(x,b)=>{var h=Nl(),g=i(h),y=i(g);qo(y,{}),r(g),r(h),P(()=>oe(g,1,`editor-frame flex h-full w-full items-center justify-center overflow-hidden shadow-2xl transition-all duration-700 ease-out ${ue().project.isPlaying&&ue().project.frames.length>1?"ring-palette-0 animate-pulse ring-8 ring-inset":""}`)),f(x,h)}})},sidebarRight:p=>{ua(p,{side:"right",children:(x,b)=>{qi(x)},$$slots:{default:!0}})},footer:p=>{Rl(p,{children:(x,b)=>{go(x)}})},overlay:p=>{Fl(p,{children:(x,b)=>{var h=Bl(),g=ne(h);Zo(g,{});var y=o(g,2);{var w=Q=>{nl(Q,{onClose:()=>ue(ue().showManual=!1)})};O(y,Q=>{ue().showManual&&Q(w)})}var m=o(y,2);{var k=Q=>{pn(Q,{onClose:()=>ue(ue().showCommandPalette=!1)})};O(m,Q=>{ue().showCommandPalette&&Q(k)})}var A=o(m,2);{var C=Q=>{In(Q,{onExport:(Ce,we,me)=>K.createArtifact(Ce,we,me),onClose:()=>ue(ue().showExportMenu=!1)})};O(A,Q=>{ue().showExportMenu&&Q(C)})}var T=o(A,2);{var L=Q=>{Vn(Q,{onClose:()=>ue(ue().showPersistenceMenu=!1)})};O(T,Q=>{ue().showPersistenceMenu&&Q(L)})}var I=o(T,2);{var $=Q=>{tl(Q,{onClose:()=>ue(ue().studio.showPaletteLibrary=!1)})};O(I,Q=>{ue().studio.showPaletteLibrary&&Q($)})}var j=o(I,2);{var R=Q=>{Qn(Q,{onClose:()=>ue(ue().showSettings=!1)})};O(j,Q=>{ue().showSettings&&Q(R)})}var F=o(j,2);{var ee=Q=>{rl(Q,{onClose:()=>ue(ue().showGoTo=!1)})};O(F,Q=>{ue().showGoTo&&Q(ee)})}var J=o(F,2);{var D=Q=>{ul(Q,{onClose:()=>ue(ue().studio.showPourBasin=!1)})};O(J,Q=>{ue().studio.showPourBasin&&Q(D)})}var G=o(J,2);{var U=Q=>{sl(Q,{onClose:()=>ue(ue().showAudioSettings=!1)})};O(G,Q=>{ue().showAudioSettings&&Q(U)})}var Z=o(G,2);{var de=Q=>{Hn(Q,{onClose:()=>ue(ue().showShortcuts=!1)})};O(Z,Q=>{ue().showShortcuts&&Q(de)})}var V=o(Z,2);{var N=Q=>{dl(Q,{})};O(V,Q=>{ue().studio.showUnderlayMenu&&Q(N)})}var W=o(V,2);{var M=Q=>{xl(Q,{onClose:()=>ue(ue().studio.showErrorDialog=!1)})};O(W,Q=>{ue().studio.showErrorDialog&&Q(M)})}var X=o(W,2);{var Y=Q=>{hl(Q,{onResolve:()=>ue(ue().studio.showRecoveryPrompt=!1)})};O(X,Q=>{ue().studio.showRecoveryPrompt&&Q(Y)})}var ie=o(X,2);{var q=Q=>{Al(Q,{get x(){return ue().studio.contextMenu.x},get y(){return ue().studio.contextMenu.y},get items(){return ue().studio.contextMenu.items},onClose:()=>ue(ue().studio.contextMenu=null)})};O(ie,Q=>{ue().studio.contextMenu&&Q(q)})}var le=o(ie,2);{var ye=Q=>{sa(Q,{onClose:()=>ue(ue().showColorPicker=!1),get value(){return ue().paletteState.activeColor},set value(Ce){ue(ue().paletteState.activeColor=Ce)},$$legacy:!0})};O(le,Q=>{ue().showColorPicker&&Q(ye)})}var Se=o(le,2);wl(Se,{}),f(x,h)}})}}),re()}export{Wl as component};
